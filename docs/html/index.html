<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Installing POX &mdash; POX Manual Current documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     'Current',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="POX Manual Current documentation" href="#" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="nav-item nav-item-0"><a href="#">POX Manual Current documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">As POX is continually evolving, things on this page may not always reflect exactly the state of any particular branch in the POX code repository.&nbsp; If you&#8217;re using an old branch, you may find it helpful to view a version of this page from the past (e.g. around the time your branch was current).&nbsp; If you&#8217;re using the newest branch and things written here aren&#8217;t right, feel free to fix them or mention it on the mailing list or forum.</p>
</div>
<div class="toctree-wrapper compound">
<ul class="simple">
</ul>
</div>
<div class="contents topic" id="table-of-contents">
<p class="topic-title first">Table of Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#installing-pox" id="id7">Installing POX</a><ul>
<li><a class="reference internal" href="#requirements" id="id8">Requirements</a></li>
<li><a class="reference internal" href="#getting-the-code-installing-pox" id="id9">Getting the Code / Installing POX</a></li>
<li><a class="reference internal" href="#selecting-a-branch-version" id="id10">Selecting a Branch / Version</a></li>
<li><a class="reference internal" href="#pypy-support" id="id11">PyPy Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#invoking-pox" id="id12">Invoking POX</a></li>
<li><a class="reference internal" href="#components-in-pox" id="id13">Components in POX</a><ul>
<li><a class="reference internal" href="#stock-components" id="id14">Stock Components</a><ul>
<li><a class="reference internal" href="#py" id="id15">py</a></li>
<li><a class="reference internal" href="#forwarding-hub" id="id16">forwarding.hub</a></li>
<li><a class="reference internal" href="#forwarding-l2-learning" id="id17">forwarding.l2_learning</a></li>
<li><a class="reference internal" href="#forwarding-l2-pairs" id="id18">forwarding.l2_pairs</a></li>
<li><a class="reference internal" href="#forwarding-l3-learning" id="id19">forwarding.l3_learning</a></li>
<li><a class="reference internal" href="#forwarding-l2-multi" id="id20">forwarding.l2_multi</a></li>
<li><a class="reference internal" href="#forwarding-l2-nx" id="id21">forwarding.l2_nx</a></li>
<li><a class="reference internal" href="#forwarding-topo-proactive" id="id22">forwarding.topo_proactive</a></li>
<li><a class="reference internal" href="#openflow-spanning-tree" id="id23">openflow.spanning_tree</a></li>
<li><a class="reference internal" href="#openflow-webservice" id="id24">openflow.webservice</a><ul>
<li><a class="reference internal" href="#example-get-list-of-connected-switches" id="id25">Example: Get list of connected switches</a></li>
<li><a class="reference internal" href="#example-making-a-hub-using-the-webservice" id="id26">Example: Making a hub using the webservice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#web-webcore" id="id27">web.webcore</a></li>
<li><a class="reference internal" href="#messenger" id="id28">messenger</a><ul>
<li><a class="reference internal" href="#getting-started-with-the-messenger-component" id="id29">Getting Started with the Messenger Component</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-of-01" id="id30">openflow.of_01</a></li>
<li><a class="reference internal" href="#openflow-discovery" id="id31">openflow.discovery</a></li>
<li><a class="reference internal" href="#openflow-debug" id="id32">openflow.debug</a></li>
<li><a class="reference internal" href="#openflow-keepalive" id="id33">openflow.keepalive</a></li>
<li><a class="reference internal" href="#proto-pong" id="id34">proto.pong</a></li>
<li><a class="reference internal" href="#proto-arp-responder" id="id35">proto.arp_responder</a></li>
<li><a class="reference internal" href="#info-packet-dump" id="id36">info.packet_dump</a></li>
<li><a class="reference internal" href="#proto-dns-spy" id="id37">proto.dns_spy</a></li>
<li><a class="reference internal" href="#proto-dhcp-client" id="id38">proto.dhcp_client</a></li>
<li><a class="reference internal" href="#proto-dhcpd" id="id39">proto.dhcpd</a></li>
<li><a class="reference internal" href="#misc-of-tutorial" id="id40">misc.of_tutorial</a></li>
<li><a class="reference internal" href="#misc-full-payload" id="id41">misc.full_payload</a></li>
<li><a class="reference internal" href="#misc-mac-blocker" id="id42">misc.mac_blocker</a></li>
<li><a class="reference internal" href="#misc-nat" id="id43">misc.nat</a></li>
<li><a class="reference internal" href="#misc-ip-loadbalancer" id="id44">misc.ip_loadbalancer</a></li>
<li><a class="reference internal" href="#misc-gephi-topo" id="id45">misc.gephi_topo</a></li>
<li><a class="reference internal" href="#log" id="id46">log</a><ul>
<li><a class="reference internal" href="#disabling-the-console-log" id="id47">Disabling the Console Log</a></li>
<li><a class="reference internal" href="#log-formatting" id="id48">Log Formatting</a></li>
<li><a class="reference internal" href="#log-output" id="id49">Log Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log-color" id="id50">log.color</a></li>
<li><a class="reference internal" href="#log-level" id="id51">log.level</a></li>
<li><a class="reference internal" href="#samples-pretty-log" id="id52">samples.pretty_log</a></li>
<li><a class="reference internal" href="#tk" id="id53">tk</a></li>
<li><a class="reference internal" href="#host-tracker" id="id54">host_tracker</a></li>
<li><a class="reference internal" href="#datapaths-pcap-switch" id="id55">datapaths.pcap_switch</a></li>
</ul>
</li>
<li><a class="reference internal" href="#developing-your-own-components" id="id56">Developing your own Components</a><ul>
<li><a class="reference internal" href="#the-ext-directory" id="id57">The &#8220;ext&#8221; directory</a></li>
<li><a class="reference internal" href="#the-launch-function" id="id58">The launch function</a><ul>
<li><a class="reference internal" href="#a-simple-example" id="id59">A Simple Example</a></li>
<li><a class="reference internal" href="#multiple-invocation" id="id60">Multiple Invocation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pox-apis" id="id61">POX APIs</a><ul>
<li><a class="reference internal" href="#working-with-pox-the-pox-core-object" id="id62">Working with POX: The POX Core object</a><ul>
<li><a class="reference internal" href="#registering-components" id="id63">Registering Components</a></li>
<li><a class="reference internal" href="#dependency-and-event-management" id="id64">Dependency and Event Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-addresses-pox-lib-addresses" id="id65">Working with Addresses: pox.lib.addresses</a></li>
<li><a class="reference internal" href="#the-event-system-pox-lib-revent" id="id66">The Event System: pox.lib.revent</a><ul>
<li><a class="reference internal" href="#handling-events" id="id67">Handling Events</a><ul>
<li><a class="reference internal" href="#event-handlers" id="id68">Event Handlers</a></li>
<li><a class="reference internal" href="#listening-to-an-event" id="id69">Listening To an Event</a></li>
<li><a class="reference internal" href="#automatically-setting-listeners" id="id70">Automatically Setting Listeners</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-your-own-event-types" id="id71">Creating Your Own Event Types</a></li>
<li><a class="reference internal" href="#raising-events" id="id72">Raising Events</a></li>
<li><a class="reference internal" href="#binding-to-components-events" id="id73">Binding to Components&#8217; Events</a></li>
<li><a class="reference internal" href="#advanced-topics-in-event-handling" id="id74">Advanced Topics in Event Handling</a><ul>
<li><a class="reference internal" href="#events-with-multiple-listeners" id="id75">Events With Multiple Listeners</a></li>
<li><a class="reference internal" href="#removing-listeners-and-one-time-events" id="id76">Removing Listeners and One-Time Events</a></li>
<li><a class="reference internal" href="#weak-event-handlers" id="id77">Weak Event Handlers</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-packets-pox-lib-packet" id="id78">Working with packets: pox.lib.packet</a><ul>
<li><a class="reference internal" href="#ethernet-ethernet" id="id79">Ethernet (ethernet)</a></li>
<li><a class="reference internal" href="#ip-version-4-ipv4" id="id80">IP version 4 (ipv4)</a></li>
<li><a class="reference internal" href="#tcp-tcp" id="id81">TCP (tcp)</a><ul>
<li><a class="reference internal" href="#tcp-opt-class" id="id82">tcp_opt class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-arp-messages" id="id83">Example: ARP messages</a></li>
<li><a class="reference internal" href="#constructing-packets-from-scratch-and-reading-packets-from-the-wire" id="id84">Constructing Packets from Scratch and Reading Packets from the Wire</a></li>
</ul>
</li>
<li><a class="reference internal" href="#threads-tasks-and-timers-pox-lib-recoco" id="id85">Threads, Tasks, and Timers: pox.lib.recoco</a><ul>
<li><a class="reference internal" href="#using-normal-threads" id="id86">Using Normal Threads</a></li>
<li><a class="reference internal" href="#executing-code-in-the-future-using-a-timer" id="id87">Executing Code in the Future using a Timer</a><ul>
<li><a class="reference internal" href="#timer-constructor-arguments" id="id88">Timer Constructor Arguments</a></li>
<li><a class="reference internal" href="#timer-methods" id="id89">Timer Methods</a></li>
<li><a class="reference internal" href="#example-one-shot-timer" id="id90">Example&nbsp;- One-Shot timer</a></li>
<li><a class="reference internal" href="#example-recurring-timer" id="id91">Example&nbsp;- Recurring timer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-sockets-ioworker" id="id92">Working with sockets: ioworker</a></li>
<li><a class="reference internal" href="#working-with-pcap-libpcap-pxpcap" id="id93">Working with pcap/libpcap: pxpcap</a><ul>
<li><a class="reference internal" href="#building-pxpcap" id="id94">Building pxpcap</a></li>
<li><a class="reference internal" href="#using-pxpcap-with-older-versions-of-python" id="id95">Using pxpcap with older versions of Python</a></li>
<li><a class="reference internal" href="#using-pxpcap-with-pypy" id="id96">Using pxpcap with PyPy</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-in-pox" id="id97">OpenFlow in POX</a><ul>
<li><a class="reference internal" href="#dpids-in-pox" id="id98">DPIDs in POX</a><ul>
<li><a class="reference internal" href="#dpids-in-mininet" id="id99">DPIDs in Mininet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#communicating-with-datapaths-switches" id="id100">Communicating with Datapaths (Switches)</a><ul>
<li><a class="reference internal" href="#connection-objects" id="id101">Connection Objects</a><ul>
<li><a class="reference internal" href="#getting-a-reference-to-a-connection-object" id="id102">Getting a Reference to a Connection Object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-openflow-nexus-core-openflow" id="id103">The OpenFlow Nexus – core.openflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-events-responding-to-switches" id="id104">OpenFlow Events: Responding to Switches</a><ul>
<li><a class="reference internal" href="#connectionup" id="id105">ConnectionUp</a></li>
<li><a class="reference internal" href="#connectiondown" id="id106">ConnectionDown</a></li>
<li><a class="reference internal" href="#portstatus" id="id107">PortStatus</a></li>
<li><a class="reference internal" href="#flowremoved" id="id108">FlowRemoved</a></li>
<li><a class="reference internal" href="#statistics-events" id="id109">Statistics Events</a></li>
<li><a class="reference internal" href="#packetin" id="id110">PacketIn</a></li>
<li><a class="reference internal" href="#errorin" id="id111">ErrorIn</a></li>
<li><a class="reference internal" href="#barrierin" id="id112">BarrierIn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-messages" id="id113">OpenFlow Messages</a><ul>
<li><a class="reference internal" href="#ofp-packet-out-sending-packets-from-the-switch" id="id114">ofp_packet_out - Sending packets from the switch</a></li>
<li><a class="reference internal" href="#ofp-flow-mod-flow-table-modification" id="id115">ofp_flow_mod - Flow table modification</a><ul>
<li><a class="reference internal" href="#example-installing-a-table-entry" id="id116">Example: Installing a table entry</a></li>
<li><a class="reference internal" href="#example-clearing-tables-on-all-switches" id="id117">Example: Clearing tables on all switches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ofp-stats-request-requesting-statistics-from-switches" id="id118">ofp_stats_request - Requesting statistics from switches</a><ul>
<li><a class="reference internal" href="#example-web-flow-statistics" id="id119">Example - Web Flow Statistics</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#match-structure" id="id120">Match Structure</a><ul>
<li><a class="reference internal" href="#partial-matches-and-wildcards" id="id121">Partial Matches and Wildcards</a></li>
<li><a class="reference internal" href="#ofp-match-methods" id="id122">ofp_match Methods</a></li>
<li><a class="reference internal" href="#defining-a-match-from-an-existing-packet" id="id123">Defining a match from an existing packet</a></li>
<li><a class="reference internal" href="#example-matching-web-traffic" id="id124">Example: Matching Web Traffic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-actions" id="id125">OpenFlow Actions</a><ul>
<li><a class="reference internal" href="#output" id="id126">Output</a></li>
<li><a class="reference internal" href="#enqueue" id="id127">Enqueue</a></li>
<li><a class="reference internal" href="#set-vlan-id" id="id128">Set VLAN ID</a></li>
<li><a class="reference internal" href="#set-vlan-priority" id="id129">Set VLAN priority</a></li>
<li><a class="reference internal" href="#set-ethernet-source-or-destination-address" id="id130">Set Ethernet source or destination address</a></li>
<li><a class="reference internal" href="#set-ip-source-or-destination-address" id="id131">Set IP source or destination address</a></li>
<li><a class="reference internal" href="#set-ip-type-of-service" id="id132">Set IP Type of Service</a></li>
<li><a class="reference internal" href="#set-tcp-udp-source-or-destination-port" id="id133">Set TCP/UDP source or destination port</a></li>
<li><a class="reference internal" href="#example-sending-a-flowmod" id="id134">Example: Sending a FlowMod</a></li>
<li><a class="reference internal" href="#example-sending-a-packetout" id="id135">Example: Sending a PacketOut</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nicira-open-vswitch-extensions" id="id136">Nicira / Open vSwitch Extensions</a><ul>
<li><a class="reference internal" href="#extended-packetin-messages" id="id137">Extended PacketIn Messages</a></li>
<li><a class="reference internal" href="#multiple-table-support" id="id138">Multiple Table Support</a></li>
<li><a class="reference internal" href="#flexible-flow-specifications-aka-nicira-extended-match" id="id139">Flexible Flow Specifications (AKA Nicira Extended Match)</a><ul>
<li><a class="reference internal" href="#using-nx-match" id="id140">Using nx_match</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-learn-action" id="id141">The Learn Action</a></li>
<li><a class="reference internal" href="#additional-information" id="id142">Additional Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-the-openflow-component-s-initialization" id="id143">About the OpenFlow Component&#8217;s Initialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ovsdb-in-pox" id="id144">OVSDB in POX</a><ul>
<li><a class="reference internal" href="#transactions" id="id145">Transactions</a></li>
<li><a class="reference internal" href="#getting-data-with-select" id="id146">Getting data with SELECT</a></li>
<li><a class="reference internal" href="#modifying-data-insert-update-delete-and-mutate" id="id147">Modifying data: INSERT, UPDATE, DELETE, and MUTATE</a></li>
<li><a class="reference internal" href="#locks" id="id148">Locks</a></li>
<li><a class="reference internal" href="#miscellaneous" id="id149">Miscellaneous</a></li>
<li><a class="reference internal" href="#waiting-for-conditions-and-monitoring-changes-with-wait-and-monitor" id="id150">Waiting for conditions and monitoring changes with WAIT and MONITOR</a></li>
</ul>
</li>
<li><a class="reference internal" href="#third-party-tools-tutorials-etc" id="id151">Third-Party Tools, Tutorials, Etc.</a><ul>
<li><a class="reference internal" href="#poxdesk-a-pox-web-gui" id="id152">POXDesk: A POX Web GUI</a></li>
<li><a class="reference internal" href="#id4" id="id153">OpenFlow Tutorial</a></li>
<li><a class="reference internal" href="#sdnhub-pox-controller-tutorial" id="id154">SDNHub POX Controller Tutorial</a></li>
<li><a class="reference internal" href="#openflow-switch-tutorial" id="id155">OpenFlow Switch Tutorial</a></li>
<li><a class="reference internal" href="#statistics-collector-example" id="id156">Statistics Collector Example</a></li>
<li><a class="reference internal" href="#ripl-datacenter-topologies-with-pox-and-mininet" id="id157">RipL: Datacenter Topologies with POX and Mininet</a></li>
<li><a class="reference internal" href="#direct-server-return-load-balancer" id="id158">Direct Server Return Load Balancer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coding-conventions" id="id159">Coding Conventions</a></li>
<li><a class="reference internal" href="#faqs" id="id160">FAQs</a><ul>
<li><a class="reference internal" href="#what-versions-of-openflow-does-pox-support" id="id161">What versions of OpenFlow does POX support?</a></li>
<li><a class="reference internal" href="#what-does-the-fields-ignored-due-to-unspecified-prerequisites-warning-mean" id="id162">What does the <code class="docutils literal"><span class="pre">Fields</span> <span class="pre">ignored</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">unspecified</span> <span class="pre">prerequisites</span></code> warning mean?</a></li>
<li><a class="reference internal" href="#i-tried-to-install-a-table-entry-but-got-a-different-one-why" id="id163">I tried to install a table entry but got a different one.&nbsp; Why?</a></li>
<li><a class="reference internal" href="#what-is-a-datapath-what-is-a-dpid" id="id164">What is a &#8220;datapath&#8221;?&nbsp; What is a DPID?</a></li>
<li><a class="reference internal" href="#how-do-i-create-a-firewall-block-tcp-ports" id="id165">How do I create a firewall / block TCP ports?</a></li>
<li><a class="reference internal" href="#how-can-i-change-the-openflow-port-from-6633" id="id166">How can I change the OpenFlow port from 6633?</a></li>
<li><a class="reference internal" href="#how-can-i-have-some-components-start-automatically-every-time-i-run-pox" id="id167">How can I have some components start automatically every time I run POX?</a></li>
<li><a class="reference internal" href="#how-do-i-get-switches-to-send-complete-packet-payloads-to-the-controller" id="id168">How do I get switches to send complete packet payloads to the controller?</a></li>
<li><a class="reference internal" href="#how-can-i-communicate-between-components" id="id169">How can I communicate between components?</a></li>
<li><a class="reference internal" href="#how-can-i-use-pox-with-mininet" id="id170">How can I use POX with Mininet?</a></li>
<li><a class="reference internal" href="#i-m-seeing-many-packet-in-messages-and-forwarding-isn-t-working-what-gives" id="id171">I&#8217;m seeing many packet_in messages and forwarding isn&#8217;t working; what gives?</a></li>
<li><a class="reference internal" href="#does-pox-support-topologies-with-loops" id="id172">Does POX support topologies with loops?</a></li>
<li><a class="reference internal" href="#switches-keep-disconnecting-especially-with-pantou-reference-switch-help" id="id173">Switches keep disconnecting (especially with Pantou/reference switch).&nbsp; Help?</a></li>
<li><a class="reference internal" href="#why-doesn-t-the-openflow-webservice-component-work" id="id174">Why doesn&#8217;t the openflow.webservice component work?</a></li>
<li><a class="reference internal" href="#what-are-these-log-messages-from-the-packet-subsystem" id="id175">What are these log messages from the packet subsystem?</a></li>
<li><a class="reference internal" href="#i-installed-ip-based-table-entries-but-ping-tcp-doesn-t-work-why-not" id="id176">I Installed IP-Based Table Entries But Ping/TCP Doesn&#8217;t Work.&nbsp; Why not?</a></li>
<li><a class="reference internal" href="#does-pox-support-python-3" id="id177">Does POX support Python 3?</a></li>
<li><a class="reference internal" href="#i-d-like-to-contribute-can-i-do-you-have-project-ideas" id="id178">I&#8217;d like to contribute.&nbsp; Can I?&nbsp; Do you have project ideas?</a></li>
<li><a class="reference internal" href="#what-s-this-warning-like-core-still-waiting-on-1-component-s" id="id179">What&#8217;s this warning like &#8220;core:Still waiting on 1 component(s)&#8221;?</a></li>
<li><a class="reference internal" href="#why-doesn-t-pox-s-discovery-use-the-normal-lldp-mac-address" id="id180">Why doesn&#8217;t POX&#8217;s discovery use the normal LLDP MAC address?</a></li>
<li><a class="reference internal" href="#what-s-a-good-strategy-for-debugging-a-problem-with-my-pox-based-controller" id="id181">What&#8217;s a good strategy for debugging a problem with my POX-based controller?</a></li>
<li><a class="reference internal" href="#i-ve-got-a-problem-bug-can-you-help-me" id="id182">I&#8217;ve got a problem / bug!&nbsp; Can you help me?</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="installing-pox">
<h1><a class="toc-backref" href="#id7">Installing POX</a><a class="headerlink" href="#installing-pox" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">One of POX&#8217;s design points is to be easy to install and run.&nbsp; However, especially if this is all very new to you, there are times when you really want to just be able to dive straight in to a working configuration.&nbsp; If this describes you, you may want to skip installing POX altogether and instead download a virtual machine image with POX and software OpenFlow switches preinstalled and ready to go.&nbsp; You can totally do this!&nbsp; Usually the switches are provided by a tool known as Mininet, which allows for complex software OpenFlow networks to be run on a single machine – or within a single virtual machine. <br /><br /> The official Mininet VMs come with POX installed (and can be easily upgraded to the latest version), so they are certainly one option.&nbsp; This option is the one assumed by the <a class="reference external" href="http://archive.openflow.org/wk/index.php/OpenFlow_Tutorial">Stanford OpenFlow Tutorial</a>, which you may want to follow if you&#8217;re looking for a crash course on OpenFlow and POX. <br /><br /> Another option is the <a class="reference external" href="http://sdnhub.org/tutorials/pox/">SDNHub POX Tutorial</a> which has its own preconfigured VM.</p>
</div>
<div class="section" id="requirements">
<h2><a class="toc-backref" href="#id8">Requirements</a><a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h2>
<p>POX requires Python 2.7.&nbsp; In practice, it also mostly runs with Python 2.6, and there have been a few commits around March 2013 to improve this somewhat, but nobody is presently&nbsp;<em>really</em>&nbsp;trying to support this.&nbsp; See&nbsp;the FAQ entry <a class="reference internal" href="#does-pox-support-python-3">Does POX Support Python 3?</a>&nbsp;for the story on Python 3 support.&nbsp; If all you have is Python 2.6, you might want to look into PyPy (see below) or&nbsp;<a class="reference external" href="https://github.com/utahta/pythonbrew/blob/master/README.rst">pythonbrew</a>.</p>
<p>POX officially supports Windows, Mac OS, and Linux (though it has been used on other systems as well).&nbsp; A lot of the development happens on Mac OS, so it almost always works on Mac OS.&nbsp; Occasionally things will break for the other OSes; the time it takes to fix such problems is largely a function of how quickly problems are reported.&nbsp; In general, problems are noticed on Linux fairly quickly (especially for big problems) and noticed on Windows rather slowly.&nbsp; If you notice something not working or that seems strange, please submit an issue on the github tracker or send a message to the pox-dev mailing list so that it can be fixed!</p>
<p>POX can be used with the &#8220;standard&#8221; Python interpreter (CPython), but also supports&nbsp;<a class="reference external" href="http://pypy.org/">PyPy</a>&nbsp;(see below).</p>
</div>
<div class="section" id="getting-the-code-installing-pox">
<h2><a class="toc-backref" href="#id9">Getting the Code / Installing POX</a><a class="headerlink" href="#getting-the-code-installing-pox" title="Permalink to this headline">¶</a></h2>
<p>The best way to work with POX is as a&nbsp;<a class="reference external" href="http://git-scm.com/">git</a>&nbsp;repository.&nbsp; You can also grab it as a tarball or zipball, but source control is generally a good thing (if you do want to do this, take a look at the&nbsp;<a class="reference external" href="http://www.noxrepo.org/pox/versionsdownloads/">Versions / Downloads page</a>&nbsp;at NOXRepo.org).</p>
<p>POX is hosted on&nbsp;<a class="reference external" href="http://github.com/">github</a>.&nbsp; If you intend to make modifications to POX itself, you might consider&nbsp;<a class="reference external" href="https://help.github.com/articles/fork-a-repo">making your own github fork</a>&nbsp;of it from the&nbsp;<a class="reference external" href="http://github.com/noxrepo/pox">POX repository page</a>.&nbsp; If you just want to grab it quickly to run or play around with, you can simply create a local clone:</p>
<div class="highlight-bash"><div class="highlight"><pre><span class="nv">$ </span>git clone http://github.com/noxrepo/pox
<span class="nv">$ </span><span class="nb">cd </span>pox
</pre></div>
</div>
</div>
<div class="section" id="selecting-a-branch-version">
<h2><a class="toc-backref" href="#id10">Selecting a Branch / Version</a><a class="headerlink" href="#selecting-a-branch-version" title="Permalink to this headline">¶</a></h2>
<p>h1. The POX repository has multiple branches.&nbsp; Specifically, it has at least some&nbsp;<em>release</em>&nbsp;branches and at least one&nbsp;<em>active</em>&nbsp;branch.&nbsp; The default branch (what you get if you just do the above commands) will be the most recent release branch.&nbsp; Release branches may get minor updates, but are no longer being actively developed.&nbsp; On the other hand, active branches&nbsp;<em>are</em>&nbsp;being actively developed.&nbsp; In theory, release branches should be somewhat more stable (by which we mean that if you have something working, we aren&#8217;t going to break it).&nbsp; On the other hand, active branches will contain improvements (bug fixes, new features, etc.).&nbsp; Whether you should base your work on one or the other depends on your needs.&nbsp; One thing that may factor into your decision is that you&#8217;ll probably get better support on the mailing list if you&#8217;re using an active branch (lots of answers start with &#8220;upgrade to the active branch&#8221;).</p>
<p>The main POX branches are named alphabetically after fish.&nbsp; You can see the one you&#8217;re currently on with&nbsp;<code class="code mono bash docutils literal"><span class="pre">git</span> <span class="pre">branch</span></code>.&nbsp; As of this writing, the branches and the approximate dates during which they were undergoing active development are:</p>
<ul class="simple">
<li><em>angler (June 2011 - March 2013)</em></li>
<li><em>betta (Until May 2013)</em></li>
<li><em>carp (Until October 2013)</em></li>
<li><em>dart (Until July 2014)</em></li>
<li><em>eel (...)</em></li>
</ul>
<p>This means that (as of this writing!),&nbsp;<em>dart</em>&nbsp;is the most recent release branch, and&nbsp;<em>eel</em>&nbsp;is the current active branch.&nbsp; (Sidenote,&nbsp;<em>angler</em>&nbsp;is the same as the original&nbsp;<em>master</em>&nbsp;branch, which has been removed to avoid confusion.)</p>
<p>To use the&nbsp;<em>dart</em>&nbsp;branch, for example, you simply check it out after cloning the repository:</p>
<div class="highlight-bash"><div class="highlight"><pre>~<span class="nv">$ </span>git clone http://github.com/noxrepo/pox
~<span class="nv">$ </span><span class="nb">cd </span>pox
~/pox<span class="nv">$ </span>git checkout dart
</pre></div>
</div>
<p>You can find more information on POX versions / branches&nbsp;<a class="reference external" href="http://www.noxrepo.org/pox/versionsdownloads/">on the main NOXRepo site</a>.</p>
</div>
<div class="section" id="pypy-support">
<h2><a class="toc-backref" href="#id11">PyPy Support</a><a class="headerlink" href="#pypy-support" title="Permalink to this headline">¶</a></h2>
<p>While it&#8217;s not as heavily tested as the normal Python interpreter, it&#8217;s a goal of POX to run well on the&nbsp;<a class="reference external" href="http://pypy.org/">PyPy</a>&nbsp;Python runtime.&nbsp; There are two advantages of this.&nbsp; First, PyPy is generally quite a bit faster than CPython.&nbsp; Secondly, it&#8217;s very easily portable &#8211; you can easily package up POX and PyPy in a single tarball and have them ready to run.</p>
<p>You can, of course, download, install, and invoke PyPy in the usual way.&nbsp; On Mac OS and Linux, however, POX also supports a really simple method: Download the latest PyPy tarball for your OS, and decompress it into a folder named <code class="code mono bash docutils literal"><span class="pre">pypy</span></code> alongside&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.py</span></code>.&nbsp; Then just run <code class="code mono bash docutils literal"><span class="pre">pox.py</span></code>&nbsp;as usual (<code class="code mono bash docutils literal"><span class="pre">./pox.py</span></code>), and it should use PyPy instead of CPython.</p>
</div>
</div>
<div class="section" id="invoking-pox">
<h1><a class="toc-backref" href="#id12">Invoking POX</a><a class="headerlink" href="#invoking-pox" title="Permalink to this headline">¶</a></h1>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><strong>Quick Start</strong>: If you just want a quick start, try: <br /><br /> <code class="code mono bash docutils literal"><span class="pre">./pox.py</span> <span class="pre">samples.pretty_log</span> <span class="pre">forwarding.l2_learning</span></code></p>
</div>
<p>POX is invoked by running&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.py</span></code> or <code class="code mono bash docutils literal"><span class="pre">&nbsp;debug-pox.py</span></code>.&nbsp; The former is meant for running under ordinary circumstances.&nbsp; The latter is meant for when you&#8217;re trying to debug problems (it&#8217;s a good idea to use&nbsp;<code class="code mono bash docutils literal"><span class="pre">debug-pox.py</span></code>&nbsp;when doing development).</p>
<p>POX itself has a couple of optional commandline arguments than can be used at the start of the commandline:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td>option</td>
<td>meaning</td>
</tr>
<tr class="row-even"><td><nobr> <code class="code mono bash docutils literal"><span class="pre">--verbose</span></code> </nobr></td>
<td>Display extra information (especially useful for debugging startup problems) <br /> <em>Note:</em> Generally this is not what you want, and what you want is actually to adjust the logging level via the log.level component.</td>
</tr>
<tr class="row-odd"><td><nobr> <code class="code mono bash docutils literal"><span class="pre">--no-cli</span></code> </nobr></td>
<td>Do not start an interactive shell (No longer applies as of betta)</td>
</tr>
<tr class="row-even"><td><nobr> <code class="code mono bash docutils literal"><span class="pre">--no-openflow</span></code> </nobr></td>
<td>Do not automatically start listening for OpenFlow connections (Less useful starting with dart, which only loads OpenFlow on demand)</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<p class="last">Add &#8211;unthreaded-sh to the above</p>
</div>
<p>But running POX by itself doesn&#8217;t do much – POX functionality is provided by&nbsp;<em>components</em>&nbsp;(POX comes with a handful of components, but POX&#8217;s target audience is really people who want to be developing their own).&nbsp; Components are specified on the commandline following any of the POX options above. An example of a POX component is&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding.l2_learning</span></code>.&nbsp; This component makes OpenFlow switches operate kind of like L2 learning switches.&nbsp; To run this component, you simply name it on the command line following any POX options:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py --no-cli forwarding.l2_learning
</pre></div>
</div>
<p>You can specify multiple components on the command line.&nbsp; Not all components work well together, but some do.&nbsp; Indeed, some components depend on other components, so you may&nbsp;<em>need</em>&nbsp;to specify multiple components.&nbsp; For example, you can run POX&#8217;s web server component along with&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py --no-cli forwarding.l2_learning web.webcore
</pre></div>
</div>
<p>Some components take arguments themselves.&nbsp; These follow the component name and (like POX arguments) begin with two dashes.&nbsp; For example,&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>&nbsp;has a &#8220;transparent&#8221; mode where switches will even forward packets that are usually dropped (such as LLDP messages), and the web server&#8217;s port number can be changed from the default (8000) to an arbitrary port.&nbsp; For example:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py --no-cli forwarding.l2_learning --transparent web.webcore --port<span class="o">=</span>8888
</pre></div>
</div>
<p>(If you&#8217;re starting to think that command lines can get a bit long and complex, there&#8217;s a solution: write a simple component that just launches other components.)</p>
</div>
<div class="section" id="components-in-pox">
<h1><a class="toc-backref" href="#id13">Components in POX</a><a class="headerlink" href="#components-in-pox" title="Permalink to this headline">¶</a></h1>
<p>When we talk about components in POX, what we really mean is something that we can put on the POX command line as described in &#8220;Invoking POX&#8221;.&nbsp; In the following sections, we discuss some of the components that come with POX and how you can go about creating your own.</p>
<div class="section" id="stock-components">
<h2><a class="toc-backref" href="#id14">Stock Components</a><a class="headerlink" href="#stock-components" title="Permalink to this headline">¶</a></h2>
<p>POX comes with a number of stock components.&nbsp; Some of these provide core functionality, some provide convenient features, and some are just examples.&nbsp; The following is an&nbsp;<em>incomplete</em> list.</p>
<div class="section" id="py">
<h3><a class="toc-backref" href="#id15">py</a><a class="headerlink" href="#py" title="Permalink to this headline">¶</a></h3>
<p>This component causes POX to start an interactive Python interpreter that can be useful for debugging and interactive experimentation.&nbsp; Before the betta branch, this was the default behavior (unless disabled with the now obsolete&nbsp;<code class="code mono bash docutils literal"><span class="pre">--no-cli</span></code>).&nbsp; Other components can add functions / values to this interpreter&#8217;s namespace (see&nbsp;<code class="code mono bash docutils literal"><span class="pre">proto.arp_responder</span></code>&nbsp;for an example).</p>
</div>
<div class="section" id="forwarding-hub">
<h3><a class="toc-backref" href="#id16">forwarding.hub</a><a class="headerlink" href="#forwarding-hub" title="Permalink to this headline">¶</a></h3>
<p>The hub example just installs wildcarded flood rules on every switch, essentially turning them all into $10 ethernet hubs.</p>
</div>
<div class="section" id="forwarding-l2-learning">
<h3><a class="toc-backref" href="#id17">forwarding.l2_learning</a><a class="headerlink" href="#forwarding-l2-learning" title="Permalink to this headline">¶</a></h3>
<p>This component makes OpenFlow switches act as a type of L2 learning switch.&nbsp; This one operates much like NOX&#8217;s &#8220;pyswitch&#8221; example, although the implementation is quite different.&nbsp; While this component learns L2 addresses, the flows it installs are exact-matches on as many fields as possible.&nbsp; For example, different TCP connections will result in different flows being installed.</p>
</div>
<div class="section" id="forwarding-l2-pairs">
<h3><a class="toc-backref" href="#id18">forwarding.l2_pairs</a><a class="headerlink" href="#forwarding-l2-pairs" title="Permalink to this headline">¶</a></h3>
<p>Like l2_learning, this component also makes OpenFlow switches act like a type of L2 learning switch.&nbsp; However, this one is probably just about the simplest possible way to do it correctly.&nbsp; Unlike l2_learning, l2_pairs installs rules based purely on MAC addresses.</p>
</div>
<div class="section" id="forwarding-l3-learning">
<h3><a class="toc-backref" href="#id19">forwarding.l3_learning</a><a class="headerlink" href="#forwarding-l3-learning" title="Permalink to this headline">¶</a></h3>
<p>This component is not quite a router, but it&#8217;s also definitely not an L2 switch.&nbsp; It&#8217;s an L3-learning-switchy-thing.&nbsp; Perhaps the most useful aspect of it is that it serves as a pretty good example of using POX&#8217;s packet library to examine and construct ARP requests and replies.</p>
<p><code class="code mono bash docutils literal"><span class="pre">l3_learning</span></code>&nbsp;does not really care about conventional IP stuff like subnets – it just learns where IP addresses are.&nbsp; Unfortunately, hosts usually&nbsp;<em>do</em>&nbsp;care about that stuff.&nbsp; Specifically, if a host has a gateway set for some subnet, it really wants to communicate with that subnet through that gateway.&nbsp; To handle this, you can specify &#8220;fake gateways&#8221; in the commandline to&nbsp;<code class="code mono bash docutils literal"><span class="pre">l3_learning</span></code>, which will make hosts happy.&nbsp; For example, if you have some machines which think they&#8217;re on 10.x.x.x and others that think they&#8217;re on 192.168.0.x and they think there are gateways at the &#8221;.1&#8221; addresses:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py forwarding.l3_learning --fakeways<span class="o">=</span>10.0.0.1,192.168.0.1
</pre></div>
</div>
</div>
<div class="section" id="forwarding-l2-multi">
<h3><a class="toc-backref" href="#id20">forwarding.l2_multi</a><a class="headerlink" href="#forwarding-l2-multi" title="Permalink to this headline">¶</a></h3>
<p>This component can still be seen as a learning switch, but it has a twist compared to the others.&nbsp; The other learning switches &#8220;learn&#8221; on a switch-by-switch basis, making decisions as if each switch only had local information.&nbsp; l2_multi uses openflow.discovery to learn the topology of the entire network: as soon as one switch learns where a MAC address is, they all do.&nbsp; Note that this means you must include openflow.discovery on the commandline.</p>
</div>
<div class="section" id="forwarding-l2-nx">
<h3><a class="toc-backref" href="#id21">forwarding.l2_nx</a><a class="headerlink" href="#forwarding-l2-nx" title="Permalink to this headline">¶</a></h3>
<p>A quick-and-dirty learning switch for Open vSwitch – it uses Nicira extensions as found in Open vSwitch.</p>
<p>Run with something like:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py openflow.nicira --convert-packet-in forwarding.l2_nx
</pre></div>
</div>
<p>This forwards based on ethernet source and destination addresses.&nbsp; Where&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_pairs</span></code>&nbsp;installs rules for each pair of source and destination address, this component uses two tables on the switch &#8211; one for source addresses and one for destination addresses.</p>
<p>Note that unlike the other learning switches&nbsp;<em>we keep no state in the controller</em>.&nbsp; In truth, we could implement this whole thing using OVS&#8217;s learn action, but doing it something like is done here will still allow us to implement access control or something at the controller.</p>
</div>
<div class="section" id="forwarding-topo-proactive">
<h3><a class="toc-backref" href="#id22">forwarding.topo_proactive</a><a class="headerlink" href="#forwarding-topo-proactive" title="Permalink to this headline">¶</a></h3>
<p>Installs forwarding rules based on topologically significant IP addresses.&nbsp; We also issue those addresses by DHCP.&nbsp; A host must use the assigned IP!</p>
<p>Most rules are installed proactively.&nbsp; This component was added in the carp branch.&nbsp; The routing code is based on forwarding.l2_multi.</p>
<p>Depends on openflow.discovery and at least sort of works with openflow.spanning_tree (not particularly tested or examined).</p>
</div>
<div class="section" id="openflow-spanning-tree">
<h3><a class="toc-backref" href="#id23">openflow.spanning_tree</a><a class="headerlink" href="#openflow-spanning-tree" title="Permalink to this headline">¶</a></h3>
<p>This component uses the discovery component to build a view of the network topology, constructs a spanning tree, and then disables flooding on switch ports that aren&#8217;t on the tree.&nbsp; The result is that topologies with loops no longer turn your network into useless hot packet soup.</p>
<p>Note that this does not have much of a relationship to Spanning Tree Protocol.&nbsp; They have similar purposes, but this is a rather different way of going about it.</p>
<p>The&nbsp;<code class="code mono bash docutils literal"><span class="pre">samples.spanning_tree</span></code>&nbsp;component demonstrates this module by loading it and one of several forwarding components.</p>
<p>This component has two options which alter the startup behavior:</p>
<p><code class="code mono bash docutils literal"><span class="pre">--no-flood</span></code>&nbsp;disables flooding on all ports as soon as a switch connects; on some ports, it will be enabled later.</p>
<p><code class="code mono bash docutils literal"><span class="pre">--hold-down</span></code>&nbsp;prevents altering of flood control until a complete discovery cycle has completed (and thus, all links have had an opportunity to be discovered).</p>
<p>Thus, the safest (and probably the most sensible) invocation is&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.spanning_tree</span> <span class="pre">--no-flood</span> <span class="pre">--hold-down</span></code>&nbsp;.</p>
</div>
<div class="section" id="openflow-webservice">
<h3><a class="toc-backref" href="#id24">openflow.webservice</a><a class="headerlink" href="#openflow-webservice" title="Permalink to this headline">¶</a></h3>
<p>A simple JSON-RPC-ish web service for interacting with OpenFlow.&nbsp; It&#8217;s&nbsp;derived from the&nbsp;<code class="code mono bash docutils literal"><span class="pre">of_service</span></code>&nbsp;messenger service, so see its docs (in the reference/pydoc) for some additional details.</p>
<p>It requires the webcore component.&nbsp; You access it by sending an HTTP POST to&nbsp;<code class="code mono bash docutils literal"><span class="pre">http://wherever_webcore_is_running/OF/</span></code>.&nbsp; The POST data is a JSON string containing (at least) a &#8220;method&#8221; key containing the name of the method to invoke, and a &#8220;params&#8221; key which contains a dictionary of argument names and their values.</p>
<p>Current methods include:</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="18%" />
<col width="75%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">method</th>
<th class="head">description</th>
<th class="head">arguments</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>set_table</td>
<td>Sets the flow table on a switch.</td>
<td>dpid - a string dpid <br /> flows - a list of flow entries</td>
</tr>
<tr class="row-odd"><td>get_switch_desc</td>
<td>Gets switch details.</td>
<td>dpid - a string dpid</td>
</tr>
<tr class="row-even"><td>get_flow_stats</td>
<td>Get list of flows in a table.</td>
<td>dpid - a string dpid <br /> match - match structure (optional, defaults to match all) <br /> table_id - table for flows (defaults to all) <br /> out_port - filter by out port (defaults to all)</td>
</tr>
<tr class="row-odd"><td>get_switches</td>
<td>Get list of switches and their basic info.</td>
<td>None.</td>
</tr>
</tbody>
</table>
<div class="section" id="example-get-list-of-connected-switches">
<h4><a class="toc-backref" href="#id25">Example: Get list of connected switches</a><a class="headerlink" href="#example-get-list-of-connected-switches" title="Permalink to this headline">¶</a></h4>
<p>This is pretty easy:</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -i -X POST -d <span class="s1">&#39;{&quot;method&quot;:&quot;get_switches&quot;,&quot;id&quot;:1}&#39;</span> http://127.0.0.1:8000/
</pre></div>
</div>
<p>Note the use of the &#8220;<code class="code mono bash docutils literal"><span class="pre">id</span></code>&#8221; field.&nbsp; This is a requirement of JSON-RPC as per the various specfications.&nbsp; Without it, the call is interpreted as a notification – for which the server should not return a value.&nbsp; POX doesn&#8217;t really care much what you put in this field, though the JSON-RPC specs do say some stuff about it which you would be wise to not entirely ignore.&nbsp; An integer is a safe bet.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you don&#8217;t include an &#8220;id&#8221; key, you will not get a response!&nbsp; The above paragraph explains why, but it&#8217;s worth pointing it out again!</p>
</div>
</div>
<div class="section" id="example-making-a-hub-using-the-webservice">
<h4><a class="toc-backref" href="#id26">Example: Making a hub using the webservice</a><a class="headerlink" href="#example-making-a-hub-using-the-webservice" title="Permalink to this headline">¶</a></h4>
<p>We can turn the switch with DPID 00-00-00-00-00-01 into a hub by inserting a table entry which matches all packets and sends them to the special OFPP_ALL port.</p>
<div class="highlight-bash"><div class="highlight"><pre>curl -i -X POST -d <span class="s1">&#39;{&quot;method&quot;:&quot;set_table&quot;,&quot;params&quot;:{&quot;dpid&quot;:&quot;00-00-00-00-00-01&quot;, \</span>
<span class="s1">                   &quot;flows&quot;:[{&quot;actions&quot;:[{&quot;type&quot;:&quot;OFPAT_OUTPUT&quot;,&quot;port&quot;:&quot;OFPP_ALL&quot;}], \</span>
<span class="s1">                   &quot;match&quot;:{`]`&#39;</span> http://127.0.0.1:8000/OF/
</pre></div>
</div>
</div>
</div>
<div class="section" id="web-webcore">
<h3><a class="toc-backref" href="#id27">web.webcore</a><a class="headerlink" href="#web-webcore" title="Permalink to this headline">¶</a></h3>
<p>The webcore component starts a web server within the POX process.&nbsp; Other components can interface with it to provide static and dynamic content of their own.</p>
</div>
<div class="section" id="messenger">
<h3><a class="toc-backref" href="#id28">messenger</a><a class="headerlink" href="#messenger" title="Permalink to this headline">¶</a></h3>
<p>The messenger component provides an interface for POX to interact with external processes via bidirectional JSON-based messages.&nbsp; The messenger by itself is really just an API, actual communication is implemented by&nbsp;<em>transports</em>.&nbsp; Currently, transports exist for TCP sockets and for HTTP.&nbsp; Actual functionality is implemented by&nbsp;<em>services</em>.&nbsp; POX comes with a few services.&nbsp; messenger.log_service allows for interacting with the log remotely (reading it, reconfiguring it, etc.).&nbsp; openflow.of_service allows for some OpenFlow operations (e.g., listing switches, setting flow entries, etc.).&nbsp; There are also a few small example services in the messenger package, and pox-log.py (in the tools directory) is a small, standalone, external Python application which interfaces with the the logging service over TCP.</p>
<p>By writing a new service, it becomes available over any transport.&nbsp; Similarly, writing a new transport allows for accessing any service in a new way.</p>
<p>The messenger package in the repository has a fair amount of comments.&nbsp; Additionally, you can see POXDesk (mentioned elsewhere) as an example of both implementing a new service, and communicating with messenger over HTTP from JavaScript.</p>
<div class="section" id="getting-started-with-the-messenger-component">
<h4><a class="toc-backref" href="#id29">Getting Started with the Messenger Component</a><a class="headerlink" href="#getting-started-with-the-messenger-component" title="Permalink to this headline">¶</a></h4>
<p>To get messenger running, run the messenger component along with some transport(s).&nbsp; For the sake of example, we&#8217;ll run the passive (listening) TCP transport and the example messenger service:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre>[pox_dart]$ ./pox.py log.level --DEBUG messenger messenger.tcp_transport messenger.example
POX 0.3.0 (dart) / Copyright 2011-2014 James McCauley, et al.
DEBUG:boot:Not launching of_01
DEBUG:core:POX 0.3.0 (dart) going up...
DEBUG:core:Running on CPython (2.7.5/Sep 12 2013 21:33:34)
DEBUG:messenger.tcp_transport:Listening on 0.0.0.0:7790
DEBUG:core:Platform is Darwin-13.1.0-x86_64-i386-64bit
INFO:core:POX 0.3.0 (dart) is up.
</pre></div>
</td></tr></table></div>
<p>Now we can connect and use services by connecting to the listening messenger socket.&nbsp; We can demonstrate this with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">test_client.py</span></code>&nbsp;program.&nbsp; On starting it up, it connects to the default host/port which gets POX, and messenger sends us a welcome:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre>[messenger]$ python test_client.py
Connecting to 127.0.0.1:7790
Recv: {
    &quot;cmd&quot;: &quot;welcome&quot;,
    &quot;CHANNEL&quot;: &quot;&quot;,
    &quot;session_id&quot;: &quot;bQ6QCYI3ICOGLJPOT7HMVXTN7RE&quot;
}
</pre></div>
</td></tr></table></div>
<p>We can then send a message to one of the bots that the example service set up.&nbsp; We&#8217;ll use the &#8220;upper&#8221; service which just capitalizes messages you send to it.&nbsp; Line 8 is typed into&nbsp;<code class="code mono bash docutils literal"><span class="pre">test_client.py</span></code>&nbsp;to send a message, and the rest is the reply from POX:</p>
<div class="highlight-none"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 8
 9
10
11
12
13</pre></div></td><td class="code"><div class="highlight"><pre>{&quot;CHANNEL&quot;:&quot;upper&quot;,&quot;msg&quot;:&quot;hello world&quot;}
Recv: {
    &quot;count&quot;: 1,
    &quot;msg&quot;: &quot;HELLO WORLD&quot;,
    &quot;CHANNEL&quot;: &quot;upper&quot;
}
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="openflow-of-01">
<h3><a class="toc-backref" href="#id30">openflow.of_01</a><a class="headerlink" href="#openflow-of-01" title="Permalink to this headline">¶</a></h3>
<p>This component communicates with OpenFlow 1.0 (wire protocol 0x01) switches.&nbsp; When other components that use OpenFlow are loaded, this component is usually started with default values automatically.&nbsp; However, you may want to launch it manually in order to change its options.&nbsp; You may also want to launch it manually to run it multiple times (e.g., to listen for OpenFlow connections on multiple ports).</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="13%" />
<col width="55%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">option</th>
<th class="head">default</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><nobr> &#8211;port=&lt;X&gt; </nobr></td>
<td>6633</td>
<td>Specifies the TCP port to listen for connections on</td>
</tr>
<tr class="row-odd"><td><nobr> &#8211;address=&lt;X&gt; </nobr></td>
<td>all addresses</td>
<td>Specifies the IP addresses of interfaces to listen on</td>
</tr>
<tr class="row-even"><td><nobr> &#8211;private-key=&lt;X&gt; </nobr></td>
<td>None</td>
<td>Enables SSL mode and specifies a key file</td>
</tr>
<tr class="row-odd"><td><nobr> &#8211;certificate=&lt;X&gt; </nobr></td>
<td>None</td>
<td>Enables SSL mode and specifies a certificate file</td>
</tr>
<tr class="row-even"><td><nobr> &#8211;ca-cert=&lt;X&gt; </nobr></td>
<td>None</td>
<td>Enables SSL mode and specifies a certificate to validate switches</td>
</tr>
</tbody>
</table>
<p>To configure SSL, the Open vSwitch INSTALL.SSL file and the man page for ovs-controller have a lot of useful info, including info on how to generate the appropriate files to be passed for the various arguments of this component.</p>
</div>
<div class="section" id="openflow-discovery">
<h3><a class="toc-backref" href="#id31">openflow.discovery</a><a class="headerlink" href="#openflow-discovery" title="Permalink to this headline">¶</a></h3>
<p>This component sends specially-crafted LLDP messages out of OpenFlow switches so that it can discover the network topology.&nbsp; It raises events (which you can listen to) when links go up or down.</p>
<p>More specifically, you can listen to&nbsp;<code class="code mono bash docutils literal"><span class="pre">LinkEvent</span></code>&nbsp;events on&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow_discovery</span></code>.&nbsp; When a link is detected, such an event is raised with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.added</span></code>&nbsp;attribute set to True.&nbsp; When a link is detected as having been removed or failed, the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.removed</span></code>&nbsp;attribute is set to True.&nbsp;&nbsp;<code class="code mono bash docutils literal"><span class="pre">LinkEvent</span></code>&nbsp;also has a .link attribute, which is a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Link</span></code>&nbsp;object, and a&nbsp;<code class="code mono bash docutils literal"><span class="pre">port_for_dpid</span><span class="operator"><span class="pre">(</span></span><span class="pre">&lt;dpid&gt;</span><span class="operator"><span class="pre">)</span></span></code>&nbsp;method (pass it the DPID of one end of the link and it will tell you the port used on that datapath).</p>
<p><code class="code mono bash docutils literal"><span class="pre">Link</span></code>&nbsp;objects have the following attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="15%" />
<col width="85%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">value</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>dpid1</td>
<td>The DPID of one of the switches involved in the link</td>
</tr>
<tr class="row-odd"><td>port1</td>
<td>The port on dpid1 involved in the link</td>
</tr>
<tr class="row-even"><td>dpid2</td>
<td>The DPID of the other switch involved in the link</td>
</tr>
<tr class="row-odd"><td>port2</td>
<td>The port on dpid2</td>
</tr>
<tr class="row-even"><td>uni</td>
<td>A &#8220;unidirectional&#8221; version of the link.&nbsp; This normalizes the order of the DPIDs and ports, allowing you to compare two links (which may be different directions of the same physical links).</td>
</tr>
<tr class="row-odd"><td><nobr> end[0 or 1] </nobr></td>
<td>The ends of the link as a tuple, i.e., end[0] = (dpid1,port1)</td>
</tr>
</tbody>
</table>
<p>A number of the other example components use discovery and can serve as demonstrations for using discovery.&nbsp; Obvious possibilities are&nbsp;<code class="code mono bash docutils literal"><span class="pre">misc.gephi_topo</span></code>&nbsp;and&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding.l2_multi</span></code>.</p>
</div>
<div class="section" id="openflow-debug">
<h3><a class="toc-backref" href="#id32">openflow.debug</a><a class="headerlink" href="#openflow-debug" title="Permalink to this headline">¶</a></h3>
<p>Loading this component will cause POX to create pcap traces containing OpenFlow messages, which you can then load into Wireshark to analyze.&nbsp; All the headers are synthetic so it&#8217;s not totally a replacement for actually running tcpdump or Wireshark. It does, however, have the nice property that there is exactly one OpenFlow message in each frame (which makes it easier to look at!).</p>
</div>
<div class="section" id="openflow-keepalive">
<h3><a class="toc-backref" href="#id33">openflow.keepalive</a><a class="headerlink" href="#openflow-keepalive" title="Permalink to this headline">¶</a></h3>
<p>This component causes POX to send periodic echo requests to connected switches.&nbsp; This addresses two issues.</p>
<p>First, some switches (including the reference switch) will assume that an idle control connection indicates a loss of connectivity to the controller and will disconnect after some period of silence (often not particularly long).&nbsp; This behavior is almost certainly broken: one can easily argue that if the switches want to disconnect when the connection is idle, it is&nbsp;<em>their</em>&nbsp;responsibility to send echo requests, but arguing won&#8217;t fix the switches.</p>
<p>Secondly, if you lose network connectivity to the switch, you don&#8217;t immediately get a FIN or a RST, so it&#8217;s hard to say exactly when you&#8217;ll notice that you&#8217;ve lost the switch.&nbsp; By sending echo requests and tracking their responses, you get a bound on how long it will take to notice.</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<p class="last">This component is badly named and will probably be renamed in a future version (possibly eel).</p>
</div>
</div>
<div class="section" id="proto-pong">
<h3><a class="toc-backref" href="#id34">proto.pong</a><a class="headerlink" href="#proto-pong" title="Permalink to this headline">¶</a></h3>
<p>The pong component is a sort of silly example which simply watches for ICMP echo requests (pings) and replies to them.&nbsp; If you run this component, all pings will seem to be successful!&nbsp; It serves as a simple example of monitoring and sending packets and of working with ICMP.</p>
</div>
<div class="section" id="proto-arp-responder">
<h3><a class="toc-backref" href="#id35">proto.arp_responder</a><a class="headerlink" href="#proto-arp-responder" title="Permalink to this headline">¶</a></h3>
<p>An ARP utility that can learn and proxy ARPs, and can also answer queries from a list of static entries.&nbsp; This component also adds the ARP table to the interactive console as &#8220;<code class="code mono bash docutils literal"><span class="pre">arp</span></code>&#8221; – allowing you to interactively query and modify it.</p>
<p>Simply specify IP addresses and the ethernet address you want to associate with them as options:</p>
<div class="highlight-bash"><div class="highlight"><pre>proto.arp_responder --192.168.0.1<span class="o">=</span>00:00:00:00:00:01 --192.168.0.2<span class="o">=</span>00:00:00:00:00:02
</pre></div>
</div>
</div>
<div class="section" id="info-packet-dump">
<h3><a class="toc-backref" href="#id36">info.packet_dump</a><a class="headerlink" href="#info-packet-dump" title="Permalink to this headline">¶</a></h3>
<p>A simple component that dumps packet_in info to the log.&nbsp; Sort of like running tcpdump on a switch.</p>
</div>
<div class="section" id="proto-dns-spy">
<h3><a class="toc-backref" href="#id37">proto.dns_spy</a><a class="headerlink" href="#proto-dns-spy" title="Permalink to this headline">¶</a></h3>
<p>This component monitors DNS replies and stores their results.&nbsp; Other components can examine them by accessing <code class="code mono bash docutils literal"><span class="pre">core.DNSSpy.ip_to_name</span><span class="operator"><span class="pre">[</span></span><span class="pre">&lt;ip</span> <span class="pre">address&gt;</span><span class="operator"><span class="pre">]</span></span></code> and <code class="code mono bash docutils literal"><span class="pre">core.DNSSpy.name_to_ip</span><span class="operator"><span class="pre">[</span></span><span class="pre">&lt;domain</span> <span class="pre">name&gt;</span><span class="operator"><span class="pre">]</span></span></code>.</p>
</div>
<div class="section" id="proto-dhcp-client">
<h3><a class="toc-backref" href="#id38">proto.dhcp_client</a><a class="headerlink" href="#proto-dhcp-client" title="Permalink to this headline">¶</a></h3>
<p>A DHCP client component.&nbsp; This is probably not useful on its own, but can be useful in conjunction with other components.</p>
</div>
<div class="section" id="proto-dhcpd">
<h3><a class="toc-backref" href="#id39">proto.dhcpd</a><a class="headerlink" href="#proto-dhcpd" title="Permalink to this headline">¶</a></h3>
<p>This is a simple DHCP server.&nbsp; By default, it claims to be 192.168.0.254, and serves clients addresses in the range 192.168.0.1 to 192.168.0.253, claiming itself to be the gateway and the DNS server.</p>
<p>Note: You might want to use&nbsp;<code class="code mono bash docutils literal"><span class="pre">proto.arp_responder</span></code>&nbsp;to make 192.168.0.254 (or whatever you choose as the IP address) ARP-able.</p>
<p>There are a number of options you can configure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="11%" />
<col width="89%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Option</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>network</td>
<td>Subnet to allocate addresses from, e.g., &#8220;192.168.0.0/24&#8221; or &#8220;10.0.0.0/255.0.0.0&#8221;</td>
</tr>
<tr class="row-odd"><td>first</td>
<td>First&#8217;th address in subnet to use (256 is x.x.1.0 in a /16).</td>
</tr>
<tr class="row-even"><td>last</td>
<td>Last&#8217;th address in subnet to use (258 is x.x.1.2 in a /16).&nbsp; If &#8216;None&#8217;, use rest of valid range.</td>
</tr>
<tr class="row-odd"><td>count</td>
<td>Alternate way to specify last address to use</td>
</tr>
<tr class="row-even"><td>ip</td>
<td>IP to use for DHCP server</td>
</tr>
<tr class="row-odd"><td>router</td>
<td>Router IP to tell clients. Defaults to whatever is set for <code class="code mono bash docutils literal"><span class="pre">ip</span></code>. &#8216;None&#8217; will stop the server from telling clients anything.</td>
</tr>
<tr class="row-even"><td>dns</td>
<td>DNS server to tell clients.&nbsp; Defaults to whatever is set for <code class="code mono bash docutils literal"><span class="pre">router</span></code>. &#8216;None&#8217; will stop the server from telling clients anything.</td>
</tr>
</tbody>
</table>
<p>Example:</p>
<div class="highlight-bash"><div class="highlight"><pre>proto.dhcpd --network<span class="o">=</span>10.1.1.0/24 --ip<span class="o">=</span>10.1.1.1 --first<span class="o">=</span><span class="m">10</span> --last<span class="o">=</span>None --router<span class="o">=</span>None --dns<span class="o">=</span>4.2.2.1
</pre></div>
</div>
<p>You can also launch this component as&nbsp;<code class="code mono bash docutils literal"><span class="pre">proto.dhcpd:default</span></code>&nbsp;to serve 192.168.0.100-199.</p>
<p>Right before issuing an address, the DHCP server raises a DHCPLease event which you can listen to if you want to learn or deny address allocations:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_I_hate_00_00_00_00_00_03</span> <span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">host_mac</span> <span class="o">==</span> <span class="n">EthAddr</span><span class="p">(</span><span class="s">&quot;00:00:00:00:00:03&quot;</span><span class="p">):</span>
    <span class="n">event</span><span class="o">.</span><span class="n">nak</span><span class="p">()</span> <span class="c"># Deny it!</span>

<span class="n">core</span><span class="o">.</span><span class="n">DHCPD</span><span class="o">.</span><span class="n">addListenerByName</span><span class="p">(</span><span class="s">&#39;DHCPLease&#39;</span><span class="p">,</span> <span class="n">_I_hate_00_00_00_00_00_03</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="misc-of-tutorial">
<h3><a class="toc-backref" href="#id40">misc.of_tutorial</a><a class="headerlink" href="#misc-of-tutorial" title="Permalink to this headline">¶</a></h3>
<p>This component is for use with the&nbsp;<a class="reference external" href="http://www.openflow.org/wk/index.php/OpenFlow_Tutorial">OpenFlow tutorial</a>.&nbsp; It acts as a simple hub, but can be modified to act like an L2 learning switch.</p>
</div>
<div class="section" id="misc-full-payload">
<h3><a class="toc-backref" href="#id41">misc.full_payload</a><a class="headerlink" href="#misc-full-payload" title="Permalink to this headline">¶</a></h3>
<p>By default, when a packet misses the table on a switch, the switch may only send part of the packet (the first 128 bytes) to the controller.&nbsp; This component reconfigures every switch that connects so that it will send the full packet.</p>
</div>
<div class="section" id="misc-mac-blocker">
<h3><a class="toc-backref" href="#id42">misc.mac_blocker</a><a class="headerlink" href="#misc-mac-blocker" title="Permalink to this headline">¶</a></h3>
<p>This component is meant to be used alongside some other reactive forwarding applications, such as l2_learning and l2_pairs.&nbsp; It pops up a Tkinter-based GUI that lets you block MAC addresses.</p>
<p>It works by wedging its own PacketIn handler in front of the PacketIn handler of the forwarding component.&nbsp; When it wants to block something, it kills the event by returning EventHalt.&nbsp; Thus, the forwarding component never sees the packet/event, never sets up a flow, and the traffic just dies.</p>
<p>Thus, it demonstrates Tkinter-based GUIs in POX as well as some slightly-advanced event handling (using higher-priority event handlers to block PacketIns).&nbsp; See the pox.lib.revent section of this manual for more on working with events, and see the FAQ entry for creating a firewall for another not-entirely-dissimilar example that blocks TCP ports.</p>
</div>
<div class="section" id="misc-nat">
<h3><a class="toc-backref" href="#id43">misc.nat</a><a class="headerlink" href="#misc-nat" title="Permalink to this headline">¶</a></h3>
<p>A component which does Network Address Translation.</p>
</div>
<div class="section" id="misc-ip-loadbalancer">
<h3><a class="toc-backref" href="#id44">misc.ip_loadbalancer</a><a class="headerlink" href="#misc-ip-loadbalancer" title="Permalink to this headline">¶</a></h3>
<p>This component (which started in the carp branch) is a simple TCP load balancer.</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py misc.ip_loadbalancer --ip<span class="o">=</span>&lt;Service IP&gt; --servers<span class="o">=</span>&lt;Server1 IP&gt;,&lt;Server2 IP&gt;,... <span class="o">[</span>--dpid<span class="o">=</span>&lt;dpid&gt;<span class="o">]</span>
</pre></div>
</div>
<p>Give it a&nbsp;<code class="code mono bash docutils literal"><span class="pre">service_ip</span></code>&nbsp;and a list of server IP addresses.&nbsp; New TCP flows to the service IP will be randomly redirected to one of the server IPs.</p>
<p>Servers are periodically probed to see if they&#8217;re alive by sending them ARPs.</p>
<p>By default, it will make the first switch that connects into a load balancer and ignore the other switches.&nbsp; If you have a topology with multiple switches, it probably makes more sense to specify which one should be the load balancer, and this can be done with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">--dpid</span></code>&nbsp;commandline option.&nbsp; In this case, you probably want the rest of the switches to do something worthwhile (like forward traffic), and you may have to create a component that does this for you.&nbsp; For example, you might create a simple component which does the same thing as&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding.l2_learning</span></code>&nbsp;on all the switches besides the load balancer.&nbsp; You could do that with a simple component like the following:</p>
<div class="literal-block-wrapper container" id="ext-selective-switch-py">
<div class="code-block-caption"><span class="caption-text">ext/selective_switch.py</span><a class="headerlink" href="#ext-selective-switch-py" title="Permalink to this code">¶</a></div>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">More or less just l2_learning except it ignores a particular switch</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">pox.core</span> <span class="kn">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">pox.lib.util</span> <span class="kn">import</span> <span class="n">str_to_dpid</span>
<span class="kn">from</span> <span class="nn">pox.forwarding.l2_learning</span> <span class="kn">import</span> <span class="n">LearningSwitch</span>


<span class="k">def</span> <span class="nf">launch</span> <span class="p">(</span><span class="n">ignore_dpid</span><span class="p">):</span>
  <span class="n">ignore_dpid</span> <span class="o">=</span> <span class="n">str_to_dpid</span><span class="p">(</span><span class="n">ignore_dpid</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_handle_ConnectionUp</span> <span class="p">(</span><span class="n">event</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">dpid</span> <span class="o">!=</span> <span class="n">ignore_dpid</span><span class="p">:</span>
      <span class="n">core</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Connection </span><span class="si">%s</span><span class="s">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">connection</span><span class="p">,))</span>
      <span class="n">LearningSwitch</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">connection</span><span class="p">,</span> <span class="bp">False</span><span class="p">)</span>

  <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">addListenerByName</span><span class="p">(</span><span class="s">&quot;ConnectionUp&quot;</span><span class="p">,</span> <span class="n">_handle_ConnectionUp</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
<div class="section" id="misc-gephi-topo">
<h3><a class="toc-backref" href="#id45">misc.gephi_topo</a><a class="headerlink" href="#misc-gephi-topo" title="Permalink to this headline">¶</a></h3>
<p>Streams detected topology to Gephi.</p>
<img alt="_images/gephi_topo.png" src="_images/gephi_topo.png" />
<p><a class="reference external" href="http://gephi.org/">Gephi</a>&nbsp;is a pretty awesome open-source, multiplatform graph visualization/manipulation/analysis package. It has a plugin for streaming graphs back and forth between it and something else over a network connection. The&nbsp;<code class="code mono bash docutils literal"><span class="pre">gephi_topo</span></code>&nbsp;component uses this to provide visualization for switches, links, and (optionally) hosts detected by other POX components.&nbsp;There&#8217;s a&nbsp;<a class="reference external" href="http://www.noxrepo.org/2013/06/pox-and-gephi-graph-streaming-visualization/">blog post</a>&nbsp;about this component on&nbsp;<a class="reference external" href="http://noxrepo.org/">noxrepo.org</a>.</p>
<p>This component is loosely based on POXDesk&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">tinytopo</span></code>&nbsp;module.&nbsp; It requires&nbsp;<code class="code mono bash docutils literal"><span class="pre">discovery</span></code>, and&nbsp;<code class="code mono bash docutils literal"><span class="pre">host_tracker</span></code>&nbsp;is optional.Example usage:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py openflow.discovery misc.gephi_topo host_tracker forwarding.l2_learning
</pre></div>
</div>
<p>In July of 2014, Rizwan Jamil posted&nbsp;<a class="reference external" href="http://www.mail-archive.com/pox-dev&#64;lists.noxrepo.org/msg01418.html">a message on pox-dev</a>&nbsp;describing explicit steps for getting this up and running in Ubuntu.</p>
</div>
<div class="section" id="log">
<h3><a class="toc-backref" href="#id46">log</a><a class="headerlink" href="#log" title="Permalink to this headline">¶</a></h3>
<p>POX uses Python&#8217;s logging system, and the&nbsp;<code class="code mono bash docutils literal"><span class="pre">log</span></code>&nbsp;module allows you to configure a fair amount of this through the commandline. For example, you can send the log to a file, change the format of log messages to include the date, etc.</p>
<div class="section" id="disabling-the-console-log">
<h4><a class="toc-backref" href="#id47">Disabling the Console Log</a><a class="headerlink" href="#disabling-the-console-log" title="Permalink to this headline">¶</a></h4>
<p>You can disable POX&#8217;s &#8220;normal&#8221; log using:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --no-default
</pre></div>
</div>
</div>
<div class="section" id="log-formatting">
<h4><a class="toc-backref" href="#id48">Log Formatting</a><a class="headerlink" href="#log-formatting" title="Permalink to this headline">¶</a></h4>
<p>Please see the documentation on Python&#8217;s&nbsp;<a class="reference external" href="http://docs.python.org/2/library/logging.html#logrecord-attributes">LogRecord attributes</a>&nbsp;for details on log formatting.&nbsp; As a quick example, you can add timestamps to your log as follows:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --format<span class="o">=</span><span class="s2">&quot;%(asctime)s: %(message)s&quot;</span>
</pre></div>
</div>
<p>Or with simpler timestamps:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --format<span class="o">=</span><span class="s2">&quot;[%(asctime)s] %(message)s&quot;</span> --datefmt<span class="o">=</span><span class="s2">&quot;%H:%M:%S&quot;</span>
</pre></div>
</div>
<p>See the&nbsp;<code class="code mono bash docutils literal"><span class="pre">samples.pretty_log</span></code>&nbsp;component for another example (and, particularly, for an example that uses POX&#8217;s color logging extension).</p>
</div>
<div class="section" id="log-output">
<h4><a class="toc-backref" href="#id49">Log Output</a><a class="headerlink" href="#log-output" title="Permalink to this headline">¶</a></h4>
<p>Log messages are processed by various handlers which then print the log to the screen, save it to a file, send it over the network, etc.&nbsp; You can write your own, but Python also comes with quite a few, which are documented in the Python reference for&nbsp;<a class="reference external" href="http://docs.python.org/2/library/logging.handlers.html">logging.handlers</a>. POX lets you configure a lot of Python&#8217;s built-in handlers from the commandline; you should refer to the Python reference for the arguments, but specifically, POX lets you configure:</p>
<table border="1" class="docutils">
<colgroup>
<col width="32%" />
<col width="68%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>stderr</td>
<td>StreamHandler for stderr stream</td>
</tr>
<tr class="row-odd"><td>stdout</td>
<td>StreamHandler for stdout stream</td>
</tr>
<tr class="row-even"><td>File</td>
<td>FileHandler for named file</td>
</tr>
<tr class="row-odd"><td>WatchedFile</td>
<td>WatchedFileHandler</td>
</tr>
<tr class="row-even"><td>RotatingFile</td>
<td>RotatingFileHandler</td>
</tr>
<tr class="row-odd"><td>TimedRotatingFile</td>
<td>TimedRotatingFileHandler</td>
</tr>
<tr class="row-even"><td>Socket</td>
<td>SocketHandler - Sends to TCP socket</td>
</tr>
<tr class="row-odd"><td>Datagram</td>
<td>DatagramHandler - Sends over UDP</td>
</tr>
<tr class="row-even"><td>SysLog</td>
<td>SysLogHandler - Outputs to syslog service</td>
</tr>
<tr class="row-odd"><td>HTTP</td>
<td>HTTPHandler - Outputs to a web server via GET or POST</td>
</tr>
</tbody>
</table>
<p>To use these, simply specify the Name, followed by a comma-separated list of the positional arguments for the handler Type.&nbsp; For example, FileHandler takes a file name, and optionally an open mode (which defaults to append), so you could use:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --file<span class="o">=</span>pox.log
</pre></div>
</div>
<p>Or if you wanted to overwrite the file every time:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --file<span class="o">=</span>pox.log,w
</pre></div>
</div>
<p>You can also use named arguments by prefacing the entry with a&nbsp;<code class="code mono bash docutils literal"><span class="pre">*</span></code>&nbsp;and then using a comma-separated list of key=value pairs.&nbsp; For example:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log --*TimedRotatingFile<span class="o">=</span><span class="nv">filename</span><span class="o">=</span>foo.log,when<span class="o">=</span>D,backupCount<span class="o">=</span>5
</pre></div>
</div>
</div>
</div>
<div class="section" id="log-color">
<h3><a class="toc-backref" href="#id50">log.color</a><a class="headerlink" href="#log-color" title="Permalink to this headline">¶</a></h3>
<p>The log.color module colorizes the log when possible.&nbsp; This is actually pretty nice, but getting the most out of it takes a bit more configuration – you might want to take a look at samples.pretty_log.</p>
<p>Color logging should work fine out-of-the-box on Mac OS, Linux, and other environments with the real concept of a terminal.&nbsp; On Windows, you need a colorizer such as&nbsp;<a class="reference external" href="http://pypi.python.org/pypi/colorama/">colorama</a>.</p>
</div>
<div class="section" id="log-level">
<h3><a class="toc-backref" href="#id51">log.level</a><a class="headerlink" href="#log-level" title="Permalink to this headline">¶</a></h3>
<p>POX uses Python&#8217;s logging infrastructure.&nbsp; Different components each have their own loggers, the name of which is displayed as part of the log message.&nbsp; Loggers actually form a hierarchy – you might have a &#8220;foo&#8221; logger with a &#8220;bar&#8221; sub-logger, which together would be known as &#8220;foo.bar&#8221;.&nbsp; Additionally, each log message has a &#8220;level&#8221; associated with it, which corresponds to how important (or severe) the message is.&nbsp; The log.level component lets you configure which loggers show what level of detail.&nbsp; The log levels from most to least severe are:</p>
<table border="1" class="docutils">
<colgroup>
<col width="100%" />
</colgroup>
<tbody valign="top">
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">CRITICAL</span></code></td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">ERROR</span></code></td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">WARNING</span></code></td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">INFO</span></code></td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">DEBUG</span></code></td>
</tr>
</tbody>
</table>
<p>POX&#8217;s default level is <code class="code mono bash docutils literal"><span class="pre">INFO</span></code>.&nbsp; To set a different default (e.g., a different level for the &#8220;root&#8221; of the logger hierarchy):</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log.level --WARNING
</pre></div>
</div>
<p>If you are trying to debug a problem with OpenFlow connections, however, you may want to turn up the verbosity of OpenFlow-related logs.&nbsp; You can adjust all OpenFlow-related log messages like so:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log.level --WARNING --openflow<span class="o">=</span>DEBUG
</pre></div>
</div>
<p>If this leaves you with too many DEBUG level messages from openflow.discovery which you are not interested in, you can then turn it down specifically:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log.level --WARNING --openflow<span class="o">=</span>DEBUG --openflow.discovery<span class="o">=</span>INFO
</pre></div>
</div>
</div>
<div class="section" id="samples-pretty-log">
<h3><a class="toc-backref" href="#id52">samples.pretty_log</a><a class="headerlink" href="#samples-pretty-log" title="Permalink to this headline">¶</a></h3>
<p>This simple module uses log.color and a custom log format to provide nice, functional log output on the console.</p>
</div>
<div class="section" id="tk">
<h3><a class="toc-backref" href="#id53">tk</a><a class="headerlink" href="#tk" title="Permalink to this headline">¶</a></h3>
<p>This component is meant to assist in building Tk-based GUIs in POX, including simple dialog boxes.&nbsp; It is quite experimental.</p>
</div>
<div class="section" id="host-tracker">
<h3><a class="toc-backref" href="#id54">host_tracker</a><a class="headerlink" href="#host-tracker" title="Permalink to this headline">¶</a></h3>
<p>This component attempts to keep track of hosts in the network – where they are and how they are configured (at least their MAC/IP addresses).&nbsp; When things change, the component raises a HostEvent.</p>
<p>For an example host_tracker usage, see the misc.gephi_topo component.</p>
<p>In short, host_tracker works by examining packet-in messages, and learning MAC and IP bindings that way.&nbsp; We then periodically ARP-ping hosts to see if they&#8217;re still there.&nbsp; Note that this means it relies on packets coming to the controller, so forwarding must be done fairly reactively (as with forwarding.l2_learning), or you must install additional flow entries to bring packets to the controller.</p>
<p>You can set various timeouts (in seconds) from the commandline. Names and defaults:</p>
<table border="1" class="docutils">
<colgroup>
<col width="29%" />
<col width="16%" />
<col width="54%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Default</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>arpAware</td>
<td>60*2</td>
<td>Quiet ARP-responding entries are pinged after this</td>
</tr>
<tr class="row-odd"><td>arpSilent</td>
<td>60*20</td>
<td>This is for quiet entries not known to answer ARP</td>
</tr>
<tr class="row-even"><td>arpReply</td>
<td>4</td>
<td>Time to wait for an ARP reply before retrial</td>
</tr>
<tr class="row-odd"><td>timerInterval</td>
<td>5</td>
<td>Seconds between timer routine activations</td>
</tr>
<tr class="row-even"><td>entryMove</td>
<td>60</td>
<td>Minimum expected time to move a physical entry</td>
</tr>
</tbody>
</table>
<p>Good values for testing:</p>
<div class="highlight-none"><div class="highlight"><pre>--arpAware=15 --arpSilent=45 --arpReply=1 --entryMove=4
</pre></div>
</div>
<p>You can also specify how many ARP pings we try before deciding it failed:</p>
<div class="highlight-none"><div class="highlight"><pre>--pingLim=2
</pre></div>
</div>
</div>
<div class="section" id="datapaths-pcap-switch">
<h3><a class="toc-backref" href="#id55">datapaths.pcap_switch</a><a class="headerlink" href="#datapaths-pcap-switch" title="Permalink to this headline">¶</a></h3>
<p>This component implements the switch side of OpenFlow – making an OpenFlow switch which can connect to an OpenFlow controller (which could be the same instance of POX, a different instance of POX, or some other OpenFlow controller altogether!) and forward packets.</p>
<p>It is based on a somewhat more abstract superclass which can be used to implement the switch side of OpenFlow without forwarding packets&nbsp;– e.g., to provide a &#8220;virtual&#8221; OpenFlow switch (along the lines of FlowVisor), to provide just the OpenFlow interface on top of some other forwarding mechanism (e.g., Click), etc.&nbsp; This is also useful for prototyping OpenFlow extensions or for debugging (it&#8217;s relatively easy to modify it to simulate conditions which trigger bugs in controllers, for example).&nbsp; It is&nbsp;<em>not</em>&nbsp;meant to be a production switch – the performance is not particularly good!</p>
</div>
</div>
<div class="section" id="developing-your-own-components">
<h2><a class="toc-backref" href="#id56">Developing your own Components</a><a class="headerlink" href="#developing-your-own-components" title="Permalink to this headline">¶</a></h2>
<p>This section tries to get you started developing your own components for POX.&nbsp; In some cases, you might find that an existing component does almost what you want.&nbsp; In these cases, you might start by making a copy of that component and working from there.</p>
<div class="section" id="the-ext-directory">
<h3><a class="toc-backref" href="#id57">The &#8220;ext&#8221; directory</a><a class="headerlink" href="#the-ext-directory" title="Permalink to this headline">¶</a></h3>
<p>As discussed, POX components are really just Python modules.&nbsp; You can put your Python code wherever you like, as long as POX can find it (e.g., it&#8217;s in the&nbsp;<code class="code mono bash docutils literal"><span class="pre">PYTHONPATH</span></code>&nbsp;environment variable).&nbsp; One of the top-level directories in POX is called &#8220;ext&#8221;.&nbsp; This &#8220;ext&#8221; directory is a convenient place to build your own components, as POX automatically adds it to the Python search path (that is, looks inside it for additional modules), and it is excluded from the POX git repository (meaning you can easily check out your own repositories into the ext directory).</p>
<p>Thus, one common way to start building your own POX module is simply to copy an existing module (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding/l2_learning.py</span></code>) into the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ext</span></code>&nbsp;directory (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">ext/my_component.py</span></code>).&nbsp; You can then modify the new file and invoke POX as&nbsp;<code class="code mono bash docutils literal"><span class="pre">./pox.py</span> <span class="pre">my_component</span></code>.</p>
</div>
<div class="section" id="the-launch-function">
<h3><a class="toc-backref" href="#id58">The launch function</a><a class="headerlink" href="#the-launch-function" title="Permalink to this headline">¶</a></h3>
<p>While naming a loadable Python module on the commandline is enough to get POX to load it, a proper POX component should contain a launch function.&nbsp; In the generic sense, a launch function is a function that POX calls to tell the component to initialize itself.&nbsp; This is usually a function actually named <code class="code mono bash docutils literal"><span class="pre">launch</span></code>, though there are exceptions.&nbsp; The launch function is how commandline arguments are actually passed to the component.</p>
<div class="section" id="a-simple-example">
<h4><a class="toc-backref" href="#id59">A Simple Example</a><a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h4>
<p>The POX commandline, as mentioned above, contains the modules you want to load.&nbsp; After each module name is an optional set of parameters that go with the module.&nbsp; For example, you might have a commandline like:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py foo --bar<span class="o">=</span><span class="m">3</span> --baz --spam<span class="o">=</span>disabled
</pre></div>
</div>
<p>Since the module name is foo, we have either a directory called&nbsp;<code class="code mono bash docutils literal"><span class="pre">foo</span></code>&nbsp;somewhere that POX can find it that contains an&nbsp;<code class="code mono bash docutils literal"><span class="pre">__init__.py</span></code>, or we simply have a&nbsp;<code class="code mono bash docutils literal"><span class="pre">foo.py</span></code>&nbsp;somewhere that POX can find it (e.g., in the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ext</span></code>&nbsp;directory).&nbsp; At the bare minimum, it might look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">launch</span> <span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">baz</span> <span class="o">=</span> <span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="n">spam</span> <span class="o">=</span> <span class="bp">True</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;foo:&quot;</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">baz</span><span class="p">,</span> <span class="n">spam</span>
</pre></div>
</div>
<p>Note that&nbsp;<code class="code mono bash docutils literal"><span class="pre">bar</span></code>&nbsp;has no default value, which makes the&nbsp;<code class="code mono bash docutils literal"><span class="pre">bar</span></code>&nbsp;parameter not optional.&nbsp; Attempting to run&nbsp;<code class="code mono bash docutils literal"><span class="pre">./pox.py</span> <span class="pre">foo</span></code>&nbsp;with no arguments will complain about the lack of a value for bar.&nbsp; Notice that in the example given, bar receives the&nbsp;<em>string</em>&nbsp;value &#8220;3&#8221;.&nbsp; In fact, all arguments come to you as strings – if you want them as some other type, it is your responsibility to convert them.</p>
<p>The one exception to the &#8220;all arguments are strings&#8221; rule is illustrated with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">baz</span></code>&nbsp;argument.&nbsp; It&#8217;s specified on the commandline, but not given a value.&nbsp; So what does&nbsp;<code class="code mono bash docutils literal"><span class="pre">baz</span></code>&nbsp;actually receive in the&nbsp;<code class="code mono bash docutils literal"><span class="pre">launch</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;function?&nbsp; Simple: It receives the Python&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>&nbsp;value.&nbsp; (If it hadn&#8217;t been specified on the commandline, of course, it would have received the string &#8220;eggs&#8221;.)</p>
<p>Note that the&nbsp;<code class="code mono bash docutils literal"><span class="pre">spam</span></code>&nbsp;value defaults to&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>.&nbsp; What if we wanted to send it a false value – how would we do that?&nbsp; We could try&nbsp;<code class="code mono bash docutils literal"><span class="pre">--spam</span><span class="operator"><span class="pre">=</span></span><span class="pre">False</span></code>, but that would just get us the string &#8220;False&#8221; (which if we tested for truthiness is actually Truthy!).&nbsp; And if we just did&nbsp;<code class="code mono bash docutils literal"><span class="pre">--spam</span></code>, that would get us&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>, which isn&#8217;t what we want at all. This is one of those cases where you have to explicitly convert the value from a string to whatever type you actually want.&nbsp; To convert to an integer or a floating point value, you could simply use Python&#8217;s built-in&nbsp;<code class="code mono bash docutils literal"><span class="pre">int</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;or&nbsp;<code class="code mono bash docutils literal"><span class="pre">float</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; For booleans, you could write your own code, but you might consider&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.lib.util</span></code>&#8216;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">str_to_bool</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;function which is pretty liberal about accepting things like &#8220;on&#8221; or &#8220;true&#8221; or &#8220;enabled&#8221; as meaning&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>, and sees everything else as&nbsp;<code class="code mono bash docutils literal"><span class="pre">False</span></code>.</p>
</div>
<div class="section" id="multiple-invocation">
<h4><a class="toc-backref" href="#id60">Multiple Invocation</a><a class="headerlink" href="#multiple-invocation" title="Permalink to this headline">¶</a></h4>
<p>Now what if we were to try the following commandline?</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py foo --bar<span class="o">=</span><span class="m">1</span> foo --bar<span class="o">=</span>2
</pre></div>
</div>
<p>You might expect to see:</p>
<div class="highlight-bash"><div class="highlight"><pre>foo: <span class="m">1</span> eggs True
foo: <span class="m">2</span> eggs True
</pre></div>
</div>
<p>Instead, however, you get an exception.&nbsp; POX, by default,&nbsp;<em>only allows components to be invoked once</em>.&nbsp; However, a simple change to your&nbsp;<code class="code mono bash docutils literal"><span class="pre">launch</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;function allows multiple-invocation:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">launch</span> <span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">baz</span> <span class="o">=</span> <span class="s">&quot;eggs&quot;</span><span class="p">,</span> <span class="n">spam</span> <span class="o">=</span> <span class="bp">True</span><span class="p">,</span> <span class="n">__INSTANCE__</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;foo:&quot;</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">baz</span><span class="p">,</span> <span class="n">spam</span>
</pre></div>
</div>
<p>If you try the above commandline again, this time it will work.&nbsp; Adding the&nbsp;<code class="code mono bash docutils literal"><span class="pre">__INSTANCE__</span></code>&nbsp;parameter both flags the function as being multiply-invokable, and also gets passed some information that can be useful for some modules that are invoked multiple times.&nbsp; Specifically, it&#8217;s a tuple containing:</p>
<ul class="simple">
<li>The number of this instance (0...n-1)</li>
<li>The total number of instances for this module</li>
<li><code class="code mono bash docutils literal"><span class="pre">True</span></code>&nbsp;if this is the last instance,&nbsp;<code class="code mono bash docutils literal"><span class="pre">False</span></code>&nbsp;otherwise (just a comparison between the previous two, but it&#8217;s handy)</li>
</ul>
<p>You might, for example, only want your component to do some of its initialization once, even if your component is specified multiple times.&nbsp; You can easily do this by only doing that part of your initialization if the last value in the tuple is&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>.</p>
<p>You might also wish to examine the minimal component given in section &#8220;OpenFlow Events: Responding to Switches&#8221;.&nbsp; And, of course, check out the code for POX&#8217;s existing components.</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<p class="last">Someone should write a lot more about developing components.</p>
</div>
</div>
</div>
</div>
</div>
<div class="section" id="pox-apis">
<h1><a class="toc-backref" href="#id61">POX APIs</a><a class="headerlink" href="#pox-apis" title="Permalink to this headline">¶</a></h1>
<p>POX contains a number of APIs to help you develop network control applications.&nbsp; Here, we attempt to describe some of them. It is certainly not exhaustive so feel free to contribute.</p>
<div class="section" id="working-with-pox-the-pox-core-object">
<span id="the-pox-core-object"></span><h2><a class="toc-backref" href="#id62">Working with POX: The POX Core object</a><a class="headerlink" href="#working-with-pox-the-pox-core-object" title="Permalink to this headline">¶</a></h2>
<p>POX has an object called &#8220;core&#8221;, which serves as a central point for much of POX&#8217;s API.&nbsp; Some of the functions it provides are just convenient wrappers around other functionality, and some are unique.&nbsp; However, one of the other major purposes of the core object is to provide a rendezvous between components.&nbsp; Often, rather than using import statements to have one component import another component so that they can interact, components will instead &#8220;register&#8221; themselves on the core object, and other components will query the core object.&nbsp; A major advantage to this approach is that the dependencies between components are not hard-coded, and different components which expose the same interface can be easily interchanged.&nbsp; Thought of another way, this provides an alternative to Python&#8217;s normal module namespace, which is somewhat easier to rearrange.</p>
<p>Many modules in POX will want to access the core object.&nbsp; By convention, this is doing by importing the core object as so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pox.core</span> <span class="kn">import</span> <span class="n">core</span>
</pre></div>
</div>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<p class="last">Write more about this!</p>
</div>
<div class="section" id="registering-components">
<h3><a class="toc-backref" href="#id63">Registering Components</a><a class="headerlink" href="#registering-components" title="Permalink to this headline">¶</a></h3>
<p>As mentioned above, it can be convenient for a component to &#8220;register&#8221; an API-providing object on the core object.&nbsp; An example of this can be found in the OpenFlow implementation – the POX OpenFlow component by default registers an instance of OpenFlowNexus as&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow</span></code>, and other applications can then access a lot of the OpenFlow functionality from there.&nbsp; There are basically two ways to register a component – using&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.register</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;and using&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.registerNew</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; The latter is really just a convenience wrapper around the former.</p>
<p><code class="code mono bash docutils literal"><span class="pre">core.register</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;takes two arguments.&nbsp; The second is the object we want to register on core.&nbsp; The first is what name we want to use for it.&nbsp; Here&#8217;s a really simple component with a&nbsp;<code class="code mono bash docutils literal"><span class="pre">launch</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;function which registers the component as&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.thing</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyComponent</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">an_arg</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">an_arg</span>
    <span class="k">print</span> <span class="s">&quot;MyComponent instance registered with arg:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span>

  <span class="k">def</span> <span class="nf">foo</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;MyComponent with arg:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span>


<span class="k">def</span> <span class="nf">launch</span> <span class="p">():</span>
  <span class="n">component</span> <span class="o">=</span> <span class="n">MyComponent</span><span class="p">(</span><span class="s">&quot;spam&quot;</span><span class="p">)</span>
  <span class="n">core</span><span class="o">.</span><span class="n">register</span><span class="p">(</span><span class="s">&quot;thing&quot;</span><span class="p">,</span> <span class="n">component</span><span class="p">)</span>
  <span class="n">core</span><span class="o">.</span><span class="n">thing</span><span class="o">.</span><span class="n">foo</span><span class="p">()</span> <span class="c"># prints &quot;MyComponent with arg: spam&quot;</span>
</pre></div>
</div>
<p>In the case of, for example,&nbsp;<code class="code mono bash docutils literal"><span class="pre">launch</span></code>&nbsp;functions which can be invoked multiple times, you may still only want to register an object once.&nbsp; You could simply check if the component has already been registered (using&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.hasComponent</span><span class="operator"><span class="pre">()</span></span></code>), but this can also be done with&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.registerNew</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; While you pass a specific object to&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.register</span><span class="operator"><span class="pre">()</span></span></code>, you pass a&nbsp;<em>class</em>&nbsp;to&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.registerNew</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; If the named component has already been registered,&nbsp;<code class="code mono bash docutils literal"><span class="pre">registerNew</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;just does nothing.</p>
<p><code class="code mono bash docutils literal"><span class="pre">registerNew</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;generally takes a single parameter – the class you want it to instantiate.&nbsp; If that class&#8217;s:mono:<cite>&nbsp;__init__</cite>&nbsp;method takes arguments, you can pass them as additional parameters to&nbsp;<code class="code mono bash docutils literal"><span class="pre">registerNew</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; For example, we might change the&nbsp;<code class="code mono bash docutils literal"><span class="pre">launch</span></code>&nbsp;function above to:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">launch</span> <span class="p">():</span>
  <span class="n">core</span><span class="o">.</span><span class="n">registerNew</span><span class="p">(</span><span class="n">MyComponent</span><span class="p">,</span> <span class="s">&quot;spam&quot;</span><span class="p">)</span>
  <span class="n">core</span><span class="o">.</span><span class="n">MyComponent</span><span class="o">.</span><span class="n">foo</span><span class="p">()</span> <span class="c"># prints &quot;MyComponent with arg: spam&quot;</span>
</pre></div>
</div>
<p>Note that&nbsp;<code class="code mono bash docutils literal"><span class="pre">registerNew</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;automatically registers the given object using the object&#8217;s class name (that is, it&#8217;s now &#8220;MyComponent&#8221; instead of &#8220;thing&#8221;).&nbsp; This can be overridden by giving the object an attribute called&nbsp;<code class="code mono bash docutils literal"><span class="pre">_core_name</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyComponent</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="n">_core_name</span> <span class="o">=</span> <span class="s">&quot;thing&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">an_arg</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">arg</span> <span class="o">=</span> <span class="n">an_arg</span>
    <span class="k">print</span> <span class="s">&quot;MyComponent instance registered with arg:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span>

  <span class="k">def</span> <span class="nf">foo</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;MyComponent with arg:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">arg</span>
</pre></div>
</div>
</div>
<div class="section" id="dependency-and-event-management">
<h3><a class="toc-backref" href="#id64">Dependency and Event Management</a><a class="headerlink" href="#dependency-and-event-management" title="Permalink to this headline">¶</a></h3>
<p>When components in POX are dependent on other components (i.e., objects registered on core), it&#8217;s often (though not always) because they want to listen to events of that other component.&nbsp; POX&#8217;s contains a useful function which makes it pretty easy to both &#8220;depend&#8221; on another component in a sane way and also to set up event handlers for you:&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.listen_to_dependencies</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<p><code class="code mono bash docutils literal"><span class="pre">listen_to_dependencies</span></code>&#8216;s arguments:</p>
<div class="highlight-python"><div class="highlight"><pre>sink, components=None, attrs=True, short_attrs=False, listen_args={}
</pre></div>
</div>
<p>And here&#8217;s its docstring more or less verbatim:</p>
<blockquote>
<div><p>Look through&nbsp;<code class="code mono bash docutils literal"><span class="pre">sink</span></code>&nbsp;for handlers named like&nbsp;<code class="code mono bash docutils literal"><span class="pre">_handle_&lt;ComponentName&gt;_&lt;EventName&gt;</span></code>. Use that to build a list of components, and append any components explicitly specified by&nbsp;<code class="code mono bash docutils literal"><span class="pre">components</span></code>.</p>
<p><code class="code mono bash docutils literal"><span class="pre">listen_args</span></code>&nbsp;is a dict of <code class="code mono bash docutils literal"><span class="literal string double"><span class="pre">&quot;component_name&quot;</span></span><span class="pre">:</span><span class="operator"><span class="pre">{</span></span><span class="literal string double"><span class="pre">&quot;arg_name&quot;</span></span><span class="pre">:</span><span class="literal string double"><span class="pre">&quot;arg_value&quot;</span></span><span class="pre">,...</span><span class="operator"><span class="pre">}</span></span></code>, allowing you to specify additional arguments to&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListeners</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<p>When all the referenced components are registered, do the following:</p>
<ol class="arabic simple">
<li>Set up all the event listeners</li>
<li>Call&nbsp;<code class="code mono bash docutils literal"><span class="pre">._all_dependencies_met</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;on&nbsp;<code class="code mono bash docutils literal"><span class="pre">sink</span></code>&nbsp;if it exists</li>
<li>If&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">attrs</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">True</span></code>, set attributes on&nbsp;<code class="code mono bash docutils literal"><span class="pre">sink</span></code>&nbsp;for each component (e.g,&nbsp;<code class="code mono bash docutils literal"><span class="pre">sink._openflow_</span></code>&nbsp;would be set to&nbsp;core.openflow)</li>
</ol>
<p>For example, if&nbsp;&#8220;topology&#8221;&nbsp;is a dependency, a handler for&nbsp;topology&#8217;s <code class="code mono bash docutils literal"><span class="pre">SwitchJoin</span></code>&nbsp;event must be defined as so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_handle_topology_SwitchJoin</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">...</span><span class="p">):</span>
</pre></div>
</div>
</div></blockquote>
<p>If dependencies specified in this fashion are not resolved during POX&#8217;s startup phase, a message is logged about POX still waiting on some component (e.g., &#8220;core:Still waiting on 1 component(s)&#8221;).&nbsp; The debug-level log will contain more detailed information on this subject.&nbsp; See the FAQ entry on this subject.</p>
</div>
</div>
<div class="section" id="working-with-addresses-pox-lib-addresses">
<h2><a class="toc-backref" href="#id65">Working with Addresses: pox.lib.addresses</a><a class="headerlink" href="#working-with-addresses-pox-lib-addresses" title="Permalink to this headline">¶</a></h2>
<p>IPv4, IPv6, and Ethernet addresses in POX are represented by the IPAddr, IPAddr6, and EthAddr classes of pox.lib.addresses.&nbsp; In some cases, other address formats may work (e.g., dotted-quad IP addresses), but using the address classes should&nbsp;<em>always</em>&nbsp;work.</p>
<p>For example, when working with IP addresses:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pox.lib.addresses</span> <span class="kn">import</span> <span class="n">IPAddr</span><span class="p">,</span> <span class="n">IPAddr6</span><span class="p">,</span> <span class="n">EthAddr</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">IPAddr</span><span class="p">(</span><span class="s">&quot;192.168.1.1&quot;</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="c"># Prints &quot;192.168.1.1&quot;</span>
<span class="k">print</span> <span class="n">ip</span><span class="o">.</span><span class="n">toUnsignedN</span><span class="p">()</span> <span class="c"># Convert to network-order unsigned integer -- 16885952</span>
<span class="k">print</span> <span class="n">ip</span><span class="o">.</span><span class="n">raw</span> <span class="c"># Returns a length-four bytes object (a four byte string, more or less)</span>

<span class="n">ip</span> <span class="o">=</span> <span class="n">IPAddr</span><span class="p">(</span><span class="mi">16885952</span><span class="p">,</span><span class="n">networkOrder</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="k">print</span> <span class="nb">str</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span> <span class="c"># Also prints &quot;192.168.1.1&quot; !</span>
</pre></div>
</div>
<p>pox.lib.addresses also contains various utility functions for parsing netmasks, CIDR notation, checking whether an IP is within a specific subnet, and so on.</p>
</div>
<div class="section" id="the-event-system-pox-lib-revent">
<h2><a class="toc-backref" href="#id66">The Event System: pox.lib.revent</a><a class="headerlink" href="#the-event-system-pox-lib-revent" title="Permalink to this headline">¶</a></h2>
<p>Event Handling in POX fits into the publish/subscribe paradigm.&nbsp; Certain objects publish events (in revent lingo, this is &#8220;<em>raising</em>&#8221; an event; also sometimes called &#8220;sourcing&#8221;, &#8220;firing&#8221; or &#8220;dispatching&#8221; an event).&nbsp; One can then subscribe to specific events on these objects (in revent lingo, this is &#8220;<em>listening</em>&nbsp;<em>to</em>&#8221;; sometimes also &#8220;handling&#8221; or &#8220;sinking&#8221;); what we mean by this is that when the event occurs, we&#8217;d like a particular piece of code to be called (an &#8220;<em>event handler</em>&#8221; or sometimes an &#8220;event listener&#8221;).&nbsp; (If there&#8217;s one thing we can say about events, it&#8217;s that there&#8217;s no shortage of terminology.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">The revent library can actually do some weird stuff. POX only uses a fairly non-weird subset of its functionality, and mostly uses a pretty small subset of that subset!&nbsp; What is described in this section is the subset that POX makes use of most heavily.</p>
</div>
<p>Events in POX are all instances of subclasses of&nbsp;<code class="code mono bash docutils literal"><span class="pre">revent.Event</span></code>.&nbsp; A class that raises events (an event source) inherits from&nbsp;<code class="code mono bash docutils literal"><span class="pre">revent.EventMixin</span></code>, and declares which events it raises in a class-level variable called&nbsp;<code class="code mono bash docutils literal"><span class="pre">_eventMixin_Events</span></code>.&nbsp; Here&#8217;s an example of a class that raises two events:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">Chef</span> <span class="p">(</span><span class="n">EventMixin</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">  Class modeling a world class chef</span>

<span class="sd">  This chef only knows how to prepare spam, but we assume does it really well.</span>
<span class="sd">  &quot;&quot;&quot;</span>
  <span class="n">_eventMixin_events</span> <span class="o">=</span> <span class="nb">set</span><span class="p">([</span>
    <span class="n">SpamStarted</span><span class="p">,</span>
    <span class="n">SpamFinished</span><span class="p">,</span>
  <span class="p">])</span>
</pre></div>
</div>
<div class="section" id="handling-events">
<h3><a class="toc-backref" href="#id67">Handling Events</a><a class="headerlink" href="#handling-events" title="Permalink to this headline">¶</a></h3>
<p>So perhaps your program has an object of class&nbsp;<code class="code mono bash docutils literal"><span class="pre">Chef</span></code>&nbsp;called&nbsp;<code class="code mono bash docutils literal"><span class="pre">chef</span></code>.&nbsp; You know it raises a couple events.&nbsp; Maybe you&#8217;re interested in when your delicious spam is ready, so you&#8217;d like to listen to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">SpamFinished</span></code>&nbsp;event.</p>
<div class="section" id="event-handlers">
<h4><a class="toc-backref" href="#id68">Event Handlers</a><a class="headerlink" href="#event-handlers" title="Permalink to this headline">¶</a></h4>
<p>First off, let&#8217;s see exactly what an event listener looks like.&nbsp; For one thing: it&#8217;s a function (or a method or some other thing that&#8217;s callable).&nbsp; They almost always just take a single argument – the event object itself (though this isn&#8217;t&nbsp;<em>always</em>&nbsp;the case – an event class can change this behavior, in which case, its documentation should mention it!).&nbsp; Assuming&nbsp;<code class="code mono bash docutils literal"><span class="pre">SpamFinished</span></code>&nbsp;is a typical event, it might have a handler like:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">spam_ready</span> <span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;Spam is ready!  Smells delicious!&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="listening-to-an-event">
<h4><a class="toc-backref" href="#id69">Listening To an Event</a><a class="headerlink" href="#listening-to-an-event" title="Permalink to this headline">¶</a></h4>
<p>Now we need to actually set our&nbsp;<code class="code mono bash docutils literal"><span class="pre">spam_ready</span></code>&nbsp;function to be a listener for the&nbsp;<code class="code mono bash docutils literal"><span class="pre">SpamFinished</span></code>&nbsp;event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chef</span><span class="o">.</span><span class="n">addListener</span><span class="p">(</span><span class="n">SpamFinished</span><span class="p">,</span> <span class="n">spam_ready</span><span class="p">)</span>
</pre></div>
</div>
<p>Sometimes you may not have the event class (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">SpamFinished</span></code>) in scope.&nbsp; You can import it if you want, but you can also use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListenerByName</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method instead:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">chef</span><span class="o">.</span><span class="n">addListenerByName</span><span class="p">(</span><span class="s">&quot;SpamFinished&quot;</span><span class="p">,</span> <span class="n">spam_ready</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="automatically-setting-listeners">
<h4><a class="toc-backref" href="#id70">Automatically Setting Listeners</a><a class="headerlink" href="#automatically-setting-listeners" title="Permalink to this headline">¶</a></h4>
<p>Often, your event listener is a method on a class.&nbsp;&nbsp; Also, you often are interested in listening to multiple events from the same source object.&nbsp; revent provides a shortcut for this situation:&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListeners</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">HungryPerson</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Models a person that loves to eat spam &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">chef</span><span class="o">.</span><span class="n">addListeners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_handle_SpamStarted</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;I can&#39;t wait to eat!&quot;</span>

  <span class="k">def</span> <span class="nf">_handle_SpamFinished</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Spam is ready!  Smells delicious!&quot;</span>
</pre></div>
</div>
<p>When you call&nbsp;<code class="code mono bash docutils literal"><span class="pre">foo.addListeners</span><span class="operator"><span class="pre">(</span></span><span class="pre">bar</span><span class="operator"><span class="pre">)</span></span></code>, it looks through the events of&nbsp;<code class="code mono bash docutils literal"><span class="pre">foo</span></code>, and if it sees a method on&nbsp;<code class="code mono bash docutils literal"><span class="pre">bar</span></code>&nbsp;with a name like&nbsp;<code class="code mono bash docutils literal"><span class="pre">_handle_*EventName*</span></code>, it sets that method as a listener.</p>
<p>In some cases, you may want to have a single class listening to events from multiple event sources.&nbsp; Sometimes it&#8217;s important that you can tell the two apart.&nbsp; For this purpose, you can also use a &#8220;prefix&#8221; which gets inserted into the handler names:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">VeryHungryPerson</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="sd">&quot;&quot;&quot; Models a person that is hungry enough to need two chefs &quot;&quot;&quot;</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">master_chef</span><span class="o">.</span><span class="n">addListeners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;master&quot;</span><span class="p">)</span>
    <span class="n">backup_chef</span><span class="o">.</span><span class="n">addListeners</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prefix</span><span class="o">=</span><span class="s">&quot;secondary&quot;</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_handle_master_SpamFinished</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Spam is ready!  Smells delicious!&quot;</span>

  <span class="k">def</span> <span class="nf">_handle_secondary_SpamFinished</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="k">print</span> <span class="s">&quot;Backup spam is ready.  Smells slightly less delicious.&quot;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-your-own-event-types">
<h3><a class="toc-backref" href="#id71">Creating Your Own Event Types</a><a class="headerlink" href="#creating-your-own-event-types" title="Permalink to this headline">¶</a></h3>
<p>As noted above, events are subclasses of&nbsp;<code class="code mono bash docutils literal"><span class="pre">revent.Event</span></code>.&nbsp; So to create an event, simply create a subclass of&nbsp;<code class="code mono bash docutils literal"><span class="pre">Event</span></code>. You can add any extra attributes or methods you want.&nbsp; Continuing our example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">SpamStarted</span> <span class="p">(</span><span class="n">Event</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">brand</span> <span class="o">=</span> <span class="s">&quot;Hormel&quot;</span><span class="p">):</span>
    <span class="n">Event</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">brand</span> <span class="o">=</span> <span class="n">brand</span>

  <span class="nd">@property</span>
  <span class="k">def</span> <span class="nf">genuine</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="c"># If it&#39;s not Hormel, it&#39;s just canned spiced ham!</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">brand</span> <span class="o">==</span> <span class="s">&quot;Hormel&quot;</span>
</pre></div>
</div>
<p>Note that you should explicitly call the superclass&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">__init__</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method!&nbsp; (You can do this as above, or using the new-school&nbsp;<code class="code mono bash docutils literal"><span class="pre">super</span><span class="operator"><span class="pre">(</span></span><span class="pre">MyEvent,</span> <span class="pre">self</span><span class="operator"><span class="pre">)</span></span><span class="pre">.__init__</span><span class="operator"><span class="pre">()</span></span></code>.)</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">In newer versions of POX, calling the superclass __init__() is no longer required.</p>
</div>
<p>Voila! You can now raise new instances of your event!</p>
<p>Note that in our handlers for&nbsp;<code class="code mono bash docutils literal"><span class="pre">SpamStarted</span></code>&nbsp;events, we could have accessed the&nbsp;<code class="code mono bash docutils literal"><span class="pre">brand</span></code>&nbsp;or&nbsp;<code class="code mono bash docutils literal"><span class="pre">genuine</span></code>&nbsp;attributes on the event object that gets passed to the handler.</p>
<p><em>Note:</em>&nbsp;While revent doesn&#8217;t care what you name your event classes, if you are using POX&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">listen_to_dependencies</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;mechanism (described below), the class names must not contain an underscore (which is consistent with POX naming style, described in a later section).</p>
</div>
<div class="section" id="raising-events">
<h3><a class="toc-backref" href="#id72">Raising Events</a><a class="headerlink" href="#raising-events" title="Permalink to this headline">¶</a></h3>
<p>To raise an event so that listeners are notified, you just call&nbsp;<code class="code mono bash docutils literal"><span class="pre">raiseEvent</span></code>&nbsp;on the object that will publish the event:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># One way to do it</span>
<span class="n">chef</span><span class="o">.</span><span class="n">raiseEvent</span><span class="p">(</span><span class="n">SpamStarted</span><span class="p">(</span><span class="s">&quot;Generic&quot;</span><span class="p">))</span>

<span class="c"># Another way (slightly preferable)</span>
<span class="n">chef</span><span class="o">.</span><span class="n">raiseEvent</span><span class="p">(</span><span class="n">SpamStarted</span><span class="p">,</span> <span class="s">&quot;Generic&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(The second way is slightly preferable because if there are no listeners, it avoids ever even creating the event object.)</p>
<p>Often, a class will raise events on itself (<code class="code mono bash docutils literal"><span class="pre">self.raiseEvent</span><span class="operator"><span class="pre">(</span></span><span class="pre">...</span><span class="operator"><span class="pre">)</span></span></code>), but as you see in the example above, this isn&#8217;t&nbsp;<em>necessarily</em>&nbsp;the case.</p>
<p>There is a variant of&nbsp;<code class="code mono bash docutils literal"><span class="pre">raiseEvent</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;called&nbsp;<code class="code mono bash docutils literal"><span class="pre">raiseEventNoErrors</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; This behaves much the same as&nbsp;<code class="code mono bash docutils literal"><span class="pre">raiseEvent</span><span class="operator"><span class="pre">()</span></span></code>, but exceptions in event handlers are caught automatically.</p>
</div>
<div class="section" id="binding-to-components-events">
<h3><a class="toc-backref" href="#id73">Binding to Components&#8217; Events</a><a class="headerlink" href="#binding-to-components-events" title="Permalink to this headline">¶</a></h3>
<p>Often, event sources are &#8220;components&#8221; in that they&#8217;ve registered an object on the POX core object, and it&#8217;s that object which sources events you want to listen to.&nbsp; While you can certainly use the above methods for adding listeners, the core object also has the useful&nbsp;<code class="code mono bash docutils literal"><span class="pre">listen_to_dependencies</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method, which is documented in the section <a class="reference internal" href="#the-pox-core-object">The POX Core object</a>.</p>
</div>
<div class="section" id="advanced-topics-in-event-handling">
<h3><a class="toc-backref" href="#id74">Advanced Topics in Event Handling</a><a class="headerlink" href="#advanced-topics-in-event-handling" title="Permalink to this headline">¶</a></h3>
<div class="section" id="events-with-multiple-listeners">
<h4><a class="toc-backref" href="#id75">Events With Multiple Listeners</a><a class="headerlink" href="#events-with-multiple-listeners" title="Permalink to this headline">¶</a></h4>
<p>Above, we described the basics for handling events and demonstrated how to set listeners.&nbsp; A given source and event can have any number of listeners – you don&#8217;t have to do anything special to support that.&nbsp; Here, however, we should discuss two issues which sometimes pop up when there are multiple listeners (often together).</p>
<p>The first of these is: when there are multiple listeners, in what order are they called?&nbsp; By default, the answer is that it&#8217;s undefined.&nbsp; However, this can be overridden by specifying&nbsp;<code class="code mono bash docutils literal"><span class="pre">priority</span></code>&nbsp;in your call to&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListener</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;or&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListeners</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; Priorities should be integers; higher numbers mean call this listener sooner.&nbsp; Listeners with no priority set are equivalent to priority 0 – you can use&nbsp;<code class="code mono bash docutils literal"><span class="pre">negative</span></code>&nbsp;priorities to be called after these.</p>
<p>This brings us to the second issue: halting events.&nbsp; When an event handler is invoked, it has an opportunity to halt the event – stopping further handlers from being invoked for that method.&nbsp; This is generally used sort of like a filter: a higher priority handler sees the event first, halts the event if it handles it, or (if it doesn&#8217;t handle it) allows a later listener to handle it.&nbsp; This is the mechanism that the&nbsp;<code class="code mono bash docutils literal"><span class="pre">mac_blocker</span></code>&nbsp;component uses, for example: it halts&nbsp;<code class="code mono bash docutils literal"><span class="pre">PacketIn</span></code>&nbsp;events for blocked addresses, but allows them to pass to a forwarding component for unblocked addresses.&nbsp; To halt an event, you may either set the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.halt</span></code>&nbsp;attribute of the event object to&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>, or have the listener return&nbsp;<code class="code mono bash docutils literal"><span class="pre">EventHalt</span></code>&nbsp;(or&nbsp;<code class="code mono bash docutils literal"><span class="pre">EventHaltAndRemove</span></code>; see below).&nbsp; In the latter case, you&#8217;ll need to import&nbsp;<code class="code mono bash docutils literal"><span class="pre">EventHalt</span></code>&nbsp;from&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.lib.revent</span></code>.</p>
</div>
<div class="section" id="removing-listeners-and-one-time-events">
<h4><a class="toc-backref" href="#id76">Removing Listeners and One-Time Events</a><a class="headerlink" href="#removing-listeners-and-one-time-events" title="Permalink to this headline">¶</a></h4>
<p>In many cases, it&#8217;s sufficient to set up a listener and forget about it forever.&nbsp; However, it is sometimes the case that you want to stop listening to an event.&nbsp; There are a few different ways to do this.</p>
<p>The first way is very similar to halting an event as described above: the handler just returns&nbsp;<code class="code mono bash docutils literal"><span class="pre">EventRemove</span></code>&nbsp;(or&nbsp;<code class="code mono bash docutils literal"><span class="pre">EventHaltAndRemove</span></code>).&nbsp; Of course, this can only be done from inside the handler at the time an event as actually being handled.&nbsp; If you&#8217;d like to remove the handler from outside the handler, you can use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">removeListener</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method.&nbsp; The easiest way to use this is simply to pass it an &#8220;event ID&#8221;.&nbsp; Although not discussed earlier, this is the return value of&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListener</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; Thus, you can easily save the return value from&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListener</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;and pass it to&nbsp;<code class="code mono bash docutils literal"><span class="pre">removeListener</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;later to unhook the handler.&nbsp; Things work pretty much as you&#8217;d hope for&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListeners</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;as well – it returns a sequence of event IDs, which can be simply passed to&nbsp;<code class="code mono bash docutils literal"><span class="pre">removeListeners</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<p>revent contains a special shortcut for a fairly common case: when you care about an event only the first time it fires.&nbsp; Simply pass&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">once</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">True</span></code>&nbsp;into&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListener</span><span class="operator"><span class="pre">()</span></span></code>, and the listener is automatically removed after the first time it&#8217;s fired.</p>
</div>
<div class="section" id="weak-event-handlers">
<h4><a class="toc-backref" href="#id77">Weak Event Handlers</a><a class="headerlink" href="#weak-event-handlers" title="Permalink to this headline">¶</a></h4>
<p>By default, when a listening to an event source, this creates a reference to the source.&nbsp; Generally, this means that the lifetime of the event source is now bound to the lifetime of the event handler.&nbsp; Often this is just fine (and even desirable).&nbsp; However, there are exceptions.&nbsp; To provide for these exceptions, one can pass&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">weak</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">True</span></code>&nbsp;into&nbsp;<code class="code mono bash docutils literal"><span class="pre">addListener</span><span class="operator"><span class="pre">()</span></span></code>.&nbsp; This creates a weak reference: if the source object has no other references, the listener is removed automatically.</p>
</div>
</div>
</div>
<div class="section" id="working-with-packets-pox-lib-packet">
<h2><a class="toc-backref" href="#id78">Working with packets: pox.lib.packet</a><a class="headerlink" href="#working-with-packets-pox-lib-packet" title="Permalink to this headline">¶</a></h2>
<p>Lots of applications in POX interact with packets (e.g., you might want to construct packets and send them out of a switch, or you may receive them from a switch via an&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code>&nbsp;OpenFlow message).&nbsp; To facilitate this, POX has a library for parsing and constructing packets.&nbsp; The library has support for a number of different packet types.</p>
<p>Most packets have some sort of a header and some sort of a payload.&nbsp; A payload is often another type of packet.&nbsp; For example, in POX one generally works with&nbsp;<code class="code mono bash docutils literal"><span class="pre">ethernet</span></code>&nbsp;packets which often contain&nbsp;<code class="code mono bash docutils literal"><span class="pre">ipv4</span></code>&nbsp;packets (which often contain&nbsp;<code class="code mono bash docutils literal"><span class="pre">tcp</span></code>&nbsp;packets...).&nbsp; Some of the packet types supported by POX are:</p>
<ul class="simple">
<li>ethernet</li>
<li>ARP</li>
<li>IPv4</li>
<li>ICMP</li>
<li>TCP</li>
<li>UDP</li>
<li>DHCP</li>
<li>DNS</li>
<li>LLDP</li>
<li>VLAN</li>
</ul>
<p>All packet classes in POX are found in pox/lib/packet.&nbsp; By convention, you import the POX packet library as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pox.lib.packet</span> <span class="kn">as</span> <span class="nn">pkt</span>
</pre></div>
</div>
<p>One can navigate the encapsulated packets in two ways: by using the&nbsp;<code class="code mono bash docutils literal"><span class="pre">payload</span></code>&nbsp;attribute of the packet object, or by using its&nbsp;<code class="code mono bash docutils literal"><span class="pre">find</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method. For example, here is how you could parse an ICMP message using the&nbsp;<code class="code mono bash docutils literal"><span class="pre">payload</span></code>&nbsp;attribute:</p>
<div class="highlight-python"><div class="highlight"><pre>def parse_icmp (eth_packet):
  if eth_packet.type == pkt.IP_TYPE:
    ip_packet = eth_packet.payload
    if ip_packet.protocol == pkt.ICMP_PROTOCOL:
      icmp_packet = ip_packet.payload
...
</pre></div>
</div>
<p>This is probably not the best way to navigate a packet, but it illustrates the structure of packet headers in POX. At each level of encapsulation the packet header values can be obtained. For example, the source ip address of the ip packet above and ICMP sequence number can be obtained as shown:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="o">...</span>
<span class="n">src_ip</span> <span class="o">=</span> <span class="n">ip_packet</span><span class="o">.</span><span class="n">srcip</span>
<span class="n">icmp_code</span> <span class="o">=</span> <span class="n">icmp_packet</span><span class="o">.</span><span class="n">code</span>
</pre></div>
</div>
<p>And similarly for other packet headers. Refer to the specific packet code for other headers.</p>
<p>A packet object&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">find</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method can be used to find a specific encapsulated packet by the desired type name (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="literal string double"><span class="pre">&quot;icmp&quot;</span></span></code>) or its class (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">pkt.ICMP</span></code>).&nbsp; If the packet object does not encapsulate a packet of the requested type,&nbsp;<code class="code mono bash docutils literal"><span class="pre">find</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;returns None.&nbsp; For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">handle_IP_packet</span> <span class="p">(</span><span class="n">packet</span><span class="p">):</span>
  <span class="n">ip</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;ipv4&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="n">ip</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span>
    <span class="c"># This packet isn&#39;t IP!</span>
    <span class="k">return</span>
  <span class="k">print</span> <span class="s">&quot;Source IP:&quot;</span><span class="p">,</span> <span class="n">ip</span><span class="o">.</span><span class="n">srcip</span>
</pre></div>
</div>
<p>The following sections detail&nbsp;<em>some</em>&nbsp;of the useful attributes/methods/constants for&nbsp;<em>some</em>&nbsp;of the supported packet types.</p>
<div class="section" id="ethernet-ethernet">
<h3><a class="toc-backref" href="#id79">Ethernet (ethernet)</a><a class="headerlink" href="#ethernet-ethernet" title="Permalink to this headline">¶</a></h3>
<p>Attributes:</p>
<ul class="simple">
<li>dst (EthAddr)</li>
<li>src (EthAddr)</li>
<li>type (int) - The ethertype or ethernet length field.&nbsp; This will be 0x8100 for frames with VLAN tags</li>
<li>effective_ethertype (int) - The ethertype or ethernet length field.&nbsp; For frames with VLAN tags, this will be the type referenced in the VLAN header.</li>
</ul>
<p>Constants:</p>
<ul class="simple">
<li>IP_TYPE, ARP_TYPE, RARP_TYPE, VLAN_TYPE, LLDP_TYPE, JUMBO_TYPE, QINQ_TYPE - A variety of ethertypes</li>
</ul>
<p>Pretty-print ethertype as string:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">pkt</span><span class="o">.</span><span class="n">ETHERNET</span><span class="o">.</span><span class="n">ethernet</span><span class="o">.</span><span class="n">getNameForType</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">type</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ip-version-4-ipv4">
<h3><a class="toc-backref" href="#id80">IP version 4 (ipv4)</a><a class="headerlink" href="#ip-version-4-ipv4" title="Permalink to this headline">¶</a></h3>
<p>Attributes:</p>
<ul class="simple">
<li>srcip (IPAddr)</li>
<li>dstip (IPAddr)</li>
<li>tos (int) - 8 bits of Type Of Service / DSCP+ECN</li>
<li>id (int) - identification field</li>
<li>flags (int)</li>
<li>frag (int) - fragment offset</li>
<li>ttl (int)</li>
<li>protocol (int) - IP protocol number of payload</li>
<li>csum (int) - checksum</li>
</ul>
<p>Constants:</p>
<ul class="simple">
<li>ICMP_PROTOCOL, TCP_PROTOCOL, UDP_PROTOCOL - Various IP protocol numbers</li>
<li>DF_FLAG - Don&#8217;t Fragment flag bit</li>
<li>MF_FLAG - More Fragments flag bit</li>
</ul>
</div>
<div class="section" id="tcp-tcp">
<h3><a class="toc-backref" href="#id81">TCP (tcp)</a><a class="headerlink" href="#tcp-tcp" title="Permalink to this headline">¶</a></h3>
<p>Attributes:</p>
<ul class="simple">
<li>srcport (int) - Source TCP port number</li>
<li>dstport (int) - Destination TCP port number</li>
<li>seq (int) - Sequence number</li>
<li>ack (int) - ACK number</li>
<li>off (int) - offset</li>
<li>flags (int) - Flags as bitfield (easier to use all-uppercase flag attributes)</li>
<li>csum (int) - Checksum</li>
<li>options (list of tcp_opt objects)</li>
<li>win (int) - window size</li>
<li>urg (int) - urgent pointer</li>
<li>FIN (bool) - True when FIN flag set</li>
<li>SYN (bool) - True when SYN flag set</li>
<li>RST (bool) - True when RST flag set</li>
<li>PSH (bool) - True when PSH flag set</li>
<li>ACK (bool) - True when ACK flag set</li>
<li>URG (bool) - True when URG flag set</li>
<li>ECN (bool) - True when ECN flag set</li>
<li>CWR (bool) - True when CWR flag set</li>
</ul>
<p>Constants:</p>
<ul class="simple">
<li>FIN_flag, SYN_flag, etc. - Bits corresponding to flags</li>
</ul>
<div class="section" id="tcp-opt-class">
<h4><a class="toc-backref" href="#id82">tcp_opt class</a><a class="headerlink" href="#tcp-opt-class" title="Permalink to this headline">¶</a></h4>
<p>Attributes:</p>
<ul class="simple">
<li>type (int) - TCP Option ID (probably corresponding constant below)</li>
<li>val (varies) - Option value</li>
</ul>
<p>Constants:</p>
<ul class="simple">
<li>EOL, NOP, MSS, WSOPT, SACKPERM, SACK, TSOPT - Option type IDs</li>
</ul>
</div>
</div>
<div class="section" id="example-arp-messages">
<h3><a class="toc-backref" href="#id83">Example: ARP messages</a><a class="headerlink" href="#example-arp-messages" title="Permalink to this headline">¶</a></h3>
<p>You might want the controller to proxy the ARP replies rather than flood them all over the network depending on whether you know the MAC address of the machine the ARP request is looking for. To handle ARP packets in you should have an event listener set up to receive packet ins as shown:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_handle_PacketIn</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
  <span class="n">packet</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">parsed</span>
  <span class="k">if</span> <span class="n">packet</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">packet</span><span class="o">.</span><span class="n">ARP_TYPE</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">packet</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">opcode</span> <span class="o">==</span> <span class="n">arp</span><span class="o">.</span><span class="n">REQUEST</span><span class="p">:</span>
      <span class="n">arp_reply</span> <span class="o">=</span> <span class="n">arp</span><span class="p">()</span>
      <span class="n">arp_reply</span><span class="o">.</span><span class="n">hwsrc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">requested</span> <span class="n">mac</span> <span class="n">address</span><span class="o">&gt;</span>
      <span class="n">arp_reply</span><span class="o">.</span><span class="n">hwdst</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">src</span>
      <span class="n">arp_reply</span><span class="o">.</span><span class="n">opcode</span> <span class="o">=</span> <span class="n">arp</span><span class="o">.</span><span class="n">REPLY</span>
      <span class="n">arp_reply</span><span class="o">.</span><span class="n">protosrc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">IP</span> <span class="n">of</span> <span class="n">requested</span> <span class="n">mac</span><span class="o">-</span><span class="n">associated</span> <span class="n">machine</span><span class="o">&gt;</span>
      <span class="n">arp_reply</span><span class="o">.</span><span class="n">protodst</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">protosrc</span>
      <span class="n">ether</span> <span class="o">=</span> <span class="n">ethernet</span><span class="p">()</span>
      <span class="n">ether</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="n">ethernet</span><span class="o">.</span><span class="n">ARP_TYPE</span>
      <span class="n">ether</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">packet</span><span class="o">.</span><span class="n">src</span>
      <span class="n">ether</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">requested</span> <span class="n">mac</span> <span class="n">address</span><span class="o">&gt;</span>
      <span class="n">ether</span><span class="o">.</span><span class="n">payload</span> <span class="o">=</span> <span class="n">arp_reply</span>
      <span class="c">#send this packet to the switch</span>
      <span class="c">#see section below on this topic</span>
    <span class="k">elif</span> <span class="n">packet</span><span class="o">.</span><span class="n">payload</span><span class="o">.</span><span class="n">opcode</span> <span class="o">==</span> <span class="n">arp</span><span class="o">.</span><span class="n">REPLY</span><span class="p">:</span>
      <span class="k">print</span> <span class="s">&quot;It&#39;s a reply; do something cool&quot;</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="k">print</span> <span class="s">&quot;Some other ARP opcode, probably do something smart here&quot;</span>
</pre></div>
</div>
<p>See the&nbsp;<code class="code mono bash docutils literal"><span class="pre">l3_learning</span></code>&nbsp;component for a more complete example of using the controller to parse ARP requests and generate replies.</p>
</div>
<div class="section" id="constructing-packets-from-scratch-and-reading-packets-from-the-wire">
<h3><a class="toc-backref" href="#id84">Constructing Packets from Scratch and Reading Packets from the Wire</a><a class="headerlink" href="#constructing-packets-from-scratch-and-reading-packets-from-the-wire" title="Permalink to this headline">¶</a></h3>
<p>The above examples have mostly focused on working with the packet objects.&nbsp; While those are convenient for working with in Python, they&#8217;re not the form packets actually take when they&#8217;re being sent or received over a network – at that level, the packets are all really just a sequence of bytes.</p>
<p>To go from a packet object (which possibly contains other packet objects as its payload) to its on-the-wire format (a series of bytes), you call the object&#8217;s .pack() method.&nbsp; To do the inverse, you call the appropriate packet type&#8217;s .unpack()&nbsp;<em>class method</em>. If you&#8217;re working with PacketIn objects, this is done for you automatically – the event&#8217;s .parsed property will contain the packet objects.&nbsp; However, there are cases where you&#8217;ll want to do it yourself.&nbsp; For example, if you are reading from the file descriptor side of a TUN interface, you may want to parse out the IP packets you read.&nbsp; In this case, you&#8217;d use pkt.ipv4.unpack(&lt;your data&gt;).</p>
<p>You also may need to manually unpack things when you&#8217;ve got cases the packet library doesn&#8217;t understand.&nbsp; For example, the packet library understands that an IPv4 packet might contain ICMP or TCP (and a few others).&nbsp; As of this writing, it does&nbsp;<em>not</em>&nbsp;understand either flavor of IP-in-IP encapsulation (protocol 4 or protocol 94).&nbsp; When the packet library doesn&#8217;t understand how to parse a packet&#8217;s payload, it simply includes it as raw bytes.&nbsp; Thus, IP-in-IP comes out of the packet library as something like ethernet-&gt;ipv4-&gt;raw_data.&nbsp; If you want work with the encapsulated IPv4 packet, you&#8217;ll have to unpack it yourself: inner_ip = pkt.ipv4.unpack(outer_eth.find(&#8216;ipv4&#8217;).payload).</p>
</div>
</div>
<div class="section" id="threads-tasks-and-timers-pox-lib-recoco">
<h2><a class="toc-backref" href="#id85">Threads, Tasks, and Timers: pox.lib.recoco</a><a class="headerlink" href="#threads-tasks-and-timers-pox-lib-recoco" title="Permalink to this headline">¶</a></h2>
<p>This is a big subject, and a lot could be said.&nbsp; Feel free to add something!</p>
<p>POX&#8217;s recoco library is for implementing simple cooperative tasks.&nbsp; Perhaps the major benefit of cooperative tasks is that you generally don&#8217;t need to worry much about synchronization between them.</p>
<p>There&#8217;s a small amount of example material in&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox/lib/recoco/examples.py</span></code></p>
<p>The first rule of recoco tasks: don&#8217;t block.&nbsp; Stalling a recoco task (that is, stalling the scheduler&#8217;s thread) will keep other tasks from running.&nbsp; Some blocking operations (sleep, select, etc.) have recoco-friendly equivalents – see recoco&#8217;s source or reference for details.</p>
<div class="section" id="using-normal-threads">
<h3><a class="toc-backref" href="#id86">Using Normal Threads</a><a class="headerlink" href="#using-normal-threads" title="Permalink to this headline">¶</a></h3>
<p>You can use recoco, but you don&#8217;t have to &#8211; you can use normal threading if you want.&nbsp; Indeed, there are several parts of POX which use normal threads (the web server, for example).&nbsp; While you don&#8217;t need to worry much about synchronization between recoco tasks, you do need to think about synchronization between recoco task and normal threads.&nbsp; Often, it&#8217;s reasonable to start up a worker thread, and when it&#8217;s done, have it fire a method using core.callLater() or have it schedule a recoco Task (using the threadsafe non-fast scheduling function).</p>
</div>
<div class="section" id="executing-code-in-the-future-using-a-timer">
<h3><a class="toc-backref" href="#id87">Executing Code in the Future using a Timer</a><a class="headerlink" href="#executing-code-in-the-future-using-a-timer" title="Permalink to this headline">¶</a></h3>
<p>It&#8217;s often useful to have a piece of code execute from time to time.&nbsp; For example, you may want to examine the bytes transferred over a specific flow every 10 seconds.&nbsp; It&#8217;s also a fairly common case where you know you want something to happen at some specific time in the future; for example, if you send a barrier, you might want to disconnect the switch if 5 seconds go by without the barrier reply showing up.&nbsp; This is the type of task that the pox.lib.recoco.Timer class is designed to handle – executing a piece of code at a single or recurring time in the future.</p>
<p><em>Note:</em>&nbsp;The POX core object&#8217;s&nbsp;<em>callDelayed()</em>&nbsp;is often an easier way to set a simple timer.&nbsp; (See example below.)</p>
<div class="section" id="timer-constructor-arguments">
<h4><a class="toc-backref" href="#id88">Timer Constructor Arguments</a><a class="headerlink" href="#timer-constructor-arguments" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="8%" />
<col width="87%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">arg</th>
<th class="head">type - default</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>_timeToWake_</td>
<td>number (seconds)</td>
<td>Amount of time to wait before calling callback (absoluteTime = False), or specific time to call callback (absoluteTime = True)</td>
</tr>
<tr class="row-odd"><td>_callback_</td>
<td>callable (e.g., function)</td>
<td>A function to call when the timer elapses</td>
</tr>
<tr class="row-even"><td>_absoluteTime_</td>
<td>boolean - False</td>
<td>When False, timeToWake is a number of seconds in the future. When True, timeToWake is a specific time in the future (e.g., a number of seconds since the epoch, as reported with time.time()). Note that absoluteTime=True can not be used with recurring timers.</td>
</tr>
<tr class="row-odd"><td>_recurring_</td>
<td>boolean - False</td>
<td>When False, the timer online fires once - timeToWake seconds from when it&#8217;s started. When True, the timer fires every timeToWake seconds.</td>
</tr>
<tr class="row-even"><td>_args_, _kw_</td>
<td>sequence, dict - empty</td>
<td>These are arguments and keyword arguments passed to _callback_.</td>
</tr>
<tr class="row-odd"><td>_scheduler_</td>
<td>Scheduler - None</td>
<td>The scheduler this timer is executed with. None means to use the default (you want this).</td>
</tr>
<tr class="row-even"><td>_started_</td>
<td>boolean - True</td>
<td>If True, the timer is started automatically.</td>
</tr>
<tr class="row-odd"><td>_selfStoppable_</td>
<td>boolean - True</td>
<td>If True, the callback of a recurring timer can return False to cancel the timer.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="timer-methods">
<h4><a class="toc-backref" href="#id89">Timer Methods</a><a class="headerlink" href="#timer-methods" title="Permalink to this headline">¶</a></h4>
<table border="1" class="docutils">
<colgroup>
<col width="10%" />
<col width="15%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">arguments</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>cancel</td>
<td>None</td>
<td>Stop the timer (do not call the callback again)</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="example-one-shot-timer">
<h4><a class="toc-backref" href="#id90">Example&nbsp;- One-Shot timer</a><a class="headerlink" href="#example-one-shot-timer" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pox.lib.recoco</span> <span class="kn">import</span> <span class="n">Timer</span>

<span class="k">def</span> <span class="nf">handle_timer_elapse</span> <span class="p">(</span><span class="n">message</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;I was told to tell you:&quot;</span><span class="p">,</span> <span class="n">message</span>

<span class="n">Timer</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">handle_timer_elapse</span><span class="p">,</span> <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Hello&quot;</span><span class="p">])</span>

<span class="c"># Prints out &quot;I was told to tell you: Hello&quot; in 10 seconds</span>

<span class="c"># Alternate way for simple timers:</span>
<span class="kn">from</span> <span class="nn">pox.core</span> <span class="kn">import</span> <span class="n">core</span> <span class="c"># Many components already do this</span>
<span class="n">core</span><span class="o">.</span><span class="n">callDelayed</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">handler_timer_elapse</span><span class="p">,</span> <span class="s">&quot;Hello&quot;</span><span class="p">)</span> <span class="c"># You can just tack on args and kwargs.</span>
</pre></div>
</div>
</div>
<div class="section" id="example-recurring-timer">
<h4><a class="toc-backref" href="#id91">Example&nbsp;- Recurring timer</a><a class="headerlink" href="#example-recurring-timer" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre># Simulate a long road trip

from pox.lib.recoco import Timer

we_are_there = False

def are_we_there_yet ():
  if we_are_there: return False # Cancels timer (see selfStoppable)
  print &quot;Are we there yet?&quot;

Timer(30, are_we_there_yet, recurring = True)
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="working-with-sockets-ioworker">
<h2><a class="toc-backref" href="#id92">Working with sockets: ioworker</a><a class="headerlink" href="#working-with-sockets-ioworker" title="Permalink to this headline">¶</a></h2>
<p>pox.lib.ioworker contains a high level API for working with asynchronous sockets in POX.&nbsp; Sends are fire-and-forget, received data is buffered and a callback fired when there&#8217;s some available, etc.</p>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<p class="last">Documentation and samples</p>
</div>
</div>
<div class="section" id="working-with-pcap-libpcap-pxpcap">
<h2><a class="toc-backref" href="#id93">Working with pcap/libpcap: pxpcap</a><a class="headerlink" href="#working-with-pcap-libpcap-pxpcap" title="Permalink to this headline">¶</a></h2>
<p>pxpcap is POX&#8217;s pcap library.&nbsp; It was written because we couldn&#8217;t find an existing pcap library for Python which provided all of the following:</p>
<ol class="arabic simple">
<li>was maintained</li>
<li>supported Windows, Linux, and MacOS</li>
<li>supported both capture and injection</li>
<li>could capture at a reasonable rate</li>
</ol>
<p>Along with meeting these goals, pxpcap exposes other pcap and pcap-related functionality, such as enumerating network interfaces, and reading/writing tcpdump/pcap trace files.</p>
<p>The pxpcap directory also contains a couple small utility POX components which can serve as examples if you want to write your own code using pxpcap.&nbsp; The most obvious of these could be called &#8220;pxshark&#8221; – it captures traffic from an interface, dissects it using the POX packet library, and dumps the results.&nbsp; You can run this like so:</p>
<div class="highlight-none"><div class="highlight"><pre>./pox.py pox.lib.pxpcap --interface=eth0
</pre></div>
</div>
<div class="section" id="building-pxpcap">
<h3><a class="toc-backref" href="#id94">Building pxpcap</a><a class="headerlink" href="#building-pxpcap" title="Permalink to this headline">¶</a></h3>
<p>pxpcap is written partially in C++ and partially in Python.&nbsp; If you wish to use all of its features, you must build the C++ portion (the pure Python parts should work regardless).&nbsp; Its directory has scripts to make it on Windows, Mac OS, and Linux.&nbsp; It requires that you have a C++ compiler and libpcap/winpcap development files installed.&nbsp; Beyond that, building it should be fairly straightforward; something like the following:</p>
<div class="highlight-none"><div class="highlight"><pre>cd pox/lib/pxpcap/pxpcap_c
./build_linux # or ./build_mac or build_win.bat
</pre></div>
</div>
<p>See the following subsections for tips on specific troublesome configurations.</p>
<p>Note that the setuptools script was originally intended to allow pxpcap to be used either with out without the rest of POX.&nbsp; However, keeping it usable without POX has not been a high priority.&nbsp; Feel free to pitch in here!</p>
<p>Also note that the C portion is required for the POX datapath (software switch) to forward traffic on real interfaces.</p>
</div>
<div class="section" id="using-pxpcap-with-older-versions-of-python">
<h3><a class="toc-backref" href="#id95">Using pxpcap with older versions of Python</a><a class="headerlink" href="#using-pxpcap-with-older-versions-of-python" title="Permalink to this headline">¶</a></h3>
<p>pxpcap has a mode where it uses Python&#8217;s bytearray C API, which is relatively new (meaning not particularly new at all).&nbsp; If you&#8217;re running on recent Python 2.7 (the recommended configuration for POX), this will certainly not be a problem.&nbsp; If you are trying to use pxpcap with some old Python, you can disable the bytearray mode by passing&nbsp;-DNO_BYTEARRAYS to the compiler.&nbsp; This isn&#8217;t currently very well supported and you&#8217;ll probably need to tweak the setuptools script yourself.</p>
</div>
<div class="section" id="using-pxpcap-with-pypy">
<h3><a class="toc-backref" href="#id96">Using pxpcap with PyPy</a><a class="headerlink" href="#using-pxpcap-with-pypy" title="Permalink to this headline">¶</a></h3>
<p>If you&#8217;re using the normal CPython interpreter, you can safely ignore this section.&nbsp; If you&#8217;re using PyPy, the good news is that pxpcap can be made to work (at least for PyPy 1.9+).&nbsp; The bad news is that the build scripts are questionable.&nbsp; On Mac OS, the setuptools script seems to build it okay, though the simple install script doesn&#8217;t work right since PyPy names its extensions differently, and you&#8217;ll have to copy the .so to the pxpcap directory yourself (or you could try installing it globally).&nbsp; On Linux, my (Murphy&#8217;s) experience is that the setuptools script doesn&#8217;t even work right.&nbsp; I just built it by hand (adjust the output name in the following if you&#8217;re not using PyPy 2.1):</p>
<div class="highlight-none"><div class="highlight"><pre>g++ pxpcap.cpp -I /home/pox/pypy/include/ -DNO_BYTEARRAYS -DHAVE_PCAP_GET_SELECTABLE_FD -lpcap -shared -fPIC -o ../pxpcap.pypy-21.so
</pre></div>
</div>
<p>The other caveat is that pxpcap&#8217;s bytearray mode (where captured data is put into a bytearray instead of a bytes object) is not supported in PyPy, and you get bytes instead of a bytearray no matter what you do.</p>
</div>
</div>
</div>
<div class="section" id="openflow-in-pox">
<h1><a class="toc-backref" href="#id97">OpenFlow in POX</a><a class="headerlink" href="#openflow-in-pox" title="Permalink to this headline">¶</a></h1>
<p>One of the primary purposes for using POX is for developing OpenFlow control applications&nbsp;– that is, where POX acts as a controller for an OpenFlow switch (or, in more proper terminology, an OpenFlow&nbsp;<em>datapath</em>).  In this chapter, we describe some of the POX features and interfaces that facilitate this, beginning with a quick overview of some of the major pieces.</p>
<p>Because POX is so often used with OpenFlow, there is a special demand-loading mechanism, which will usually detect when you&#8217;re trying to use OpenFlow, and load up OpenFlow-related components with default values.  See the &#8220;About the OpenFlow Component&#8217;s Initialization&#8221; subsection for more information on this.  If the demand loading doesn&#8217;t detect that you&#8217;re trying to use it, you can either tweak your component to make it clear that you are (simply accessing core.openflow in your launch function should do it), or simply specify the &#8220;<code class="code mono bash docutils literal"><span class="pre">openflow</span></code>&#8221; component at the start of the commandline.</p>
<p>A main part of the POX OpenFlow API is the OpenFlow &#8220;nexus&#8221; object.  Usually, there is a single such object which is registered as&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow</span></code>&nbsp;as part of the demand-loading process mentioned above.  Some usage of this nexus object is explored in following subsections, including one subsection dedicated entirely to it.</p>
<p>The POX component that actually communicates with OpenFlow switches is&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.of_01</span></code>&nbsp;(the 01 refers to the fact that this component speaks OpenFlow wire protocol 0x01). Again, the demand-loading feature will usually cause this component to be initialized with default values (listening on port 6633).  However, you can invoke it automatically instead to either change the options, or because you want to run it multiple times (e.g., to listen on plain TCP and SSL or on multiple ports).  See the documentation for the&nbsp;<code class="code mono bash docutils literal"><span class="pre">of_01</span></code>&nbsp;component for further details.</p>
<div class="section" id="dpids-in-pox">
<h2><a class="toc-backref" href="#id98">DPIDs in POX</a><a class="headerlink" href="#dpids-in-pox" title="Permalink to this headline">¶</a></h2>
<p>Before we truly begin discussing the details of communicating with OpenFlow datapath, we should discuss the subject of DPIDs.  The OpenFlow specification specifies that datapaths (switches) each have a unique datapath ID or DPID, which is a 64 bit value, and is communicated from the switch to the controller during handshaking by way of the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_switch_features</span></code>&nbsp;message.  It puts forth that 48 of those bits are intended to be an Ethernet address and that 16 are &#8220;implementer-defined&#8221; (in practice, they are very often just zero).  Since an OpenFlow switch is itself (mostly) &#8220;transparent&#8221; to the network, it&#8217;s not entirely clear exactly&nbsp;<em>which</em>&nbsp;Ethernet address is supposed to be in those bits, but we can assume it&#8217;s something switch-specific.  Since OpenFlow Connection objects (discussed below) are tied to a specific switch, the DPID is available on the Connection object using the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.dpid</span></code>&nbsp;attribute.  Additionally, the corresponding Ethernet address is available using the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.eth_addr</span></code>&nbsp;attribute.</p>
<p>POX internally treats the DPIDs as Python integer types.  This isn&#8217;t that nice for humans, though.  If you print them out they&#8217;re just a decimal number which may not be easy to look at or easy to correlated with the associated Ethernet address.  Therefore, POX defines a specific way of formatting DPIDs, which is implemented in&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.lib.util.dpid_to_str</span><span class="operator"><span class="pre">()</span></span></code>.  When passed a DPID in the common case that the 16 &#8220;implementer-defined&#8221; bits are zeros, the result is a string which looks very much like an Ethernet address except that instead of colons separating the bytes (as POX always does for Ethernet addresses), dashes are used instead.  If the implementer-defined bits are nonzero, they are treated as a decimal number and appended following a bar, e.g., &#8220;00-00-00-00-00-05|123&#8221;.  The second parameter of&nbsp;<code class="code mono bash docutils literal"><span class="pre">dpid_to_str</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;allows you to force that the long format always be used.  That is, it defaults to&nbsp;<code class="code mono bash docutils literal"><span class="pre">False</span></code>, but if you pass in&nbsp;<code class="code mono bash docutils literal"><span class="pre">True</span></code>, the 16 extra bits are shown even when they&#8217;re zero.  There is also a corresponding&nbsp;<code class="code mono bash docutils literal"><span class="pre">str_to_dpid</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;function which attempts to parse strings as DPIDs (returning an integer/long).</p>
<div class="section" id="dpids-in-mininet">
<h3><a class="toc-backref" href="#id99">DPIDs in Mininet</a><a class="headerlink" href="#dpids-in-mininet" title="Permalink to this headline">¶</a></h3>
<p>Although this isn&#8217;t specific to POX, it is worth saying a few words about DPIDs in Mininet.  By default, Mininet assigns DPIDs to switches in a straighforward way.  If a switch is &#8220;s3&#8221;, then its DPID will be 3.  This can be problematic when used with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">--mac</span></code>&nbsp;option.  The&nbsp;<code class="code mono bash docutils literal"><span class="pre">--mac</span></code>&nbsp;option assigns MAC addresses to hosts in much the same way – if a host is &#8220;h3&#8221; then its MAC will be 00:00:00:00:00:03.  While this can be helpful, it also means that the portion of the DPID which the OpenFlow specification says is intended to be a MAC address is the same as the MAC address of one of the hosts.  This can be a source of confusion and problems since MACs are generally assumed to be unique.</p>
<p>Some POX components make a particular OpenFlow switch act like something besides a transparent L2 switch.  For example,&nbsp;<code class="code mono bash docutils literal"><span class="pre">arp_responder</span></code>&nbsp;makes an OpenFlow switch act a tiny bit more like a router.  Routers have Ethernet addresses, so... which Ethernet address should&nbsp;<code class="code mono bash docutils literal"><span class="pre">arp_responder</span></code>&nbsp;use?&nbsp; There are lots of answers here, but one reasonable one is to use the one that&#8217;s embedded in the DPID (and available on the&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&#8216;s,&nbsp;<code class="code mono bash docutils literal"><span class="pre">.eth_addr</span></code>&nbsp;attribute).  As you can see, this has the potential to cause address conflicts when using Mininet&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">--mac</span></code>&nbsp;option.  There are ways around this type of situation, but it&#8217;s helpful to be aware of the issue.</p>
</div>
</div>
<div class="section" id="communicating-with-datapaths-switches">
<h2><a class="toc-backref" href="#id100">Communicating with Datapaths (Switches)</a><a class="headerlink" href="#communicating-with-datapaths-switches" title="Permalink to this headline">¶</a></h2>
<p>Switches connect to POX, and then you obviously want to communicate with those switches from POX.  This communication might go either from the controller to a switch, or from a switch to the controller.  When communication is from the controller to the switch, this is performed by controller code which sends an OpenFlow message to a particular switch (more on this in a moment).  When messages are coming from the switch, they show up in POX as&nbsp;<em>events</em>&nbsp;for which you can write event handlers – generally there&#8217;s an event type corresponding to each message type that a switch might send.  While the messages themselves are described in the OpenFlow specification and the events are described in following subsections, this subsection focuses simply on how exactly you send those messages and how you set up those event handlers.</p>
<p>There are essentially two ways you can communicate with a datapath in POX: via a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object for that particular datapath or via an OpenFlow Nexus which is managing that datapath.  There is one&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object for each datapath connected to POX, and there is typically one OpenFlow Nexus that manages all connections.  In the normal configuration, there is a single OpenFlow nexus which is available as&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow</span></code>.  There is a lot of overlap between&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connections</span></code>&nbsp;and the Nexus.  Either one can be used to send a message to a switch, and most events are raised on both.  Sometimes it&#8217;s more convenient to use one or the other.  If your application is interested in events from all switches, it may make sense to listen to the Nexus, which raises events for all switches.  If you&#8217;re interested only in a single switch, it may make sense to listen to the specific Connection.</p>
<div class="section" id="connection-objects">
<h3><a class="toc-backref" href="#id101">Connection Objects</a><a class="headerlink" href="#connection-objects" title="Permalink to this headline">¶</a></h3>
<p>Every time a switch connects to POX, there is also an associated&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object.  If your code has a reference to that&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object, you can use its&nbsp;<code class="code mono bash docutils literal"><span class="pre">send</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method to send messages to the datapath.</p>
<p><code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;objects, along with being able to send commands to switches and being sources of events from switches, have a number of other useful attributes.  We list some here (for more, view the reference for the&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;class):</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="97%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">member</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">ofnexus</span></code></td>
<td>A reference to the nexus object associated with this connection.  (Usually this is the same as core.openflow.)</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">dpid</span></code></td>
<td>The datapath identifier of the switch. (See the next section for more details.)</td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">features</span></code></td>
<td>The switch features reply (ofp_switch_features) sent by the switch during handshaking.</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">ports</span></code></td>
<td>The ports on the switch.  As these may change during the lifetime of a connection, POX <em>attempts</em> to track such changes.  However, there is always the possibility that these are out of date (hopefully only transiently). <br /><br /> This attribute is a reference to a special <code class="code mono bash docutils literal"><span class="pre">PortCollection</span></code> object.  This object is sort of like a dictionary where values are <code class="code mono bash docutils literal"><span class="pre">ofp_phy_port</span></code> objects and the keys are flexible – you can look up ports by their OpenFlow port number (<code class="code mono bash docutils literal"><span class="pre">ofp_phy_port</span></code>&#8216;s <code class="code mono bash docutils literal"><span class="pre">.port_no</span></code>), their Ethernet address (<code class="code mono bash docutils literal"><span class="pre">ofp_phy_port</span></code>&#8216;s <code class="code mono bash docutils literal"><span class="pre">.hw_addr</span></code>), or their port name (<code class="code mono bash docutils literal"><span class="pre">ofp_phy_port</span></code>&#8216;s <code class="code mono bash docutils literal"><span class="pre">.name</span></code>, e.g., &#8220;eth0&#8221;).</td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">sock</span></code></td>
<td>The socket connecting to the peer.  This is a Python socket object, so you can, e.g., retrieve the address of the switch&#8217;s side of the connection using <code class="code mono bash docutils literal"><span class="pre">connection.sock.getpeername</span><span class="operator"><span class="pre">()</span></span></code>.</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">send</span><span class="operator"><span class="pre">(</span></span><span class="pre">msg</span><span class="operator"><span class="pre">)</span></span></code></td>
<td>A method used to send an OpenFlow message to the switch.</td>
</tr>
</tbody>
</table>
<p>In addition to its attributes and the send() method, Connection objects raise events corresponding to particular datapaths, for example when a datapath disconnects or sends a notification (for more on events in general, see the section &#8220;The Event System&#8221;).  You can create handlers for events on a particular datapath by registering event listeners on the associated Connection.  You can find examples of this later in this section.</p>
<div class="section" id="getting-a-reference-to-a-connection-object">
<h4><a class="toc-backref" href="#id102">Getting a Reference to a Connection Object</a><a class="headerlink" href="#getting-a-reference-to-a-connection-object" title="Permalink to this headline">¶</a></h4>
<p>If you wish to use any of the above-mentioned attributes of a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object, you – of course&nbsp;– need a reference to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object associated with the datapath you&#8217;re interested in.  There are three major ways to get such a reference to a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object:</p>
<ol class="arabic simple">
<li>You can listen to&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;events on the nexus – these pass the new&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;object along</li>
<li>You can use the nexus&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">getConnection</span><span class="operator"><span class="pre">(</span></span><span class="pre">&lt;DPID&gt;</span><span class="operator"><span class="pre">)</span></span></code> method to find a connection by the switch&#8217;s DPID (see the next section)</li>
<li>You can enumerate all of the nexus&#8217;s connections via its&nbsp;<code class="code mono bash docutils literal"><span class="pre">connections</span></code>&nbsp;property (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="keyword"><span class="pre">for</span></span> <span class="pre">con</span> <span class="pre">in</span> <span class="pre">core.openflow.connections</span></code>) (see the next section)</li>
</ol>
<p>As an example of the first, you may have code in your own component class which tracks connections and stores references to them itself.  It does this by listening to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;event on the OpenFlow nexus.  This event includes a reference to the new connection, which is added to its own set of connections.  The following code demonstrates this (note that a more complete implementation would also want to use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionDown</span></code>&nbsp;event to remove&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>s from the set!).</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">MyComponent</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">addListeners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_handle_ConnectionUp</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">connections</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">connection</span><span class="p">)</span> <span class="c"># See ConnectionUp event documentation</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="the-openflow-nexus-core-openflow">
<h3><a class="toc-backref" href="#id103">The OpenFlow Nexus – core.openflow</a><a class="headerlink" href="#the-openflow-nexus-core-openflow" title="Permalink to this headline">¶</a></h3>
<p>An OpenFlow nexus is essentially a manager for a set of OpenFlow&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connections</span></code>.  Typically, there is a single nexus which manages connections to all switches, and this is available as&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow</span></code>.  (The advanced topic of creating multiple nexus objects and assigning particular connections to each one via a connection arbiter object is an advanced topic for very particular use cases and is not currently covered in this manual.)</p>
<p>Here we list some attributes of a nexus:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="92%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">miss_send_len</span></code></td>
<td>When a packet does not match any table entry on a datapath, the datapath will forward the packet to the controller inside a packet-in message.  To conserve bandwidth, the datapath will actually not send the entire packet, but only the first <code class="code mono bash docutils literal"><span class="pre">miss_send_len</span></code> bytes.  By adjusting this value here, any datapaths which subsequently connect will be configured to only send this number of bytes. <br /><br />   This defaults to OFP_DEFAULT_MISS_SEND_LEN from the OpenFlow specification (128 bytes).</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">clear_flows_of_connect</span></code></td>
<td>When True (the default), POX will delete all flows on the first table of a switch when it connects.</td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">connections</span></code></td>
<td>A special collection (see below) containing references to all connections this nexus is handling.</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">getConnection</span><span class="operator"><span class="pre">(</span></span><span class="pre">&lt;dpid&gt;</span><span class="operator"><span class="pre">)</span></span></code></td>
<td>Get a connection object for a particular datapath via its DPID or None if not available.</td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">sendToDPID</span><span class="operator"><span class="pre">(</span></span><span class="pre">&lt;dpid&gt;,&lt;msg&gt;</span><span class="operator"><span class="pre">)</span></span></code></td>
<td>Send an OpenFlow message to a particular datapath, dropping the message (and logging a warning) if the datapath isn&#8217;t connected.  (<code class="code mono bash docutils literal"><span class="pre">Similar</span> <span class="pre">to</span> <span class="pre">doing</span> <span class="pre">core.openflow.getConnection</span><span class="operator"><span class="pre">(</span></span><span class="pre">dpid</span><span class="operator"><span class="pre">)</span></span><span class="pre">.send</span><span class="operator"><span class="pre">(</span></span><span class="pre">msg</span><span class="operator"><span class="pre">)</span></span></code>).</td>
</tr>
</tbody>
</table>
<p>The connections collection is essentially a dictionary where the keys are DPIDs and the values are Connection objects.  However, if you iterate this, it iterates the Connections and not the DPIDs, unlike a normal dictionary.  To iterate the DPIDs, you can use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.iter_dpids</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;method. Additionally, you can use the &#8220;in&#8221; operator to check for whether a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;is in this collection as well as whether a DPID is in the collection, and there is a&nbsp;<code class="code mono bash docutils literal"><span class="pre">.dpids</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;attribute which is really the same as&nbsp;<code class="code mono bash docutils literal"><span class="pre">.keys</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<p>As with Connection objects, you can also set event listeners on the nexus object itself.  Whereas a Connection object only raises events pertaining to the datapath associated with that particular Connection, the nexus object raises events relevant to&nbsp;<em>any</em> of the Connections it&#8217;s managing.  We dig in to these events in the next subsection.</p>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<p class="last">Add notes on order of events between nexus and Connection, halting events, etc.</p>
</div>
</div>
</div>
<div class="section" id="openflow-events-responding-to-switches">
<h2><a class="toc-backref" href="#id104">OpenFlow Events: Responding to Switches</a><a class="headerlink" href="#openflow-events-responding-to-switches" title="Permalink to this headline">¶</a></h2>
<p>_Note: For more background on the event system in POX, see the relevant section in this manual._</p>
<p>Most OpenFlow related events are raised in direct response to a message received from a switch.  As a general guideline, OpenFlow related events have the following three attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="8%" />
<col width="15%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>connection</td>
<td>Connection</td>
<td>Connection to the relevant switch (e.g., which sent the message this event corresponds to).</td>
</tr>
<tr class="row-odd"><td>dpid</td>
<td>long</td>
<td>Datapath ID of relevant switch (use dpid_to_str() to format it for display).</td>
</tr>
<tr class="row-even"><td>ofp</td>
<td>ofp_header subclass</td>
<td>OpenFlow message object that caused this event.  See <a class="reference internal" href="#openflow-messages">OpenFlow Messages</a> for info on these objects.</td>
</tr>
</tbody>
</table>
<p>In the rest of this section, we describe some of the events provided by the OpenFlow module and topology module.  To get you started, here&#8217;s a very simple POX component that listens to&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;events from all switches, and logs a message when one occurs.  You can put this into a file (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">ext/connection_watcher.py</span></code>) and then run it (with&nbsp;<code class="code mono bash docutils literal"><span class="pre">./pox.py</span> <span class="pre">connection_watcher</span></code>) and watch switches connect.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">pox.core</span> <span class="kn">import</span> <span class="n">core</span>
<span class="kn">from</span> <span class="nn">pox.lib.util</span> <span class="kn">import</span> <span class="n">dpid_to_str</span>

<span class="n">log</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getLogger</span><span class="p">()</span>

<span class="k">class</span> <span class="nc">MyComponent</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">addListeners</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">_handle_ConnectionUp</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
    <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Switch </span><span class="si">%s</span><span class="s"> has come up.&quot;</span><span class="p">,</span> <span class="n">dpid_to_str</span><span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">dpid</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">launch</span> <span class="p">():</span>
  <span class="n">core</span><span class="o">.</span><span class="n">registerNew</span><span class="p">(</span><span class="n">MyComponent</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="connectionup">
<h3><a class="toc-backref" href="#id105">ConnectionUp</a><a class="headerlink" href="#connectionup" title="Permalink to this headline">¶</a></h3>
<p>Unlike most other OpenFlow events, this message is not raised in response to reception of a specific OpenFlow message from a switch – it&#8217;s simply fired in response to the establishment of a new control channel with a switch.</p>
<p>Also note that while most OpenFlow events are raised on both the Connection itself and on the OpenFlow nexus, the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;event is raised only on the nexus.  This makes sense since the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;event is the first sign that a&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;exists – nobody could have possibly set a listener on it yet!</p>
<p>Additional attribute information (in addition to the standard OpenFlow event attributes):</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="7%" />
<col width="90%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">type</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ofp</td>
<td>ofp_switch_features</td>
<td>Contains information about the switch, for example supported action types (e.g., whether field rewriting is available), and port information (e.g., MAC addresses and names).  (This is also available on the Connection&#8217;s <code class="code mono bash docutils literal"><span class="pre">features</span></code> attribute.)</td>
</tr>
</tbody>
</table>
<p>This event can be handled as shown below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_handle_ConnectionUp</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
  <span class="k">print</span> <span class="s">&quot;Switch </span><span class="si">%s</span><span class="s"> has come up.&quot;</span> <span class="o">%</span> <span class="n">event</span><span class="o">.</span><span class="n">dpid</span>
</pre></div>
</div>
</div>
<div class="section" id="connectiondown">
<h3><a class="toc-backref" href="#id106">ConnectionDown</a><a class="headerlink" href="#connectiondown" title="Permalink to this headline">¶</a></h3>
<p>Similar to&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>&nbsp;but unlike most other OpenFlow-related events, this event is not fired in response to an actual OpenFlow message.  It is simply fired when a connection to a switch has been terminated (either because it has been closed explicitly, because the switch was restarted, etc.).</p>
<p>Note that unlike&nbsp;<code class="code mono bash docutils literal"><span class="pre">ConnectionUp</span></code>, this event is raised on both the nexus and the&nbsp;<code class="code mono bash docutils literal"><span class="pre">Connection</span></code>&nbsp;itself.</p>
<p>Note that this event has no&nbsp;<code class="code mono bash docutils literal"><span class="pre">.ofp</span></code>&nbsp;attribute.</p>
</div>
<div class="section" id="portstatus">
<h3><a class="toc-backref" href="#id107">PortStatus</a><a class="headerlink" href="#portstatus" title="Permalink to this headline">¶</a></h3>
<p><code class="code mono bash docutils literal"><span class="pre">PortStatus</span></code>&nbsp;events are raised when the controller receives an OpenFlow port-status message (<code class="code mono bash docutils literal"><span class="pre">ofp_port_status</span></code>) from a switch, which indicates that ports have changed.  Thus, its&nbsp;<code class="code mono bash docutils literal"><span class="pre">.ofp</span></code>&nbsp;attribute is an&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_port_status</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">PortStatus</span> <span class="p">(</span><span class="n">Event</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">connection</span><span class="p">,</span> <span class="n">ofp</span><span class="p">):</span>
    <span class="n">Event</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">connection</span> <span class="o">=</span> <span class="n">connection</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dpid</span> <span class="o">=</span> <span class="n">connection</span><span class="o">.</span><span class="n">dpid</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">ofp</span> <span class="o">=</span> <span class="n">ofp</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">modified</span> <span class="o">=</span> <span class="n">ofp</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="n">of</span><span class="o">.</span><span class="n">OFPPR_MODIFY</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">added</span> <span class="o">=</span> <span class="n">ofp</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="n">of</span><span class="o">.</span><span class="n">OFPPR_ADD</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">deleted</span> <span class="o">=</span> <span class="n">ofp</span><span class="o">.</span><span class="n">reason</span> <span class="o">==</span> <span class="n">of</span><span class="o">.</span><span class="n">OFPPR_DELETE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="n">ofp</span><span class="o">.</span><span class="n">desc</span><span class="o">.</span><span class="n">port_no</span>
</pre></div>
</div>
<p>A quick example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">_handle_PortStatus</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">event</span><span class="p">):</span>
  <span class="k">if</span> <span class="n">event</span><span class="o">.</span><span class="n">added</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="s">&quot;added&quot;</span>
  <span class="k">elif</span> <span class="n">event</span><span class="o">.</span><span class="n">deleted</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="s">&quot;removed&quot;</span>
  <span class="k">else</span><span class="p">:</span>
    <span class="n">action</span> <span class="o">=</span> <span class="s">&quot;modified&quot;</span>
  <span class="k">print</span> <span class="s">&quot;Port </span><span class="si">%s</span><span class="s"> on Switch </span><span class="si">%s</span><span class="s"> has been </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">event</span><span class="o">.</span><span class="n">port</span><span class="p">,</span> <span class="n">event</span><span class="o">.</span><span class="n">dpid</span><span class="p">,</span> <span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="flowremoved">
<h3><a class="toc-backref" href="#id108">FlowRemoved</a><a class="headerlink" href="#flowremoved" title="Permalink to this headline">¶</a></h3>
<p><code class="code mono bash docutils literal"><span class="pre">FlowRemoved</span></code>&nbsp;events are raised when the controller receives an OpenFlow flow-removed message (<code class="code mono bash docutils literal"><span class="pre">ofp_flow_removed</span></code>) from a switch, which are sent when a table entry is removed on the switch either due to a timeout or explicit deletion.  Such notifications are sent only when the flow was installed with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">OFPFF_SEND_FLOW_REM</span></code> flag set.  See the OpenFlow specification for further details.</p>
<p>While you can, as usual, access the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_flow_removed</span></code>&nbsp;directly via the event&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">.ofp</span></code>&nbsp;attribute, the event has several attributes for convenience:</p>
<table border="1" class="docutils">
<colgroup>
<col width="18%" />
<col width="6%" />
<col width="76%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">type</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>idleTimeout</td>
<td>bool</td>
<td>True if entry was removed due to idleness</td>
</tr>
<tr class="row-odd"><td>hardTimeout</td>
<td>bool</td>
<td>True if entry was removed due to a hard timeout</td>
</tr>
<tr class="row-even"><td>timeout</td>
<td>bool</td>
<td>True if entry was removed due to any timeout</td>
</tr>
<tr class="row-odd"><td>deleted</td>
<td>bool</td>
<td>True if entry was explicitly deleted</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="statistics-events">
<h3><a class="toc-backref" href="#id109">Statistics Events</a><a class="headerlink" href="#statistics-events" title="Permalink to this headline">¶</a></h3>
<p>Statistics events are raised when the controller receives an OpenFlow statistics reply message (<code class="code mono bash docutils literal"><span class="pre">ofp_stats_reply&nbsp;/</span> <span class="pre">OFPT_STATS_REPLY</span></code>) from a switch, which is sent in response to a statistics request sent by the controller.</p>
<p>There are a number of statistics events.  The most basic is&nbsp;<code class="code mono bash docutils literal"><span class="pre">RawStatsReply</span></code>&nbsp;which is simply fired in response to an ofp_stats_reply message from the switch.  However, this message (and therefore the associated event) is not particularly convenient, as it&#8217;s up to the user to determine what type of statistics event it is, and possibly to &#8220;glue back together&#8221; multi-part statistics replies.</p>
<p>To remedy this, POX includes separate events for each statistics reply type, and these events are fired when the entire response (including possible multiple parts) have been received.  If none of this makes any sense to you because you haven&#8217;t read the OpenFlow specification thoroughly – that&#8217;s fine.  The short of it is that you should just handle the event for the specific stats type that you&#8217;re interested in.  These include:</p>
<table border="1" class="docutils">
<colgroup>
<col width="51%" />
<col width="49%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Event</th>
<th class="head">OpenFlow Stats Type</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">SwitchDescReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_desc_stats</span></code></td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">FlowStatsReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_flow_stats</span></code></td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">AggregateFlowStatsReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_aggregate_stats_reply</span></code></td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">TableStatsReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_table_stats</span></code></td>
</tr>
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">PortStatsReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_port_stats</span></code></td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">QueueStatsReceived</span></code></td>
<td><code class="code mono bash docutils literal"><span class="pre">ofp_queue_stats</span></code></td>
</tr>
</tbody>
</table>
<p>Underneath, each of these events is a subclass of the&nbsp;<code class="code mono bash docutils literal"><span class="pre">StatsReply</span></code>&nbsp;superclass.  When handling these&nbsp;<code class="code mono bash docutils literal"><span class="pre">StatsReply</span></code>-based events, the&nbsp;<code class="code mono bash docutils literal"><span class="pre">.stats</span></code>&nbsp;attribute will contain a complete set of statistics (e.g., an array of&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_flow_stats&nbsp;</span><span class="literal string backtick"><span class="pre">`</span></span><span class="keyword"><span class="pre">for</span></span><span class="pre">:mono:</span></code>&nbsp;FlowStatsReceived`).  See the section on&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_stats_request</span></code>&nbsp;for more information.  More specifically, note the following information for all&nbsp;<code class="code mono bash docutils literal"><span class="pre">StatsReply</span></code>&nbsp;subclasses:</p>
<table border="1" class="docutils">
<colgroup>
<col width="5%" />
<col width="95%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><code class="code mono bash docutils literal"><span class="pre">ofp</span></code></td>
<td>Because a <code class="code mono bash docutils literal"><span class="pre">StatsReply</span></code> may have glued together multiple individual OpenFlow messages, the <code class="code mono bash docutils literal"><span class="pre">.ofp</span></code> attribute is a _list_ of <code class="code mono bash docutils literal"><span class="pre">ofp_stats_reply</span></code> messages.  (In the typical case, however, the list has a single entry.)</td>
</tr>
<tr class="row-odd"><td><code class="code mono bash docutils literal"><span class="pre">stats</span></code></td>
<td>All of the individual stats bodies in a single list.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="packetin">
<h3><a class="toc-backref" href="#id110">PacketIn</a><a class="headerlink" href="#packetin" title="Permalink to this headline">¶</a></h3>
<p>Fired when the controller receives an OpenFlow packet-in message (<code class="code mono bash docutils literal"><span class="pre">ofp_packet_in&nbsp;/</span> <span class="pre">OFPT_PACKET_IN</span></code>) from a switch, which indicates that a packet arriving at a switch port has either failed to match all entries in the table, or the matching entry included an action specifying to send the packet to the controller.</p>
<p>In addition to the usual OpenFlow event attributes:</p>
<ul class="simple">
<li>port (int) - number of port the packet came in on</li>
<li>data (bytes) - raw packet data</li>
<li>parsed (packet subclasses) - pox.lib.packet&#8217;s parsed version</li>
<li>ofp (ofp_packet_in) - OpenFlow message which caused this event</li>
</ul>
</div>
<div class="section" id="errorin">
<h3><a class="toc-backref" href="#id111">ErrorIn</a><a class="headerlink" href="#errorin" title="Permalink to this headline">¶</a></h3>
<p>Fired when the controller receives an OpenFlow error (<code class="code mono bash docutils literal"><span class="pre">ofp_error_msg</span> <span class="pre">/</span> <span class="pre">OFPT_ERROR_MSG</span></code>) from a switch.</p>
<p>In addition to the usual OpenFlow event attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="6%" />
<col width="94%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>should_log</td>
<td>Usually, an OpenFlow error results in a log message.  If you handle the ErrorIn event, you may set this attribute to False to silence the default log message.</td>
</tr>
<tr class="row-odd"><td>asString()</td>
<td>Formats this error as a string.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="barrierin">
<h3><a class="toc-backref" href="#id112">BarrierIn</a><a class="headerlink" href="#barrierin" title="Permalink to this headline">¶</a></h3>
<p>Fired when the controller receives an OpenFlow barrier reply (<code class="code mono bash docutils literal"><span class="pre">OFPT_</span></code><code class="code mono bash docutils literal"><span class="pre">BARRIER_R</span></code><code class="code mono bash docutils literal"><span class="pre">EPLY</span></code>) from a switch, which indicates that the switch has finished processing commands sent by the controller prior to the corresponding barrier request.</p>
<p>In addition to the usual attributes for OpenFlow events, the BarrierIn event contains:</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="2%" />
<col width="95%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">type</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>xid</td>
<td>integer</td>
<td>Transaction ID.  For events which are responses to commands sent by the controller, this will contain the same value as the <code class="code mono bash docutils literal"><span class="pre">.xid</span></code> of the command.  For instance, a <code class="code mono bash docutils literal"><span class="pre">BarrierIn</span></code>&#8216;s <code class="code mono bash docutils literal"><span class="pre">.xid</span></code> will be the same value as was used in the <code class="code mono bash docutils literal"><span class="pre">ofp_barrier_request</span></code> message.</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="openflow-messages">
<h2><a class="toc-backref" href="#id113">OpenFlow Messages</a><a class="headerlink" href="#openflow-messages" title="Permalink to this headline">¶</a></h2>
<p>OpenFlow messages are how OpenFlow switches communicate with controllers.  The messages are defined in the OpenFlow Specification.  There are multiple versions of the specification; POX currently supports OpenFlow version 1.0.0 (wire protocol version 0x01).</p>
<p>POX contains classes and constants corresponding to elements of the OpenFlow protocol, and these are defined in the file&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox/openflow/libopenflow_01.py</span></code>&nbsp;(the 01 referring to the wire protocol version). For the most part, the names are the same as they are in the specification.  In a few instances, POX has names which we think are better.  Additionally, POX defines some classes do not correspond to specific structures in the specification (the specification does not describe structs which are just a plain OpenFlow header only differentiated by the message type attribute – POX does).  Thus, you may well wish to refer to the&nbsp;<a class="reference external" href="http://www.openflow.org/documents/openflow-spec-v1.0.0.pdf">OpenFlow Specification</a>&nbsp;itself in addition to this document (and, of course, the POX code and pydoc/Sphinx reference).</p>
<p>A nice aspect of POX&#8217;s OpenFlow library is that many fields have useful default values or can infer values.</p>
<p>In the following subsections, we will discuss a useful subset of POX&#8217;s OpenFlow interface.</p>
<div class="admonition-todo admonition" id="index-6">
<p class="first admonition-title">Todo</p>
<p class="last">Redo following sections to have tables of values/types/descriptions rather than snippets from init functions.</p>
</div>
<div class="section" id="ofp-packet-out-sending-packets-from-the-switch">
<h3><a class="toc-backref" href="#id114">ofp_packet_out - Sending packets from the switch</a><a class="headerlink" href="#ofp-packet-out-sending-packets-from-the-switch" title="Permalink to this headline">¶</a></h3>
<p>The main purpose of this message is to instruct a switch to send a packet (or enqueue it).  However it can also be useful as a way to instruct a switch to discard a buffered packet (by simply not specifying any actions).</p>
<table border="1" class="docutils">
<colgroup>
<col width="3%" />
<col width="10%" />
<col width="3%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">attribute</th>
<th class="head">type</th>
<th class="head">default</th>
<th class="head">notes</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>buffer_id</td>
<td>int/None</td>
<td>None</td>
<td>ID of the buffer in which the packet is stored at the datapath. If you&#8217;re not resending a buffer by ID, use None.</td>
</tr>
<tr class="row-odd"><td>in_port</td>
<td>int</td>
<td>OFPP_NONE</td>
<td>Switch port that the packet arrived on if resending a packet.</td>
</tr>
<tr class="row-even"><td>actions</td>
<td>list of ofp_action_XXXX</td>
<td>[ ]</td>
<td>If you have a single item, you can also specify this using the named parameter &#8220;action&#8221; of the initializer.</td>
</tr>
<tr class="row-odd"><td>data</td>
<td>bytes / ethernet / ofp_packet_in</td>
<td>&#8216;&#8217;</td>
<td>The data to be sent (or None if sending an existing buffer via its buffer_id). <br /><br /> If you specify an <code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code> for this, <code class="code mono bash docutils literal"><span class="pre">in_port</span></code>, <code class="code mono bash docutils literal"><span class="pre">buffer_id</span></code>, and <code class="code mono bash docutils literal"><span class="pre">data</span></code> will all be set correctly – this is the easiest way to resend a packet.</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you receive an <code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code> and wish to resend it, you can simply use it as the <code class="code mono bash docutils literal"><span class="pre">data</span></code> attribute.</p>
</div>
<p>See section of 5.3.6 of OpenFlow 1.0 spec. This class is defined in pox/openflow/libopenflow_01.py.</p>
</div>
<div class="section" id="ofp-flow-mod-flow-table-modification">
<h3><a class="toc-backref" href="#id115">ofp_flow_mod - Flow table modification</a><a class="headerlink" href="#ofp-flow-mod-flow-table-modification" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_flow_mod</span> <span class="p">(</span><span class="n">ofp_header</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">ofp_header</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header_type</span> <span class="o">=</span> <span class="n">OFPT_FLOW_MOD</span>
    <span class="k">if</span> <span class="s">&#39;match&#39;</span> <span class="ow">in</span> <span class="n">kw</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">ofp_match</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">cookie</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">command</span> <span class="o">=</span> <span class="n">OFPFC_ADD</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">idle_timeout</span> <span class="o">=</span> <span class="n">OFP_FLOW_PERMANENT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">hard_timeout</span> <span class="o">=</span> <span class="n">OFP_FLOW_PERMANENT</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="n">OFP_DEFAULT_PRIORITY</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">buffer_id</span> <span class="o">=</span> <span class="bp">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">out_port</span> <span class="o">=</span> <span class="n">OFPP_NONE</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">actions</span> <span class="o">=</span> <span class="p">[]</span>
</pre></div>
</div>
<ul class="simple">
<li>cookie (int) - identifier for this flow rule. (optional)</li>
<li>command (int) - One of the following values:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>OFPFC_ADD - add a rule to the datapath (default)</li>
<li>OFPFC_MODIFY - modify any matching rules</li>
<li>OFPFC_MODIFY_STRICT - modify rules which strictly match wildcard values.</li>
<li>OFPFC_DELETE - delete any matching rules</li>
<li>OFPFC_DELETE_STRICT - delete rules which strictly match wildcard values.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>idle_timeout (int) - rule will expire if it is not matched in &#8216;idle_timeout&#8217; seconds. A value of&nbsp;OFP_FLOW_PERMANENT means there is no idle_timeout (the default).</li>
<li>hard_timeout (int) - rule will expire after &#8216;hard_timeout&#8217; seconds. A value of&nbsp;OFP_FLOW_PERMANENT means it will never expire (the default)</li>
<li>priority (int) - the priority at which a rule will match, higher numbers higher priority. Note: Exact matches will have highest priority.</li>
<li>buffer_id (int) - A buffer on the datapath that the new flow will be applied to.  Use None for none.  Not meaningful for flow deletion.</li>
<li>out_port (int) - This field is used to match for DELETE commands.OFPP_NONE may be used to indicate that there is no restriction.</li>
<li>flags (int) - Integer bitfield in which the following flag bits may be set:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>OFPFF_SEND_FLOW_REM - Send flow removed message to the controller when rule expires</li>
<li>OFPFF_CHECK_OVERLAP - Check for overlapping entries when installing. If one exists, then an error is send to controller</li>
<li>OFPFF_EMERG - Consider this flow as an emergency flow and only use it when the switch controller connection is down.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>actions (list) - actions are defined below, each desired action object is then appended to this list and they are executed in order.</li>
<li>match (ofp_match) - the match structure for the rule to match on (see below).</li>
</ul>
<p>See section of 5.3.3 of OpenFlow 1.0 spec. This class is defined in pox/openflow/libopenflow_01.py.</p>
<div class="section" id="example-installing-a-table-entry">
<h4><a class="toc-backref" href="#id116">Example: Installing a table entry</a><a class="headerlink" href="#example-installing-a-table-entry" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Traffic to 192.168.101.101:80 should be sent out switch port 4</span>

<span class="c"># One thing at a time...</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_flow_mod</span><span class="p">()</span>
<span class="n">msg</span><span class="o">.</span><span class="n">priority</span> <span class="o">=</span> <span class="mi">42</span>
<span class="n">msg</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">dl_type</span> <span class="o">=</span> <span class="mh">0x800</span>
<span class="n">msg</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">nw_dst</span> <span class="o">=</span> <span class="n">IPAddr</span><span class="p">(</span><span class="s">&quot;192.168.101.101&quot;</span><span class="p">)</span>
<span class="n">msg</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">tp_dst</span> <span class="o">=</span> <span class="mi">80</span>
<span class="n">msg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_action_output</span><span class="p">(</span><span class="n">port</span> <span class="o">=</span> <span class="mi">4</span><span class="p">))</span>
<span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

<span class="c"># Same exact thing, but in a single line...</span>
<span class="bp">self</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_flow_mod</span><span class="p">(</span> <span class="n">action</span><span class="o">=</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_action_output</span><span class="p">(</span> <span class="n">port</span><span class="o">=</span><span class="mi">4</span> <span class="p">),</span>
                                       <span class="n">priority</span><span class="o">=</span><span class="mi">42</span><span class="p">,</span>
                                       <span class="n">match</span><span class="o">=</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_match</span><span class="p">(</span> <span class="n">dl_type</span><span class="o">=</span><span class="mh">0x800</span><span class="p">,</span>
                                                           <span class="n">nw_dst</span><span class="o">=</span><span class="s">&quot;192.168.101.101&quot;</span><span class="p">,</span>
                                                           <span class="n">tp_dst</span><span class="o">=</span><span class="mi">80</span> <span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="section" id="example-clearing-tables-on-all-switches">
<h4><a class="toc-backref" href="#id117">Example: Clearing tables on all switches</a><a class="headerlink" href="#example-clearing-tables-on-all-switches" title="Permalink to this headline">¶</a></h4>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># create ofp_flow_mod message to delete all flows</span>
<span class="c"># (note that flow_mods match all flows by default)</span>
<span class="n">msg</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_flow_mod</span><span class="p">(</span><span class="n">command</span><span class="o">=</span><span class="n">of</span><span class="o">.</span><span class="n">OFPFC_DELETE</span><span class="p">)</span>

<span class="c"># iterate over all connected switches and delete all their flows</span>
<span class="k">for</span> <span class="n">connection</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span> <span class="c"># _connections.values() before betta</span>
  <span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
  <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Clearing all flows from </span><span class="si">%s</span><span class="s">.&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dpidToStr</span><span class="p">(</span><span class="n">connection</span><span class="o">.</span><span class="n">dpid</span><span class="p">),))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="ofp-stats-request-requesting-statistics-from-switches">
<h3><a class="toc-backref" href="#id118">ofp_stats_request - Requesting statistics from switches</a><a class="headerlink" href="#ofp-stats-request-requesting-statistics-from-switches" title="Permalink to this headline">¶</a></h3>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_stats_request</span> <span class="p">(</span><span class="n">ofp_header</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="n">ofp_header</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">header_type</span> <span class="o">=</span> <span class="n">OFPT_STATS_REQUEST</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># Try to guess</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">flags</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">body</span> <span class="o">=</span> <span class="n">b</span><span class="s">&#39;&#39;</span>
</pre></div>
</div>
<ul class="simple">
<li>type (int) - The type of stats request (e.g., OFPST_PORT).  Default is to try to guess based on&nbsp;<em>body</em>.</li>
<li>flags (int) - No flags are defined in OpenFlow 1.0.</li>
<li>body (flexible) - The body of the stats request.  This can be a raw bytes object, or a packable class (e.g., ofp_port_stats_request).</li>
</ul>
<p>See section of 5.3.5 of OpenFlow 1.0 spec for more info on this structure and on the individual statistics types (port stats, flow stats, aggregate flow stats, table stats, etc.). This class is defined in pox/openflow/libopenflow_01.py</p>
<div class="admonition-todo admonition" id="index-7">
<p class="first admonition-title">Todo</p>
<p class="last">Show some of the individual stats request/reply types?</p>
</div>
<div class="section" id="example-web-flow-statistics">
<h4><a class="toc-backref" href="#id119">Example - Web Flow Statistics</a><a class="headerlink" href="#example-web-flow-statistics" title="Permalink to this headline">¶</a></h4>
<p>Request the flow table from a switch and dump info about web traffic.  This example is meant to be run along with, say, the forwarding.l2_learning component.  It can be pasted into the POX interactive interpreter (if you run POX including the&nbsp;<code class="code mono bash docutils literal"><span class="pre">py</span></code>&nbsp;component).  There is also an extended version of this example meant to run as a component in the Third Party section – the &#8220;Statistics Collector Example&#8221;.</p>
<p>See the Statistics Events section for more info.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pox.openflow.libopenflow_01</span> <span class="kn">as</span> <span class="nn">of</span>
<span class="n">log</span> <span class="o">=</span> <span class="n">core</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;WebStats&quot;</span><span class="p">)</span>

<span class="c"># When we get flow stats, print stuff out</span>
<span class="k">def</span> <span class="nf">handle_flow_stats</span> <span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="n">web_bytes</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="n">web_flows</span> <span class="o">=</span> <span class="mi">0</span>
  <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">event</span><span class="o">.</span><span class="n">stats</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">f</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">tp_dst</span> <span class="o">==</span> <span class="mi">80</span> <span class="ow">or</span> <span class="n">f</span><span class="o">.</span><span class="n">match</span><span class="o">.</span><span class="n">tp_src</span> <span class="o">==</span> <span class="mi">80</span><span class="p">:</span>
      <span class="n">web_bytes</span> <span class="o">+=</span> <span class="n">f</span><span class="o">.</span><span class="n">byte_count</span>
      <span class="n">web_flows</span> <span class="o">+=</span> <span class="mi">1</span>
  <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s">&quot;Web traffic: </span><span class="si">%s</span><span class="s"> bytes over </span><span class="si">%s</span><span class="s"> flows&quot;</span><span class="p">,</span> <span class="n">web_bytes</span><span class="p">,</span> <span class="n">web_flows</span><span class="p">)</span>

<span class="c"># Listen for flow stats</span>
<span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">addListenerByName</span><span class="p">(</span><span class="s">&quot;FlowStatsReceived&quot;</span><span class="p">,</span> <span class="n">handle_flow_stats</span><span class="p">)</span>

<span class="c"># Now actually request flow stats from all switches</span>
<span class="k">for</span> <span class="n">con</span> <span class="ow">in</span> <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">connections</span><span class="p">:</span> <span class="c"># make this _connections.keys() for pre-betta</span>
  <span class="n">con</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_stats_request</span><span class="p">(</span><span class="n">body</span><span class="o">=</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_flow_stats_request</span><span class="p">()))</span>
</pre></div>
</td></tr></table></div>
</div>
</div>
</div>
<div class="section" id="match-structure">
<h2><a class="toc-backref" href="#id120">Match Structure</a><a class="headerlink" href="#match-structure" title="Permalink to this headline">¶</a></h2>
<p>OpenFlow defines a match structure –&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>&nbsp;– which enables you to define a set of headers for packets to match against. You can either build a match from scratch, or use a factory method to create one based on an existing packet.</p>
<p>The match structure is defined in pox/openflow/libopenflow_01.py in class&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>.  Its attributes are derived from the members listed in the OpenFlow specification, so refer to that for more information, though they are summarized in the table below.</p>
<p><code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>&nbsp;attributes:</p>
<table border="1" class="docutils">
<colgroup>
<col width="16%" />
<col width="84%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Attribute</th>
<th class="head">Meaning</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>in_port</td>
<td>Switch port number the packet arrived on</td>
</tr>
<tr class="row-odd"><td>dl_src</td>
<td>Ethernet source address</td>
</tr>
<tr class="row-even"><td>dl_dst</td>
<td>Ethernet destination address</td>
</tr>
<tr class="row-odd"><td>dl_vlan</td>
<td>VLAN ID</td>
</tr>
<tr class="row-even"><td>dl_vlan_pcp</td>
<td>VLAN priority</td>
</tr>
<tr class="row-odd"><td>dl_type</td>
<td>Ethertype / length (e.g. 0x0800 = IPv4)</td>
</tr>
<tr class="row-even"><td>nw_tos</td>
<td>IP TOS/DS bits</td>
</tr>
<tr class="row-odd"><td>nw_proto</td>
<td>IP protocol (e.g., 6 = TCP) or lower 8 bits of ARP opcode</td>
</tr>
<tr class="row-even"><td>nw_src</td>
<td>IP source address</td>
</tr>
<tr class="row-odd"><td>nw_dst</td>
<td>IP destination address</td>
</tr>
<tr class="row-even"><td>tp_src</td>
<td>TCP/UDP source port</td>
</tr>
<tr class="row-odd"><td>tp_dst</td>
<td>TCP/UDP destination port</td>
</tr>
</tbody>
</table>
<p>Attributes may be specified either on a match object or during its initialization.  That is, the following are equivalent:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my_match</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_match</span><span class="p">(</span><span class="n">in_port</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">dl_dst</span> <span class="o">=</span> <span class="n">EthAddr</span><span class="p">(</span><span class="s">&quot;01:02:03:04:05:06&quot;</span><span class="p">))</span>
<span class="c">#.. or ..</span>
<span class="n">my_match</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_match</span><span class="p">()</span>
<span class="n">my_match</span><span class="o">.</span><span class="n">in_port</span> <span class="o">=</span> <span class="mi">5</span>
<span class="n">my_match</span><span class="o">.</span><span class="n">dl_dst</span> <span class="o">=</span> <span class="n">EthAddr</span><span class="p">(</span><span class="s">&quot;01:02:03:04:05:06&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="partial-matches-and-wildcards">
<h3><a class="toc-backref" href="#id121">Partial Matches and Wildcards</a><a class="headerlink" href="#partial-matches-and-wildcards" title="Permalink to this headline">¶</a></h3>
<p>Unspecified fields are&nbsp;<em>wildcarded</em>&nbsp;and will match any packet.  You can explicitly set a field to be wildcarded by setting it to&nbsp;<code class="code mono bash docutils literal"><span class="pre">None</span></code>.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last"><em>Info:</em> While the OpenFlow <code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code> structure is defined as having a <code class="code mono bash docutils literal"><span class="pre">wildcards</span></code> attribute, <em>you will probably never need to explicitly set it when using POX</em> &#8211; simply don&#8217;t assign values to fields you want wildcarded (or set them to <code class="code mono bash docutils literal"><span class="pre">None</span></code>).</p>
</div>
<p>IP address fields are a bit trickier, as they can be wildcarded completely like the other fields, but can also be&nbsp;<em>partially</em>&nbsp;wildcarded.  This allows you to match entire subnets.  There are a number of ways to do this.  Here are some equivalent ones:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my_match</span><span class="o">.</span><span class="n">nw_src</span> <span class="o">=</span> <span class="s">&quot;192.168.42.0/24&quot;</span>
<span class="n">my_match</span><span class="o">.</span><span class="n">nw_src</span> <span class="o">=</span> <span class="p">(</span><span class="n">IPAddr</span><span class="p">(</span><span class="s">&quot;192.168.42.0&quot;</span><span class="p">),</span> <span class="mi">24</span><span class="p">)</span>
<span class="n">my_match</span><span class="o">.</span><span class="n">nw_src</span> <span class="o">=</span> <span class="s">&quot;192.168.42.0/255.255.255.0&quot;</span>
<span class="n">my_match</span><span class="o">.</span><span class="n">set_nw_src</span><span class="p">(</span><span class="n">IPAddr</span><span class="p">(</span><span class="s">&quot;192.168.42.0&quot;</span><span class="p">),</span> <span class="mi">24</span><span class="p">)</span>
</pre></div>
</div>
<p>In particular, note that the&nbsp;<code class="code mono bash docutils literal"><span class="pre">nw_src</span></code>&nbsp;and&nbsp;<code class="code mono bash docutils literal"><span class="pre">nw_dst</span></code>&nbsp;attributes can be ambiguous when working with partial matches – especially when reading a match structure (e.g., as returned in a flow_removed message or flow_stats reply).  To account for this, you may use the unambiguous&nbsp;<code class="code mono bash docutils literal"><span class="pre">.get_nw_src</span><span class="operator"><span class="pre">()</span></span></code>,&nbsp;<code class="code mono bash docutils literal"><span class="pre">.set_nw_src</span><span class="operator"><span class="pre">()</span></span></code>, and the destination equivalents.  These return a tuple such as&nbsp;<code class="code mono bash docutils literal"><span class="operator"><span class="pre">(</span></span><span class="pre">IPAddr</span><span class="operator"><span class="pre">(</span></span><span class="literal string double"><span class="pre">&quot;192.168.42.0&quot;</span></span><span class="operator"><span class="pre">)</span></span><span class="pre">,</span> <span class="pre">24</span><span class="operator"><span class="pre">)</span></span></code>&nbsp;which includes the number of matched bits – the number that would follow the slash in CIDR-style representation (192.168.42.0/24).</p>
<p>Note that some fields have&nbsp;<em>prerequisites</em>.  Basically this means that you can&#8217;t specify higher-layer fields without specifying the corresponding lower-layer fields also.  For example, you can not create a match on a TCP port without also specifying that you wish to match TCP traffic.  And in order to match TCP traffic, you must specify that you wish to match IP traffic.  Thus, a match with only&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">tp_dst</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">80</span></code>, for example, is invalid.  You must also specify&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">nw_proto</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">6</span></code>&nbsp;(TCP), and&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">dl_type</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">0x800</span></code>&nbsp;(IPv4).  If you violate this, you should get the warning message &#8216;<code class="code mono bash docutils literal"><span class="pre">Fields</span> <span class="pre">ignored</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">unspecified</span> <span class="pre">prerequisites</span></code>&#8216;.  For more information on this subject, see the FAQ entry &#8220;I tried to install a table entry but got a different one.  Why?&#8221;.</p>
</div>
<div class="section" id="ofp-match-methods">
<h3><a class="toc-backref" href="#id122">ofp_match Methods</a><a class="headerlink" href="#ofp-match-methods" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="22%" />
<col width="78%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Method</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>from_packet(<em>packet, in_port=None, spec_frags=False</em>)</td>
<td>Class factory.  See &#8220;Defining a match from an existing packet&#8221; below.</td>
</tr>
<tr class="row-odd"><td>clone()</td>
<td>Returns a copy of this ofp_match.</td>
</tr>
<tr class="row-even"><td>flip()</td>
<td>Returns a copy with its source and destinations reversed.</td>
</tr>
<tr class="row-odd"><td>show()</td>
<td>Returns a large string representation.</td>
</tr>
<tr class="row-even"><td>get_nw_src()</td>
<td>Returns the IP source address and the number of matched bits as a tuple.  For example: (IPAddr(&#8220;192.168.42.0&#8221;, 24).  Note that the first element of the tuple will be None when the second is 0.</td>
</tr>
<tr class="row-odd"><td>set_nw_src(IP and bits)</td>
<td>Sets the IP source address and the number of bits to match.  The arguments can either be two arguments (one for IP and one for bit count), or a tuple in the format used by get_nw_src().</td>
</tr>
<tr class="row-even"><td>get_nw_dst()</td>
<td>Same as get_nw_src() but for destination address.</td>
</tr>
<tr class="row-odd"><td>set_nw_dst(IP and bits)</td>
<td>Same as set_nw_src() but for destination address.</td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="defining-a-match-from-an-existing-packet">
<h3><a class="toc-backref" href="#id123">Defining a match from an existing packet</a><a class="headerlink" href="#defining-a-match-from-an-existing-packet" title="Permalink to this headline">¶</a></h3>
<p>There is a simple way to create an exact match based on an existing packet object (that is, an&nbsp;<code class="code mono bash docutils literal"><span class="pre">ethernet</span></code>&nbsp;object from&nbsp;<code class="code mono bash docutils literal"><span class="pre">pox.lib.packet</span></code>) or from an existing&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code>.  This is done using the factory method&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match.from_packet</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">my_match</span> <span class="o">=</span> <span class="n">ofp_match</span><span class="o">.</span><span class="n">from_packet</span><span class="p">(</span><span class="n">packet</span><span class="p">,</span> <span class="n">in_port</span><span class="p">)</span>
</pre></div>
</div>
<p>The&nbsp;<code class="code mono bash docutils literal"><span class="pre">packet</span></code>&nbsp;parameter is a parsed packet or&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code>&nbsp;from which to create the match.  As the input port is not actually in a packet header, the resulting match will have the input port wildcarded by default when this method is called with a packet.  You can, of course, set the in_port field later yourself, but as a shortcut, you can simply pass it in to from_packet().  When using from_packet() with an ofp_packet_in, the in_port is taken from there by default.</p>
<p>Note that you can set fields of the resultant match object to None (wildcarding them) if you want a less-than-exact match.</p>
<p>from_packet() also has an optional spec_frags argument which defaults to False.  See page 9 of the OpenFlow 1.0 specification to help understand the rationale for its existence.</p>
</div>
<div class="section" id="example-matching-web-traffic">
<h3><a class="toc-backref" href="#id124">Example: Matching Web Traffic</a><a class="headerlink" href="#example-matching-web-traffic" title="Permalink to this headline">¶</a></h3>
<p>As an example, the following code will create a match for traffic to web servers:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">pox.openflow.libopenflow_01</span> <span class="kn">as</span> <span class="nn">of</span> <span class="c"># POX convention</span>
<span class="kn">import</span> <span class="nn">pox.lib.packet</span> <span class="kn">as</span> <span class="nn">pkt</span> <span class="c"># POX convention</span>
<span class="n">my_match</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_match</span><span class="p">(</span><span class="n">dl_type</span> <span class="o">=</span> <span class="n">pkt</span><span class="o">.</span><span class="n">ethernet</span><span class="o">.</span><span class="n">IP_TYPE</span><span class="p">,</span> <span class="n">nw_proto</span> <span class="o">=</span> <span class="n">pkt</span><span class="o">.</span><span class="n">ipv4</span><span class="o">.</span><span class="n">TCP_PROTOCOL</span><span class="p">,</span> <span class="n">tp_dst</span> <span class="o">=</span> <span class="mi">80</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="openflow-actions">
<h2><a class="toc-backref" href="#id125">OpenFlow Actions</a><a class="headerlink" href="#openflow-actions" title="Permalink to this headline">¶</a></h2>
<p>OpenFlow actions are applied to packets that match a rule installed at the datapath. The code snippets found here can be found in libopenflow_01.py in pox/openflow.</p>
<div class="section" id="output">
<h3><a class="toc-backref" href="#id126">Output</a><a class="headerlink" href="#output" title="Permalink to this headline">¶</a></h3>
<p>Forward packets out of a physical or virtual port. Physical ports are referenced to by their integral value, while virtual ports have symbolic names. Physical ports should have port numbers less than 0xFF00.</p>
<p>Structure definition:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_output</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="bp">None</span> <span class="c"># Purposely bad -- require specification</span>
</pre></div>
</div>
<ul class="simple">
<li>port (int) the output port for this packet. Value could be an actual port number or one of the following virtual ports:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>OFPP_IN_PORT - Send back out the port the packet was received on.  Except possibly OFPP_NORMAL,&nbsp;<em>this is the only way to send a packet back out its incoming port.</em></li>
<li>OFPP_TABLE - Perform actions specified in flowtable. Note: Only applies to ofp_packet_out messages.</li>
<li>OFPP_NORMAL - Process via normal L2/L3 legacy switch configuration (if available – switch dependent)</li>
<li>OFPP_FLOOD - output all openflow ports except the input port and those with flooding disabled via the&nbsp;OFPPC_NO_FLOOD&nbsp;port config bit (generally, this is done for STP)</li>
<li>OFPP_ALL - &nbsp;output all openflow ports except the in port.</li>
<li>OFPP_CONTROLLER - Send to the controller.</li>
<li>OFPP_LOCAL - Output to local openflow port.</li>
<li>OFPP_NONE - Output to no where.</li>
</ul>
</div></blockquote>
</div>
<div class="section" id="enqueue">
<h3><a class="toc-backref" href="#id127">Enqueue</a><a class="headerlink" href="#enqueue" title="Permalink to this headline">¶</a></h3>
<p>Forwards a packet through the designated queue to implement rudimentary QoS behavior. See section of 5.2.2 of the OpenFlow spec.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_enqueue</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">port</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">queue_id</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li>port (int) - must be a physical port</li>
<li>queue_id (int) - specific queue id</li>
</ul>
<p>Note that definition of queues is not a part of OpenFlow and is switch-specific.</p>
</div>
<div class="section" id="set-vlan-id">
<h3><a class="toc-backref" href="#id128">Set VLAN ID</a><a class="headerlink" href="#set-vlan-id" title="Permalink to this headline">¶</a></h3>
<p>If the packet doesn&#8217;t have a VLAN header, this adds one and sets its ID to the specified value and its priority to 0.  If the packet already has a VLAN header, this just changes its ID.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_vlan_vid</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vlan_vid</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li>vlan_vid (int) - the ID to set the vlan id to (&lt; 4094, of course)</li>
</ul>
</div>
<div class="section" id="set-vlan-priority">
<h3><a class="toc-backref" href="#id129">Set VLAN priority</a><a class="headerlink" href="#set-vlan-priority" title="Permalink to this headline">¶</a></h3>
<p>If the packet doesn&#8217;t have a VLAN header, this adds one and sets its priority to the specified value and its ID to 0.  If the packet already has a VLAN header, this just changes its priority.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_vlan_pcp</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">vlan_pcp</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<ul class="simple">
<li>vlan_pcp (short) - the priority to set the packet to (&lt; 8)</li>
</ul>
</div>
<div class="section" id="set-ethernet-source-or-destination-address">
<h3><a class="toc-backref" href="#id130">Set Ethernet source or destination address</a><a class="headerlink" href="#set-ethernet-source-or-destination-address" title="Permalink to this headline">¶</a></h3>
<p>Used to set the source or destination MAC (Ethernet) address.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_dl_addr</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_dst</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">dl_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_DL_DST</span><span class="p">,</span> <span class="n">dl_addr</span><span class="p">)</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_src</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">dl_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_DL_SRC</span><span class="p">,</span> <span class="n">dl_addr</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">dl_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">dl_addr</span> <span class="o">=</span> <span class="n">EMPTY_ETH</span>
</pre></div>
</div>
<ul class="simple">
<li>type (int) - either OFPAT_SET_DL_SRC or OFPAT_SET_DL_DST</li>
<li>dl_addr (EthAddr) - the mac address to set.</li>
</ul>
<p>It may be convenient to use the two class factory methods rather than directly creating an instance of this class.  For example, to create an action to rewrite the destination MAC address, you can use:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">action</span> <span class="o">=</span> <span class="n">ofp_action_dl_addr</span><span class="o">.</span><span class="n">set_dst</span><span class="p">(</span><span class="n">EthAddr</span><span class="p">(</span><span class="s">&quot;01:02:03:04:05:06&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="set-ip-source-or-destination-address">
<h3><a class="toc-backref" href="#id131">Set IP source or destination address</a><a class="headerlink" href="#set-ip-source-or-destination-address" title="Permalink to this headline">¶</a></h3>
<p>Used to set the source or destination IP address.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_nw_addr</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_dst</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">nw_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_NW_DST</span><span class="p">,</span> <span class="n">nw_addr</span><span class="p">)</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_src</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">nw_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_NW_SRC</span><span class="p">,</span> <span class="n">nw_addr</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span> <span class="o">=</span> <span class="bp">None</span><span class="p">,</span> <span class="n">nw_addr</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="k">if</span> <span class="n">nw_addr</span> <span class="ow">is</span> <span class="ow">not</span> <span class="bp">None</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">nw_addr</span> <span class="o">=</span> <span class="n">IPAddr</span><span class="p">(</span><span class="n">nw_addr</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
      <span class="bp">self</span><span class="o">.</span><span class="n">nw_addr</span> <span class="o">=</span> <span class="n">IPAddr</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li>type (int) - either OFPAT_SET_NW_SRC or OFPAT_SET_NW_DST</li>
<li>nw_addr (IPAddr) - the IP address to set</li>
</ul>
<p>As with MAC addresses, rather than constructing an instance of this class directly, it can be convenient to use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">set_src</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;and&nbsp;<code class="code mono bash docutils literal"><span class="pre">set_dst</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;factory methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">action</span> <span class="o">=</span> <span class="n">ofp_action_nw_addr</span><span class="o">.</span><span class="n">set_dst</span><span class="p">(</span><span class="n">IPAddr</span><span class="p">(</span><span class="s">&quot;192.168.1.14&quot;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="set-ip-type-of-service">
<h3><a class="toc-backref" href="#id132">Set IP Type of Service</a><a class="headerlink" href="#set-ip-type-of-service" title="Permalink to this headline">¶</a></h3>
<p>Set the TOS field of an IP packet.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_nw_tos</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nw_tos</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">nw_tos</span> <span class="o">=</span> <span class="n">nw_tos</span>
</pre></div>
</div>
<ul class="simple">
<li>nw_tos (short) - the tos of service to set.</li>
</ul>
</div>
<div class="section" id="set-tcp-udp-source-or-destination-port">
<h3><a class="toc-backref" href="#id133">Set TCP/UDP source or destination port</a><a class="headerlink" href="#set-tcp-udp-source-or-destination-port" title="Permalink to this headline">¶</a></h3>
<p>Set the source or desintation TCP or UDP port.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">class</span> <span class="nc">ofp_action_tp_port</span> <span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_dst</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">tp_port</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_TP_DST</span><span class="p">,</span> <span class="n">tp_port</span><span class="p">)</span>
  <span class="nd">@classmethod</span>
  <span class="k">def</span> <span class="nf">set_src</span> <span class="p">(</span><span class="n">cls</span><span class="p">,</span> <span class="n">tp_port</span> <span class="o">=</span> <span class="bp">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">cls</span><span class="p">(</span><span class="n">OFPAT_SET_TP_SRC</span><span class="p">,</span> <span class="n">tp_port</span><span class="p">)</span>

  <span class="k">def</span> <span class="nf">__init__</span> <span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="bp">None</span><span class="p">,</span> <span class="n">tp_port</span> <span class="o">=</span> <span class="mi">0</span><span class="p">):</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">type</span> <span class="o">=</span> <span class="nb">type</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tp_port</span> <span class="o">=</span> <span class="n">tp_port</span>
</pre></div>
</div>
<ul class="simple">
<li>type (int) - must be either OFPAT_SET_TP_SRC or OFPAT_SET_TP_DST</li>
<li>tp_port (short) - the port value to set (&lt; 65534)</li>
</ul>
<p>As with the MAC and IP addresses, it may be convenient to use the two factory methods (<code class="code mono bash docutils literal"><span class="pre">set_dst</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;and&nbsp;<code class="code mono bash docutils literal"><span class="pre">set_src</span><span class="operator"><span class="pre">()</span></span></code>) rather than explicitly creating instances of this class.</p>
</div>
<div class="section" id="example-sending-a-flowmod">
<h3><a class="toc-backref" href="#id134">Example: Sending a FlowMod</a><a class="headerlink" href="#example-sending-a-flowmod" title="Permalink to this headline">¶</a></h3>
<p>To send a flow mod you must define a match structure (discussed above) and set some flow mod specific parameters as shown here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">msg</span> <span class="o">=</span> <span class="n">ofp_flow_mod</span><span class="p">()</span>
<span class="n">msg</span><span class="o">.</span><span class="n">match</span> <span class="o">=</span> <span class="n">match</span>
<span class="n">msg</span><span class="o">.</span><span class="n">idle_timeout</span> <span class="o">=</span> <span class="n">idle_timeout</span>
<span class="n">msg</span><span class="o">.</span><span class="n">hard_timeout</span> <span class="o">=</span> <span class="n">hard_timeout</span>
<span class="n">msg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_action_output</span><span class="p">(</span><span class="n">port</span> <span class="o">=</span> <span class="n">port</span><span class="p">))</span>
<span class="n">msg</span><span class="o">.</span><span class="n">buffer_id</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">some</span> <span class="nb">buffer</span> <span class="nb">id</span><span class="p">,</span> <span class="k">if</span> <span class="nb">any</span><span class="o">&gt;</span>
<span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>Using the connection variable obtained when the datapath joined, we can send the flowmod to the switch.</p>
</div>
<div class="section" id="example-sending-a-packetout">
<h3><a class="toc-backref" href="#id135">Example: Sending a PacketOut</a><a class="headerlink" href="#example-sending-a-packetout" title="Permalink to this headline">¶</a></h3>
<p>In a similar manner to a flow mod, one must first define a packet out as shown here:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">msg</span> <span class="o">=</span> <span class="n">of</span><span class="o">.</span><span class="n">ofp_packet_out</span><span class="p">(</span><span class="n">in_port</span><span class="o">=</span><span class="n">of</span><span class="o">.</span><span class="n">OFPP_NONE</span><span class="p">)</span>
<span class="n">msg</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">of</span><span class="o">.</span><span class="n">ofp_action_output</span><span class="p">(</span><span class="n">port</span> <span class="o">=</span> <span class="n">outport</span><span class="p">))</span>
<span class="n">msg</span><span class="o">.</span><span class="n">buffer_id</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">some</span> <span class="nb">buffer</span> <span class="nb">id</span><span class="p">,</span> <span class="k">if</span> <span class="nb">any</span><span class="o">&gt;</span>
<span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</pre></div>
</div>
<p>The inport is set to OFPP_NONE because the packet was generated at the controller and did not originate as a packet in at the datapath.</p>
</div>
</div>
<div class="section" id="nicira-open-vswitch-extensions">
<h2><a class="toc-backref" href="#id136">Nicira / Open vSwitch Extensions</a><a class="headerlink" href="#nicira-open-vswitch-extensions" title="Permalink to this headline">¶</a></h2>
<p>Open vSwitch supports a number of extensions to OpenFlow 1.0, and POX has growing support for these through the openflow.nicira module.  For example, there&#8217;s support for multiple tables, Nicira Extensible Match, a number of the register-based actions, etc.</p>
<p>In general, if you want to use the Nicira extensions, you should put&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.nicira</span></code>&nbsp;on your commandline to run it like a component (or import it and call its launch() function directly).  You will then probably want to import it to get access to the classes and so forth that it contains.  In POX, the current convention is to import it as so:&nbsp;<code class="code mono bash docutils literal"><span class="pre">import</span> <span class="pre">pox.openflow.nicira</span> <span class="pre">as</span> <span class="pre">nx</span></code>&nbsp;(however, this may change for the dart release).</p>
<p>Below, we discuss some aspects of POX&#8217;s support for Nicira extensions, but please note that this is quite incomplete.  You might find it helpful to refer to the Open vSwitch documentation/source.  In particular, the&nbsp;<a class="reference external" href="https://raw.githubusercontent.com/openvswitch/ovs/master/include/openflow/nicira-ext.h">nicira-ext.h</a>&nbsp;header is useful, as is&nbsp;<a class="reference external" href="http://benpfaff.org/~blp/ovs-fields.pdf">this list of fields used in OVS</a>&nbsp;(which may not be official documentation, but I believe to have been written by one of OVS&#8217; primary authors).</p>
<div class="admonition-todo admonition" id="index-8">
<p class="first admonition-title">Todo</p>
<p class="last">Reference some of the other helpful OVS files.</p>
</div>
<div class="section" id="extended-packetin-messages">
<h3><a class="toc-backref" href="#id137">Extended PacketIn Messages</a><a class="headerlink" href="#extended-packetin-messages" title="Permalink to this headline">¶</a></h3>
<p>OVS has an extended version of the packet-in message which contains the reason for the packet-in (e.g., whether it was because of a send-to-controller action or a table miss) and in the former case, the match of the relevant table entry.  This extended version is encapsulated inside an OpenFlow vendor message, and can be read via the generic vendor message hook mechanism or by handling the vendor event.  However, you can also have POX repurpose the normal PacketIn event and instead of having its&nbsp;<code class="code mono bash docutils literal"><span class="pre">.ofp</span></code>&nbsp;attribute be a normal&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_packet_in</span></code>, it will be an&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxt_packet_in</span></code>&nbsp;instead.  To do this, pass the&nbsp;<code class="code mono bash docutils literal"><span class="pre">--convert-packet-in</span></code>&nbsp;argument to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.nicira</span></code>&nbsp;component on the commandline.</p>
<p>Besides telling POX to treat these extended packet-ins as PacketIn events, you must also turn on the extended packet-in feature on the switches.  To do this, send a switch an&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_packet_in_format</span></code>&nbsp;message.  Generally you&#8217;ll do this in your ConnectionUp handler, like so:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">event</span><span class="o">.</span><span class="n">connection</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_packet_in_format</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="section" id="multiple-table-support">
<h3><a class="toc-backref" href="#id138">Multiple Table Support</a><a class="headerlink" href="#multiple-table-support" title="Permalink to this headline">¶</a></h3>
<p>While OpenFlow 1.0 only supports a single table, the Nicira extensions add support for multiple tables.  There are a couple aspects to this extension.</p>
<p>First, when manipulating the flow table, you must specify&nbsp;<em>which</em>&nbsp;table you mean.  The original ofp_flow_mod had no way to do this.  The extension repurposes eight bits of the sixteen bit &#8220;command&#8221; field to instead hold the table number.  POX&#8217;s openflow.nicira includes a new ofp_flow_mod_table_id message type, which does this for you, adding a table_id attribute.  The new nx_flow_mod (see the Nicira Extended Match section for more on the latter) also includes this table_id attribute.  Note that before using this extended flow_mod, you must enable the extension, by sending an&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_flow_mod_table_id</span></code>&nbsp;message, similar to with nx_packet_in_format mentioned above.</p>
<p>Additionally, while packets originally enter the first (zeroth) table, there is now an action which lets you send a packet to another table.  The easiest way to do this in POX is using a factory method of&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_action_resubmit</span></code>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">flowmod</span><span class="o">.</span><span class="n">actions</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_action_resubmit</span><span class="o">.</span><span class="n">resubmit_table</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="mi">42</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="section" id="flexible-flow-specifications-aka-nicira-extended-match">
<h3><a class="toc-backref" href="#id139">Flexible Flow Specifications (AKA Nicira Extended Match)</a><a class="headerlink" href="#flexible-flow-specifications-aka-nicira-extended-match" title="Permalink to this headline">¶</a></h3>
<p>Nicira Extended Match (or NXM) is one of the more significant Nicira extensions, and is the basis for the OpenFlow Extensible Match (OXM) in OpenFlow 1.2.  Among other things, it allows for the matching of IPv6 fields, the flow cookie, metadata registers, and a whole slew of other things.</p>
<p>The core of NXM is the&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_match</span></code>&nbsp;structure, which replaces the original&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>&nbsp;structure as the way to define matches for table entries.  Unlike&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>, which is just a fixed collection of fields,&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_match</span></code>&nbsp;is really a flexible container for individual&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxm_entry</span><span class="literal string backtick"><span class="pre">`</span></span><span class="pre">s.</span>&nbsp; <span class="pre">In</span> <span class="pre">POX,</span> <span class="pre">its</span> <span class="pre">basic</span> <span class="pre">interface</span> <span class="pre">is</span> <span class="pre">similar</span> <span class="pre">to</span> <span class="pre">that</span> <span class="pre">of</span> <span class="pre">a</span> <span class="pre">normal</span> <span class="pre">Python</span> <span class="pre">list</span> <span class="operator"><span class="pre">(</span></span><span class="pre">though</span> <span class="pre">it</span> <span class="pre">should</span> <span class="pre">only</span> <span class="pre">contain</span> <span class="pre">match</span> <span class="pre">entries!</span><span class="operator"><span class="pre">)</span></span><span class="pre">.</span>&nbsp; <span class="pre">Different</span> <span class="pre">types</span> <span class="pre">of&nbsp;:mono:</span><span class="literal string backtick"><span class="pre">`</span></span><span class="pre">nxm_entry</span></code>&nbsp;are used to specify the attributes of packets you wish to match, such as addresses, IP protocol number, and so on.  There are&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxm_entry</span></code>&nbsp;types corresponding to each of the fixed fields in the original&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>, as well as a large number of new types.</p>
<p>Many nxm_entry types support&nbsp;<em>masks</em>.  For example, the IP source and destination address matching types (NXM_OF_IP_SRC and NXM_OF_IP_DST) support masks, which allows you to match subnets.  Unlike OVS, which only allows CIDR-compatible wildcarding of IP address bits, current versions of OVS allow for matching arbitrary netmasks via NXM.  Exactly which fields support masks and exactly which masks are supported is specific to the particular switch.  For example, earlier versions of OVS only allowed a few masks for Ethernet addresses, but current versions support arbitrary masks (this is a pattern – newer versions of OVS generally support more flexible masks for more fields).</p>
<p>The naming of the&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxm_entry</span></code>&nbsp;types correspond to their names in Open vSwitch.  Most of them start with &#8220;<code class="code mono bash docutils literal"><span class="pre">NXM_</span></code>&#8221;.  The types which correspond to the fixed fields in ofp_match start with &#8220;<code class="code mono bash docutils literal"><span class="pre">NXM_OF_</span></code>&#8221;.  Types which originate from Nicira start with &#8220;<code class="code mono bash docutils literal"><span class="pre">NXM_NX_</span></code>&#8221;. There are a few exceptions to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">NXM_</span></code>&nbsp;prefix.  As mentioned, NXM is the basis for OXM.  Most of the fields supported by OXM are also supported by NXM, and we use the NXM name.  However, there are some OXM entries which are supported by Open vSwitch which don&#8217;t have an NXM equivalent.  For these, the&nbsp;<code class="code mono bash docutils literal"><span class="pre">OXM_*</span></code>&nbsp;name is used and is available in&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.nicira</span></code>.  This may change in the future when POX actually supports OpenFlow 1.2+ (and therefore has direct support for OXM).</p>
<p>The best way I know to learn about the various&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxm_entry</span></code>&nbsp;types is by reading the sourcecode to nicira-ext.h (and possibly some other files) in Open vSwitch.  You can also look for them in POX&#8217;s openflow/nicira.py code.  See the Additional Information subsection below for links.  At one point, POX supported most or all of the ones in OVS, though as OVS evolves, it&#8217;s possible that some are added which missing from POX.  In general, they&#8217;re easy to add yourself, and requests made to the mailing list will probably result in them being added as well.</p>
<p>Since the original&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_flow_mod</span></code>&nbsp;is specifically tied to the original&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>, the NXM extension also includes a new&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_flow_mod</span></code>&nbsp;command to actually manipulate table entries that use extended matches.</p>
<p>Many entry types have&nbsp;<em>prerequisites</em>.&nbsp; For example, if you want to match IPv4 addresses, you must first specify that the ethertype of the packet is, in fact, IPv4 (i.e., 0x0800). &nbsp;<strong>Order is significant here.</strong>&nbsp;&nbsp;As stated above,&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_match</span></code>&#8216;s basic interface similar to a Python list.  When an entry type has a prerequisites, the prerequisite entry must come first.  POX currently has no support for supplying these automatically or for checking the order or existence of these: if you screw it up, it&#8217;s all on you to figure it out (though it may in the future).  Read the documentation on the entry type carefully!</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Perequisites have a relationship with OVS&#8217;s &#8220;normal form&#8221;.  The man page of OVS&#8217;s ovs-ofctl has this to say: <br /><br /> Flow descriptions should be in <em>normal form</em>. This means that a flow may only specify a value for an L3 field if it also specifies a particular L2 protocol, and that a flow may only specify an L4 field if it also specifies particular L2 and L3 protocol types. For example, if the L2 protocol type <em>dl_type</em> is wildcarded, then L3 fields <em>nw_src</em>, <em>nw_dst</em>, and <em>nw_proto</em> must also be wildcarded. Similarly, if <em>dl_type</em> or <em>nw_proto</em> (the L3 protocol type) is wildcarded, so must be <em>tp_dst</em> and <em>tp_src</em>, which are L4 fields.</p>
</div>
<div class="section" id="using-nx-match">
<h4><a class="toc-backref" href="#id140">Using nx_match</a><a class="headerlink" href="#using-nx-match" title="Permalink to this headline">¶</a></h4>
<p>There are multiple ways to use&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_match</span></code>&nbsp;in POX.  The most straightforward interface is that it looks a bit like a Python list, containing (for example),&nbsp;<code class="code mono bash docutils literal"><span class="pre">append</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;and&nbsp;<code class="code mono bash docutils literal"><span class="pre">insert</span><span class="operator"><span class="pre">()</span></span></code>&nbsp;methods which can be used to add individual entries.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">m</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_match</span><span class="p">()</span>
<span class="n">m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">(</span><span class="n">EthAddr</span><span class="p">(</span><span class="s">&quot;b8:fe:aa:6e:88:8c&quot;</span><span class="p">))</span> <span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>To include a mask, specify it as a second argument to the entry constructor:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>3
4</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Only match broadcast/multicast packets</span>
<span class="n">m</span> <span class="o">+=</span> <span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_DST</span><span class="p">(</span><span class="s">&quot;01:00:00:00:00:00&quot;</span><span class="p">,</span> <span class="s">&quot;01:00:00:00:00:00&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Note also in the above example, that we can skip the explicit usage of&nbsp;<code class="code mono bash docutils literal"><span class="pre">EthAddr</span><span class="operator"><span class="pre">()</span></span></code>, and that we can use the += operator as an alternative to&nbsp;<code class="code mono bash docutils literal"><span class="pre">append</span><span class="operator"><span class="pre">()</span></span></code>.</p>
<p>In addition to the list-like interface, all the built-in entry types magically have corresponding attributes on the nx_match object.  The property name is the name of the entry type, but lower case, and the leading <code class="code mono bash docutils literal"><span class="pre">NXM</span></code>, <code class="code mono bash docutils literal"><span class="pre">NXM_NX</span></code>, etc. prefixes are optional.  And, in fact, there are several of these pseudo-attributes.  An &#8220;un-suffixed&#8221; one, and ones with the suffixes &#8220;<code class="code mono bash docutils literal"><span class="pre">_mask</span></code>&#8221;, &#8220;<code class="code mono bash docutils literal"><span class="pre">_with_mask</span></code>&#8221;, and &#8220;<code class="code mono bash docutils literal"><span class="pre">_entry</span></code>&#8221; for the value, the mask, the value+mask (as a tuple), and the actual&nbsp;<code class="code mono bash docutils literal"><span class="pre">nxm_entry</span></code>&nbsp;object itself.  For example, line 2 above could also be represented as:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">.</span><span class="n">eth_src</span> <span class="o">=</span> <span class="s">&quot;b8:fe:aa:6e:88:8c&quot;</span>
</pre></div>
</div>
<p>And line 4 could be one of the following:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">.</span><span class="n">eth_dst</span> <span class="o">=</span> <span class="s">&quot;01:00:00:00:00:00&quot;</span>
<span class="n">m</span><span class="o">.</span><span class="n">eth_dst_mask</span> <span class="o">=</span> <span class="s">&quot;01:00:00:00:00:00&quot;</span>

<span class="c"># .. or ...</span>

<span class="n">m</span><span class="o">.</span><span class="n">eth_dst_with_mask</span> <span class="o">=</span> <span class="p">(</span><span class="s">&quot;01:00:00:00:00:00&quot;</span><span class="p">,</span> <span class="s">&quot;01:00:00:00:00:00&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Some even have special syntax.  For example, IP addresses with CIDR ranges (or CIDR-compatible netmasks) can use the shorthand:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">m</span><span class="o">.</span><span class="n">of_ip_dst</span> <span class="o">=</span> <span class="s">&quot;192.168.1.0/255.255.255.0&quot;</span>
</pre></div>
</div>
<p>(Note that you can use arbitrary, non-CIDR-compatible netmasks if you use one of the other forms!)</p>
<p>The&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_flow_mod</span></code>&nbsp;is, in fact, a subclass of&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_flow_mod</span></code>&nbsp;– everything works pretty much the same, except that the match attribute is an&nbsp;<code class="code mono bash docutils literal"><span class="pre">nx_match</span></code>&nbsp;instead of an&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_match</span></code>.</p>
</div>
</div>
<div class="section" id="the-learn-action">
<h3><a class="toc-backref" href="#id141">The Learn Action</a><a class="headerlink" href="#the-learn-action" title="Permalink to this headline">¶</a></h3>
<p>The learn action (<code class="code mono bash docutils literal"><span class="pre">nx_action_learn</span></code>) is another of the powerful Nicira extensions which POX supports.  It allows for table entries to add new table entries.  A common reason for this is to do MAC learning on the switch without controller involvement (POX comes with an example of exactly this in the form of the&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding.l2_nx_self_learning</span></code>&nbsp;component). While the OVS docs/comments are the right place to learn about the learn action in general, we discuss it some here.</p>
<p>As stated above, the learn action causes the generation of a new table entry.  There is some&nbsp;<em>current</em>&nbsp;packet (which actually triggered the learn action).  This generates a new table entry for&nbsp;<em>future</em>&nbsp;packets.  The new table entry is defined by a series of flow_mod_specs which together create a &#8220;template&#8221; for the new table entry: its match and its actions.  Thus, there are two categories of flow_mod_specs: those which specify parts of the new entry&#8217;s match, and those which specify actions for the new entry.</p>
<p>The match-oriented flow_mod_specs come in two flavors.  The simplest lets you specify a match criteria based on a hard-coded value (i.e., &#8220;future packets must have VLAN 100 to match this entry&#8221;).  The second form uses a value in&nbsp;<em>current</em>&nbsp;packet to specify a match constraint for&nbsp;<em>future</em>&nbsp;packets (i.e., &#8220;future packets must have the same VLAN ID as the current packet to match this entry&#8221;).</p>
<p>The action-oriented flow_mod_specs come in four flavors.  Two of these generate OFPAT_OUTPUT actions on the new entry (which may be a real port number or may be some of the special &#8220;virtual&#8221; port numbers, e.g., OFPP_FLOOD).  The other two types both generate NXAST_REG_LOAD actions (i.e., header rewrites).  The difference between the two types of output and rewrite actions is the same as with the two variations of match entries: one uses hard-coded values (&#8220;set the VLAN ID to 101&#8221; or &#8220;output via port 3&#8221;), and the other uses a value from the current packet (e.g., &#8220;set the VLAN ID to be the same as the one in the current packet&#8221; or &#8220;output via the port stored in packet metadata register 3&#8221;).</p>
<p>All of these variations can be seen as a combination of&nbsp;<em>source</em>&nbsp;and&nbsp;<em>destination</em>.  The source is either an immediate value, or its value in the current packet.  The destination is either a new match criterion, a field to rewrite, or an output.</p>
<p>POX provides two major ways of specifying flow specs – an explicit and list-oriented interface, and a shorthand method.  The following three examples are equivalent ways of creating a simple learning switch:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># Straightforward.  List with flow_mod_spec constructor:</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_action_learn</span><span class="p">(</span><span class="n">table_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hard_timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">spec</span> <span class="o">=</span> <span class="p">[</span>
  <span class="n">nx</span><span class="o">.</span><span class="n">flow_mod_spec</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_learn_src_field</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">),</span>
                   <span class="n">n_bits</span><span class="o">=</span><span class="mi">12</span><span class="p">),</span>
  <span class="n">nx</span><span class="o">.</span><span class="n">flow_mod_spec</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_learn_src_field</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">),</span>
                   <span class="n">dst</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_learn_dst_match</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_DST</span><span class="p">)),</span>
  <span class="n">nx</span><span class="o">.</span><span class="n">flow_mod_spec</span><span class="p">(</span><span class="n">src</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_learn_src_field</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_IN_PORT</span><span class="p">),</span>
                   <span class="n">dst</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">nx_learn_dst_output</span><span class="p">())</span>
<span class="p">]</span>

<span class="c"># Appending to list with flow_mod_spec factory:</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_action_learn</span><span class="p">(</span><span class="n">table_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hard_timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">fms</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">flow_mod_spec</span><span class="o">.</span><span class="n">new</span> <span class="c"># Just abbreviating this</span>
<span class="n">learn</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fms</span><span class="p">(</span> <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="mi">12</span> <span class="p">))</span>
<span class="n">learn</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fms</span><span class="p">(</span> <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_DST</span> <span class="p">))</span>
<span class="n">learn</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fms</span><span class="p">(</span> <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_IN_PORT</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="bp">True</span> <span class="p">))</span>

<span class="c"># Shorthand flow_mod_spec chaining API:</span>
<span class="n">learn</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">nx_action_learn</span><span class="p">(</span><span class="n">table_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">hard_timeout</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">learn</span><span class="o">.</span><span class="n">spec</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
    <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_VLAN_TCI</span><span class="p">,</span> <span class="n">n_bits</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
    <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_SRC</span><span class="p">,</span> <span class="n">match</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_ETH_DST</span><span class="p">)</span><span class="o">.</span><span class="n">chain</span><span class="p">(</span>
    <span class="n">field</span><span class="o">=</span><span class="n">nx</span><span class="o">.</span><span class="n">NXM_OF_IN_PORT</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>There are some things to note in the above examples:</p>
<p>First, notice that fields are specified using their &#8220;NXM&#8221; entries (as described in the&nbsp;Nicira Extended Match section above).</p>
<p>Second, notice that we need not use the entire field&nbsp;– you can see that we specify n_bits to limit VLAN matching to 12 bits (since VLAN IDs are in fact only 12 bits of the VLAN TCI).  We can also specify a bit offset (as &#8220;ofs&#8221;); this wasn&#8217;t necessary in the above case since it defaults to zero, and the VLAN ID starts at bit zero (had we wanted to match the VLAN priority, we&#8217;d have specified ofs=13 and n_bits=3).</p>
<p>Third, notice that while the first example is very explicit about the source and destination (in the sense mentioned just above), this is implicit in the other two.  The other two use keyword parameters based on the names of the various flow spec types: &#8220;field&#8221; and &#8220;immediate&#8221; specify the source, and &#8220;match&#8221;, &#8220;load&#8221;, or &#8220;output&#8221; specify the destination.</p>
<p>Fourth and lastly, notice that we can skip a &#8220;match&#8221; when it&#8217;s the same as the &#8220;field&#8221;.  This is just a little programmer-optimization for a pretty common case since we often want to match on values in the current packet, as with the VLAN ID.</p>
</div>
<div class="section" id="additional-information">
<h3><a class="toc-backref" href="#id142">Additional Information</a><a class="headerlink" href="#additional-information" title="Permalink to this headline">¶</a></h3>
<p>We should add more documentation about using Nicira extensions.  For the moment, you might find the following to be useful references:</p>
<ul class="simple">
<li>The <a class="reference external" href="http://noxrepo.org/git/pox/blob/dart/pox/forwarding/l2_nx.py">forwarding.l2_nx</a>&nbsp;and&nbsp;<a class="reference external" href="http://noxrepo.org/git/pox/blob/dart/pox/forwarding/l2_nx.py">forwarding.l2_nx_self_learning</a>&nbsp;POX components.</li>
<li>Open vSwitch&#8217;s&nbsp;<a class="reference external" href="http://git.openvswitch.org/cgi-bin/gitweb.cgi?p=openvswitch;a=blob;f=include/openflow/nicira-ext.h">nicira-ext.h</a>.  It has a lot of comments, and a lot of it applies to POX&#8217;s implementation as well.</li>
<li>The source code to POX&#8217;s&nbsp;<a class="reference external" href="http://noxrepo.org/git/pox/blob/dart/pox/openflow/nicira.py">openflow/nicira.py</a>.  It has some helpful comments.</li>
</ul>
</div>
</div>
<div class="section" id="about-the-openflow-component-s-initialization">
<h2><a class="toc-backref" href="#id143">About the OpenFlow Component&#8217;s Initialization</a><a class="headerlink" href="#about-the-openflow-component-s-initialization" title="Permalink to this headline">¶</a></h2>
<p>POX was significantly inspired by NOX, and NOX was unquestionably an OpenFlow controller.  Additionally, early versions of POX did not have any sort of dependency system.  These two factors led to POX having a special case: the OpenFlow component was enabled by default.  Later, the &#8211;no-openflow switch was added to disable OpenFlow when it wasn&#8217;t needed or desired.  As time has gone on, usage of this switch has gone from useful on rare occasion to not entirely uncommon and it started to seem like an ugly annoyance.  However, simply not starting the OpenFlow component by default didn&#8217;t seem like a good idea either: it would break many &#8220;known&#8221; commandlines, would be more typing for the still-very-common case where it&#8217;s desired, and would likely cause many ugly startup exceptions until a fair amount of code was tweaked (since many components – even ones which use the dependency mechanism for other components&nbsp;– assume that the openflow component is always available).</p>
<p>There are a number of possible solutions to this problem and no permanent solution has yet been set in stone.  The currently favored high-level approach is to auto-load OpenFlow on demand.  A generic demand-loading mechanism was mostly written, but has not been merged.  Instead, the current solution in the dart branch (committed on October 13, 2013) has a number of changes specific to the OpenFlow component which attempt to detect whether the OpenFlow component is being used, and load it on demand if so.  The detection is not 100%: depending on how they&#8217;re written, some older components will not trigger it, and thus will need the openflow component explicitly placed on the commandline.  Such components should be tweaked; ideally, they should use the dependency mechanism.  (l3_learning, for example, was modified to trigger autoloading.)</p>
</div>
</div>
<div class="section" id="ovsdb-in-pox">
<h1><a class="toc-backref" href="#id144">OVSDB in POX</a><a class="headerlink" href="#ovsdb-in-pox" title="Permalink to this headline">¶</a></h1>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last"><em>Under Construction:</em> Official but experimental OVSDB support is appearing in POX.&nbsp; The code is in an early state, and so is this section.&nbsp; If you&#8217;re interested in OVSDB in POX and want help, you probably want to turn to the pox-dev mailing list for now.</p>
</div>
<p>Open vSwitch is software switch that can be controller via OpenFlow and is common in in virtual server environments and even as an element of hardware switches.  While the forwarding behavior can be controlled by OpenFlow, OVS has many other aspects which are outside the scope of OpenFlow.  The configuration and state for these are held in the Open vSwitch Database (the OVSDB), which can be queried and manipulated via the JSON-based OVSDB protocol.</p>
<p>POX has support for the OVSDB protocol, which allows one to connect to, configure, and query OVS instances.  There is both an object-oriented API, and a Python-embedded domain specific language for doing this.  The former is somewhat awkward to use &#8211; the expectation is that the latter (which is implemented using the former) will be the primary mode of usage, it is the focus of this section.</p>
<p>The POX OVSDB DSL is a fairly straightforward transliteration of the low-level OVSDB wire protocol.  There are two major implications here.  First, it&#8217;s all fairly low level.  the DSL is not mean to abstractly model the internals and abilities of OVS &#8211; it&#8217;s just meant to let you communicate with it.  If you want to implement an abstraction, you can do so atop the DSL (and then share your code with the mailing list!).  Secondly, this documentation is not meant to be stand-alone.  Since the DSL is fairly low level, it maps very closely to the protocol itself, and documenting the protocol in detail here would be redundant.  You should read this section along with <a class="reference external" href="https://tools.ietf.org/html/rfc7047">The Open vSwitch Database Management Protocol documentation (RFC 7047)</a>.</p>
<p>Below are listed valid POX OVSDB DSL statements.  They look vaguely like SQL (no huge surprise).  While we show them here with spaces between words, when writing in Python, words are actually separated by pipe symbols.  For example: <code class="code mono bash docutils literal"><span class="pre">SELECT</span><span class="punctuation"><span class="pre">|</span></span><span class="literal string double"><span class="pre">&quot;colname&quot;</span></span><span class="punctuation"><span class="pre">|</span></span><span class="pre">FROM</span><span class="punctuation"><span class="pre">|</span></span><span class="literal string double"><span class="pre">&quot;tablename&quot;</span></span></code>.</p>
<div class="section" id="transactions">
<h2><a class="toc-backref" href="#id145">Transactions</a><a class="headerlink" href="#transactions" title="Permalink to this headline">¶</a></h2>
<div class="admonition-todo admonition" id="index-9">
<p class="first admonition-title">Todo</p>
<p class="last">Unfinished</p>
</div>
</div>
<div class="section" id="getting-data-with-select">
<h2><a class="toc-backref" href="#id146">Getting data with SELECT</a><a class="headerlink" href="#getting-data-with-select" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><div class="highlight"><pre>SELECT [&lt;columns&gt;] FROM &lt;table&gt; WHERE &lt;condition&gt; [AND &lt;condition&gt; ...]
</pre></div>
</div>
<p>columns can be a list/tuple of columns, or a list of columns separated by AND.</p>
</div>
<div class="section" id="modifying-data-insert-update-delete-and-mutate">
<h2><a class="toc-backref" href="#id147">Modifying data: INSERT, UPDATE, DELETE, and MUTATE</a><a class="headerlink" href="#modifying-data-insert-update-delete-and-mutate" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><div class="highlight"><pre>INSERT &lt;row&gt; INTO &lt;table&gt; [WITH UUID_NAME &lt;uuid-name&gt;]
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>UPDATE &lt;table&gt; [WHERE &lt;conditions&gt;] WITH &lt;row&gt;
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>DELETE [IN|FROM] &lt;table&gt; [WHERE &lt;conditions&gt;]
</pre></div>
</div>
<p>or</p>
<div class="highlight-none"><div class="highlight"><pre>DELETE [WHERE &lt;conditions&gt;] IN|FROM &lt;table&gt;
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>IN &lt;table&gt; [WHERE &lt;conditions&gt;] MUTATE &lt;mutations&gt;

  mutations is an AND-separated list of one of:

  &lt;column&gt; INCREMENT/DECREMENT/MULTIPLYBY/DIVIDEBY/REMAINDEROF &lt;value&gt;
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>DELETE &lt;value&gt; FROM &lt;column&gt;
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>INSERT &lt;value&gt; INTO &lt;column&gt;
</pre></div>
</div>
</div>
<div class="section" id="locks">
<h2><a class="toc-backref" href="#id148">Locks</a><a class="headerlink" href="#locks" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><div class="highlight"><pre>ASSERT OWN [LOCK] &lt;lock-id&gt;
</pre></div>
</div>
</div>
<div class="section" id="miscellaneous">
<h2><a class="toc-backref" href="#id149">Miscellaneous</a><a class="headerlink" href="#miscellaneous" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><div class="highlight"><pre>COMMIT [DURABLE]
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>ABORT
</pre></div>
</div>
<div class="highlight-none"><div class="highlight"><pre>COMMENT [&lt;comment&gt;]
</pre></div>
</div>
</div>
<div class="section" id="waiting-for-conditions-and-monitoring-changes-with-wait-and-monitor">
<h2><a class="toc-backref" href="#id150">Waiting for conditions and monitoring changes with WAIT and MONITOR</a><a class="headerlink" href="#waiting-for-conditions-and-monitoring-changes-with-wait-and-monitor" title="Permalink to this headline">¶</a></h2>
<div class="highlight-none"><div class="highlight"><pre>WAIT UNTIL/WHILE &lt;columns&gt; [WHERE &lt;conditions&gt;] IN &lt;table&gt; ARE|IS [NOT] &lt;rows&gt; [[WITH] TIMEOUT &lt;timeout&gt;]
</pre></div>
</div>
<p>columns is a list/tuple or AND-separated list of column names</p>
<p>rows in AND-separated list of rows</p>
<div class="highlight-none"><div class="highlight"><pre>MONITOR [&lt;columns&gt;] IN &lt;table&gt; [FOR [INITIAL] [INSERT] [DELETE] [MODIFY]]
</pre></div>
</div>
</div>
</div>
<div class="section" id="third-party-tools-tutorials-etc">
<h1><a class="toc-backref" href="#id151">Third-Party Tools, Tutorials, Etc.</a><a class="headerlink" href="#third-party-tools-tutorials-etc" title="Permalink to this headline">¶</a></h1>
<p>This section attempts to note some projects which use POX but are not part of POX itself.&nbsp; (This may get moved to its own page or something in the future.)</p>
<div class="section" id="poxdesk-a-pox-web-gui">
<h2><a class="toc-backref" href="#id152">POXDesk: A POX Web GUI</a><a class="headerlink" href="#poxdesk-a-pox-web-gui" title="Permalink to this headline">¶</a></h2>
<img alt="_images/POXDesk4.png" src="_images/POXDesk4.png" />
<p>This is a side-project of Murphy&#8217;s in a very early state.&nbsp; It provides a number of features: a flow table inspector, a log viewer, a simple topology viewer, a terminal, an L2 learning switch implemented in JavaScript, etc.&nbsp; It&#8217;s meant to be extensible.&nbsp; It&#8217;s implemented using the Qooxdoo JavaScript framework on the front end, and POX&#8217;s web server and messenger service on the backend.</p>
<p>Site:&nbsp;<a class="reference external" href="https://github.com/MurphyMc/poxdesk/wiki">github.com/MurphyMc/poxdesk/wiki</a></p>
<p>Blog post with more info and screenshots:&nbsp;<a class="reference external" href="http://www.noxrepo.org/2012/09/pox-web-interfaces/">www.noxrepo.org/2012/09/pox-web-interfaces/</a></p>
</div>
<div class="section" id="id4">
<h2><a class="toc-backref" href="#id153">OpenFlow Tutorial</a><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>The OpenFlow Tutorial has a POX version which guides the reader through setting up a test environment using Mininet and implementing a hub and learning switch, among other things.</p>
<p>Site:&nbsp;<a class="reference external" href="http://www.openflow.org/wk/index.php/OpenFlow_Tutorial">www.openflow.org/wk/index.php/OpenFlow_Tutorial</a></p>
</div>
<div class="section" id="sdnhub-pox-controller-tutorial">
<h2><a class="toc-backref" href="#id154">SDNHub POX Controller Tutorial</a><a class="headerlink" href="#sdnhub-pox-controller-tutorial" title="Permalink to this headline">¶</a></h2>
<p>SDNHub has a brief tutorial on POX which includes their own VM with POX and Mininet preinstalled.</p>
<p>Site:&nbsp;<a class="reference external" href="http://sdnhub.org/tutorials/pox/">sdnhub.org/tutorials/pox/</a></p>
</div>
<div class="section" id="openflow-switch-tutorial">
<h2><a class="toc-backref" href="#id155">OpenFlow Switch Tutorial</a><a class="headerlink" href="#openflow-switch-tutorial" title="Permalink to this headline">¶</a></h2>
<p>These are examinations of some different ways to write &#8220;switch&#8221; type applications in OpenFlow with POX.&nbsp; Prepared by William Emmanuel Yu.</p>
<ul class="simple">
<li><em>OpenFlow Switch Tutorial</em>&nbsp;(<a class="reference external" href="https://github.com/hip2b2/poxstuff/blob/master/of_sw_tutorial.py">of_sw_tutorial.py</a>) - this is a simple OpenFlow module with various switch implementations. The following implementations are present:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>Dumb Hub - in this implementation, all packets are sent to the controller and then broadcast to all ports. No flows are installed.</li>
<li>Pair Hub - Flows are installed for source and destination MAC address pairs that instruct packets to be broadcast.</li>
<li>Lazy Hub - A single flow is installed to broadcast packet to all ports for any packet.</li>
<li>Bad Switch - Here flows are installed only based on destination MAC addresses. Find out what the problem is!</li>
<li>Pair Switch - Simple to a pair hub in that it installs flows based on source and destination MAC addresses but it forwards packets to the appropriate port instead of doing a broadcast.</li>
<li>Ideal Pair Switch - Improvement of the above switch where both to source and to destination MAC address flows are installed. Why is this an improvement from the above switch?</li>
</ul>
</div></blockquote>
<ul class="simple">
<li><em>OpenFlow Switch Interactive Tutorial</em>&nbsp;(<a class="reference external" href="https://github.com/hip2b2/poxstuff/blob/master/of_sw_tutorial_oo.py">of_sw_tutorial_oo.py</a>) - this is the same module above that is Interactive. If run with a pox py command line. Users can dynamically load and unload various switch implementations.&nbsp;&nbsp;<em>Note:</em>&nbsp;To use the interactive features, you will also need to include the &#8220;py&#8221; component on your commandline.</li>
</ul>
<div class="literal-block-wrapper container" id="sample-interactive-switch-session">
<div class="code-block-caption"><span class="caption-text">Sample Interactive Switch Session</span><a class="headerlink" href="#sample-interactive-switch-session" title="Permalink to this code">¶</a></div>
<div class="highlight-none"><div class="highlight"><pre>POX&gt; INFO:openflow.of_01:[00-00-00-00-00-01 1] connected
POX&gt; MySwitch.list_available_listeners()
INFO:samples.of_sw_tutorial_oo:SW_BADSWITCH
INFO:samples.of_sw_tutorial_oo:SW_LAZYHUB
INFO:samples.of_sw_tutorial_oo:SW_PAIRSWITCH
INFO:samples.of_sw_tutorial_oo:SW_IDEALPAIRSWITCH
INFO:samples.of_sw_tutorial_oo:SW_DUMBHUB
INFO:samples.of_sw_tutorial_oo:SW_PAIRHUB
POX&gt; MySwitch.clear_all_flows()
DEBUG:samples.of_sw_tutorial_oo:Clearing all flows from 00-00-00-00-00-01.
POX&gt; MySwitch.detach_packetin_listener()
DEBUG:samples.of_sw_tutorial_oo:Detaching switch SW_IDEALPAIRSWITCH.
POX&gt; MySwitch.attach_packetin_listener(&#39;SW_LAZYHUB&#39;)
DEBUG:samples.of_sw_tutorial_oo:Attach switch SW_LAZYHUB.
POX&gt; MySwitch.clear_all_flows()
DEBUG:samples.of_sw_tutorial_oo:Clearing all flows from 00-00-00-00-00-01.
POX&gt; MySwitch.detach_packetin_listener()
DEBUG:samples.of_sw_tutorial_oo:Detaching switch SW_LAZYHUB.
POX&gt; MySwitch.attach_packetin_listener(&#39;SW_BADSWITCH&#39;)
DEBUG:samples.of_sw_tutorial_oo:Attach switch SW_BADSWITCH.
</pre></div>
</div>
</div>
<ul class="simple">
<li><em>OpenFlow Switch Tutorial for Betta (and beyond)</em>&nbsp;(<a class="reference external" href="https://github.com/hip2b2/poxstuff/blob/master/of_sw_tutorial_resend.py">of_sw_tutorial_resend.py</a>) - this is the same module as above but takes advantage of resend functionality in the betta branch.</li>
</ul>
</div>
<div class="section" id="statistics-collector-example">
<h2><a class="toc-backref" href="#id156">Statistics Collector Example</a><a class="headerlink" href="#statistics-collector-example" title="Permalink to this headline">¶</a></h2>
<p>Prepared by William Emmanuel Yu.</p>
<ul class="simple">
<li><em>Statistics Collector Example</em>&nbsp;(<a class="reference external" href="https://github.com/hip2b2/poxstuff/blob/master/flow_stats.py">flow_stats.py</a>) - this module collects statistics every 5 seconds using a timer. There are three (3) kinds of statistics collected: port statistics, flow statistics and a sample displaying on web statistics (similar to an example above).&nbsp; Requires at least the betta version of POX.</li>
</ul>
</div>
<div class="section" id="ripl-datacenter-topologies-with-pox-and-mininet">
<h2><a class="toc-backref" href="#id157">RipL: Datacenter Topologies with POX and Mininet</a><a class="headerlink" href="#ripl-datacenter-topologies-with-pox-and-mininet" title="Permalink to this headline">¶</a></h2>
<p>RipL (Ripcord-Lite) is a Python library by Brandon Heller to facilitate working with datacenter-like networking stuff.&nbsp; In particular, it makes it really easy to run a &#8220;fat tree&#8221; topology in Mininet.</p>
<p>RipL-POX builds on RipL, creating an OpenFlow controller for static RipL topologies.&nbsp; It can route along a simple spanning tree, or it can utilize multiple paths either at random or based on a hash, and it can do these things either proactively or reactively (or as a hybrid).</p>
<p>Murphy has recently (spring 2014) updated RipL-POX to work on recent versions of POX (the current head of the dart branch).&nbsp; As of this writing, his changes haven&#8217;t been merged upstream, but are available in his own git repository.&nbsp; Unfortunately, RipL itself (not RipL-POX) seems to have some incompatibility with current versions of Mininet which prevents the proactive mode of RipL-POX from working.&nbsp; Murphy has some brief notes on how he cobbled together a working version of Mininet/RipL for testing in a&nbsp;<a class="reference external" href="https://github.com/brandonheller/riplpox/pull/5">pull request on the main RipL-POX repository</a>.</p>
<p>The RipL and RipL-POX repositories have README and INSTALL documents useful for getting going.&nbsp; Feel free to ask questions in the usual places for additional assistance.</p>
<p>Main RipL repository: <a class="reference external" href="https://github.com/brandonheller/ripl">github.com/brandonheller/ripl</a></p>
<p>Main RipL-POX repository: <a class="reference external" href="https://github.com/brandonheller/riplpox">github.com/brandonheller/riplpox</a></p>
<p>Murphy&#8217;s updated RipL-POX repository: <a class="reference external" href="https://github.com/MurphyMc/riplpox">github.com/MurphyMc/riplpox</a></p>
</div>
<div class="section" id="direct-server-return-load-balancer">
<h2><a class="toc-backref" href="#id158">Direct Server Return Load Balancer</a><a class="headerlink" href="#direct-server-return-load-balancer" title="Permalink to this headline">¶</a></h2>
<p>David A Dunn has&nbsp;<a class="reference external" href="http://www.noxrepo.org/forum/topic/simple-l2dsr-load-balancer-built-with-pox/">made available</a>&nbsp;a component which does load balancing for VIP traffic utilizing DSR with other traffic being handled by the &#8220;NORMAL&#8221; action.</p>
</div>
</div>
<div class="section" id="coding-conventions">
<h1><a class="toc-backref" href="#id159">Coding Conventions</a><a class="headerlink" href="#coding-conventions" title="Permalink to this headline">¶</a></h1>
<p>The&nbsp;<a class="reference external" href="http://www.python.org/dev/peps/pep-0008/">Style Guide for Python Code</a>&nbsp;(AKA PEP 8) outlines some conventions for developing in Python.&nbsp; It&#8217;s a good baseline, though POX does not aim for strict conformance.&nbsp; Here are some guidelines for writing code in POX, especially if you&#8217;d like to have it merged.&nbsp; Note that in some cases they are in addition to or differ from PEP 8.&nbsp; Also note that the most important guideline is that code is readable.&nbsp; Also also note that the code in the repository does not entirely conform with the below guidelines (pull requests that improve consistency are very welcome!).</p>
<ul class="simple">
<li><em>Two spaces for indentation</em></li>
<li>Line wrapping / line length:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><em>Maximum of 79 characters</em>, though 80 won&#8217;t kill us.</li>
<li><em>Use implicit line joining</em>&nbsp;(e.g. &#8220;hanging&#8221; parentheses or brackets) rather than the explicit backslash line-continuation character unless the former is very awkward</li>
<li>Continue lines beneath the appropriate brace/parenthesis (Lisp style) when that works well. When it doesn&#8217;t, <em>my</em> preference is to indent <em>a single space</em>, though I know that drives a lot of Python coders crazy, so I&#8217;m hesitant to set a specific rule here as long as it&#8217;s clear.&nbsp; The basic rule is that it should be either more or less indentation than usual &#8211; i.e., don&#8217;t use two spaces for a continued line.&nbsp;&nbsp;<em>I am more and more using four spaces.</em></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><em>Two blank lines separate top-level pieces of code with structural significance</em>&nbsp;(classes, top level functions, etc.). You can use three for separating larger pieces of code (though when one is tempted to do this, it&#8217;s always a good idea to ask oneself if the two larger pieces of code should be in separate files).&nbsp;&nbsp; Methods within a class should be one or two, but should be consistent within the particular class.</li>
<li><em>Put a space between function name and opening parenthesis of parameter list</em>.&nbsp; Similar for class and superclass.&nbsp; That is: &#8220;<code class="code mono bash docutils literal"><span class="pre">def</span> <span class="pre">foo</span> <span class="operator"><span class="pre">(</span></span><span class="pre">bar</span><span class="operator"><span class="pre">)</span></span><span class="pre">:</span></code>&#8221;, not &#8220;<code class="code mono bash docutils literal"><span class="pre">def</span> <span class="pre">foo</span><span class="operator"><span class="pre">(</span></span><span class="pre">bar</span><span class="operator"><span class="pre">)</span></span><span class="pre">:</span></code>&#8221;.</li>
<li><em>Use only new-style classes</em>.&nbsp; (This means inherit from object.)</li>
<li>Docstrings:</li>
</ul>
<blockquote>
<div><ul class="simple">
<li>Either stick to <code class="code mono bash docutils literal"><span class="literal string double"><span class="pre">&quot;&quot;&quot;</span> <span class="pre">one</span> <span class="pre">line</span> <span class="pre">&quot;&quot;&quot;</span></span></code>, or have the opening and closing <code class="code mono bash docutils literal"><span class="literal string double"><span class="pre">&quot;&quot;&quot;</span></span></code> on lines by themselves.&nbsp; (The latter is preferred.)</li>
<li>The first line should always be a relatively short, standalone description.&nbsp; Additional lines should be separated from the first by a blank line.</li>
</ul>
</div></blockquote>
<ul class="simple">
<li>Naming</li>
</ul>
<blockquote>
<div><ul class="simple">
<li><em>Classes should generally be InitialCapped</em>.</li>
<li><em>Methods and other attributes should be&nbsp;lower_with_underscores</em>.&nbsp;&nbsp;Note that this is currently violated all over the place (though it&#8217;s getting better).</li>
<li><em>&#8220;Private&#8221; members</em>&nbsp;(which you explicitly don&#8217;t want others relying on)&nbsp;<em>should start with an underscore</em>.</li>
<li><em>&#8220;constants&#8221; should be&nbsp;UPPER_WITH_UNDERSCORES</em>.</li>
<li>The&nbsp;<em>keyword arguments</em>&nbsp;catch-all variable is&nbsp;<em>called&nbsp;kw</em>&nbsp;(against Python convention of&nbsp;<code class="code mono bash docutils literal"><span class="pre">kwargs</span></code>)</li>
</ul>
</div></blockquote>
<p>Additionally, if you want to get your commits merged, please follow good commit message practice.&nbsp; For a quick writeup on the subject, see&nbsp;<a class="reference external" href="http://tbaggery.com/2008/04/19/a-note-about-git-commit-messages.html">this blog post</a>.&nbsp; In addition, it&#8217;s nice if the first part of the first line roughly indicates which portion/subsystem the commit relates to when possible, e.g., &#8220;openflow&#8221; or &#8220;forwarding&#8221;.&nbsp; For example, <code class="code mono bash docutils literal"><span class="pre">libopenflow:</span> <span class="pre">Fix</span> <span class="pre">ofp_match</span> <span class="pre">lock/unlock</span></code>.&nbsp; See the existing commit log on github for many examples.</p>
</div>
<div class="section" id="faqs">
<h1><a class="toc-backref" href="#id160">FAQs</a><a class="headerlink" href="#faqs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="what-versions-of-openflow-does-pox-support">
<h2><a class="toc-backref" href="#id161">What versions of OpenFlow does POX support?</a><a class="headerlink" href="#what-versions-of-openflow-does-pox-support" title="Permalink to this headline">¶</a></h2>
<p>POX currently supports OpenFlow 1.0.&nbsp; It also supports a number of the Nicira / Open vSwitch (&#8220;nx&#8221;) extensions (many of which are the basis for features in later OpenFlow versions).</p>
<p>Search the mailing list for a partial port to OpenFlow 1.1.</p>
<p>We&#8217;ll probably get around to supporting later versions eventually, or would be happy to work with others on getting patches mainlined.&nbsp; Come to the mailing list and raise the subject if you&#8217;re interested.</p>
</div>
<div class="section" id="what-does-the-fields-ignored-due-to-unspecified-prerequisites-warning-mean">
<h2><a class="toc-backref" href="#id162">What does the <code class="docutils literal"><span class="pre">Fields</span> <span class="pre">ignored</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">unspecified</span> <span class="pre">prerequisites</span></code> warning mean?</a><a class="headerlink" href="#what-does-the-fields-ignored-due-to-unspecified-prerequisites-warning-mean" title="Permalink to this headline">¶</a></h2>
<p>See the next question.</p>
</div>
<div class="section" id="i-tried-to-install-a-table-entry-but-got-a-different-one-why">
<h2><a class="toc-backref" href="#id163">I tried to install a table entry but got a different one.&nbsp; Why?</a><a class="headerlink" href="#i-tried-to-install-a-table-entry-but-got-a-different-one-why" title="Permalink to this headline">¶</a></h2>
<p>This question also presents itself as &#8220;What does the <code class="docutils literal"><span class="pre">Fields</span> <span class="pre">ignored</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">unspecified</span> <span class="pre">prerequisites</span></code> warning mean?&#8221;</p>
<p>Basically this means that you specified some higher-layer field without specifying the corresponding lower-layer fields also.&nbsp; For example, you may have tried to create a match in which you specified only&nbsp;<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">tp_dst</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">80</span></code>, intending to capture HTTP traffic.&nbsp; You can&#8217;t do this.&nbsp; To match TCP port 80, you must also specify that you intend to match TCP (<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">nw_proto</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">6</span></code>).&nbsp; And in order to match on TCP, you must also match on IP (<code class="code mono bash docutils literal"><span class="name variable"><span class="pre">dl_type</span></span><span class="operator"><span class="pre">=</span></span><span class="pre">0x800</span></code>).</p>
<p>For more information, see the text on &#8220;normal form&#8221; flow descriptions in the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ovs-ofctl</span></code>&nbsp;man page, or the new clarifying text added to section 3.4 in the OpenFlow 1.0.1 specification.</p>
</div>
<div class="section" id="what-is-a-datapath-what-is-a-dpid">
<h2><a class="toc-backref" href="#id164">What is a &#8220;datapath&#8221;?&nbsp; What is a DPID?</a><a class="headerlink" href="#what-is-a-datapath-what-is-a-dpid" title="Permalink to this headline">¶</a></h2>
<p>More or less, a datapath is a logical OpenFlow switch.&nbsp; A physical &#8220;OpenFlow switch&#8221; – meaning a box with ethernet ports&nbsp;– may have more than one datapath (though usually won&#8217;t).</p>
<p>A DPID is a datapath identifier, and is part of the OpenFlow specification, though the OpenFlow specification calls it a datapath_id, and is pretty vague about it in general.&nbsp; Basically, it is a unique identifier for a switch so that someone/something (e.g., an OpenFlow controller) can uniquely identify the switch.&nbsp; During the initial handshake, a switch sends its DPID to the controller as part of the&nbsp;<code class="code mono bash docutils literal"><span class="pre">ofp_switch_features</span></code>&nbsp;message.</p>
<p>A DPID is 64 bits.&nbsp; The spec claims the lower 48 bits are&nbsp;<em>intended</em>&nbsp;to be the switch&#8217;s ethernet address.&nbsp; This statement has always been a bit confusing &#8211; traditionally, a switch isn&#8217;t an endpoint, so what addresses does a switch even really have?&nbsp; The only answer that makes sense to this author is that it&#8217;s the ethernet address associated with the IP address used for the OpenFlow control channel.&nbsp; But in implementations, this is not always true because the OpenFlow control channel often may originate from one of several interfaces and it&#8217;ll use whatever ethernet address goes with it.</p>
<p>In practice, its pretty arbitrary, and often user-configurable independent of any ethernet address.&nbsp; It&#8217;s probably a decent idea to always just treat it as an opaque value which should be unique.&nbsp; If a vendor happens to base it on some particular ethernet address, treat that as an implementation detail for how they achieve uniqueness and not as there being any sort of real relationship between the two.</p>
<p>To give a more concrete answer: with Open vSwitch, it defaults to the ethernet address of the switch&#8217;s &#8220;local&#8221; port with the top 16 bits zeroed (this ethernet address being generated at random when last I checked).&nbsp; With Mininet, this generally gets overridden to match the number of the Mininet switch.</p>
<p>See the first few sections of the &#8220;OpenFlow in POX&#8221; section of this manual for more.</p>
</div>
<div class="section" id="how-do-i-create-a-firewall-block-tcp-ports">
<h2><a class="toc-backref" href="#id165">How do I create a firewall / block TCP ports?</a><a class="headerlink" href="#how-do-i-create-a-firewall-block-tcp-ports" title="Permalink to this headline">¶</a></h2>
<p>An easy way to do this is to use a forwarding component which does fine-grained flows (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>), and then intercept the&nbsp;<code class="code mono bash docutils literal"><span class="pre">PacketIn</span></code>&nbsp;events.&nbsp; When you see a packet you want to block, kill the event.&nbsp; This will keep&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>&nbsp;from seeing the event and installing a flow for it.&nbsp; The&nbsp;<code class="code mono bash docutils literal"><span class="pre">mac_blocker</span></code>&nbsp;component pretty much works like this.&nbsp; Here&#8217;s a simple example for blocking arbitrary TCP ports:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Block TCP ports</span>

<span class="sd">Save as ext/blocker.py and run along with l2_learning.</span>

<span class="sd">You can specify ports to block on the commandline:</span>
<span class="sd">./pox.py forwarding.l2_learning blocker --ports=80,8888,8000</span>

<span class="sd">Alternatively, if you run with the &quot;py&quot; component, you can use the CLI:</span>
<span class="sd">./pox.py forwarding.l2_learning blocker py</span>
<span class="sd"> ...</span>
<span class="sd">POX&gt; block(80, 8888, 8000)</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">from</span> <span class="nn">pox.core</span> <span class="kn">import</span> <span class="n">core</span>

<span class="c"># A set of ports to block</span>
<span class="n">block_ports</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">block_handler</span> <span class="p">(</span><span class="n">event</span><span class="p">):</span>
  <span class="c"># Handles packet events and kills the ones with a blocked port number</span>

  <span class="n">tcpp</span> <span class="o">=</span> <span class="n">event</span><span class="o">.</span><span class="n">parsed</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s">&#39;tcp&#39;</span><span class="p">)</span>
  <span class="k">if</span> <span class="ow">not</span> <span class="n">tcpp</span><span class="p">:</span> <span class="k">return</span> <span class="c"># Not TCP</span>
  <span class="k">if</span> <span class="n">tcpp</span><span class="o">.</span><span class="n">srcport</span> <span class="ow">in</span> <span class="n">block_ports</span> <span class="ow">or</span> <span class="n">tcpp</span><span class="o">.</span><span class="n">dstport</span> <span class="ow">in</span> <span class="n">block_ports</span><span class="p">:</span>
    <span class="c"># Halt the event, stopping l2_learning from seeing it</span>
    <span class="c"># (and installing a table entry for it)</span>
    <span class="n">core</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s">&quot;blocker&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s">&quot;Blocked TCP </span><span class="si">%s</span><span class="s"> &lt;-&gt; </span><span class="si">%s</span><span class="s">&quot;</span><span class="p">,</span>
                                    <span class="n">tcpp</span><span class="o">.</span><span class="n">srcport</span><span class="p">,</span> <span class="n">tcpp</span><span class="o">.</span><span class="n">dstport</span><span class="p">)</span>
    <span class="n">event</span><span class="o">.</span><span class="n">halt</span> <span class="o">=</span> <span class="bp">True</span>

<span class="k">def</span> <span class="nf">unblock</span> <span class="p">(</span><span class="o">*</span><span class="n">ports</span><span class="p">):</span>
  <span class="n">block_ports</span><span class="o">.</span><span class="n">difference_update</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">block</span> <span class="p">(</span><span class="o">*</span><span class="n">ports</span><span class="p">):</span>
  <span class="n">block_ports</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">ports</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">launch</span> <span class="p">(</span><span class="n">ports</span> <span class="o">=</span> <span class="s">&#39;&#39;</span><span class="p">):</span>

  <span class="c"># Add ports from commandline to list of ports to block</span>
  <span class="n">block_ports</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">ports</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s">&quot;,&quot;</span><span class="p">,</span> <span class="s">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">())</span>

  <span class="c"># Add functions to Interactive so when you run POX with py, you</span>
  <span class="c"># can easily add/remove ports to block.</span>
  <span class="n">core</span><span class="o">.</span><span class="n">Interactive</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s">&#39;block&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">block</span>
  <span class="n">core</span><span class="o">.</span><span class="n">Interactive</span><span class="o">.</span><span class="n">variables</span><span class="p">[</span><span class="s">&#39;unblock&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">unblock</span>

  <span class="c"># Listen to packet events</span>
  <span class="n">core</span><span class="o">.</span><span class="n">openflow</span><span class="o">.</span><span class="n">addListenerByName</span><span class="p">(</span><span class="s">&quot;PacketIn&quot;</span><span class="p">,</span> <span class="n">block_handler</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-change-the-openflow-port-from-6633">
<h2><a class="toc-backref" href="#id166">How can I change the OpenFlow port from 6633?</a><a class="headerlink" href="#how-can-i-change-the-openflow-port-from-6633" title="Permalink to this headline">¶</a></h2>
<p>If you turn on verbose logging, you&#8217;ll see that it&#8217;s the openflow.of_01 module which listens for connections.&nbsp; That&#8217;s the hint: it&#8217;s this component that you need to reconfigure.&nbsp; Do so by passing a &#8220;port&#8221; argument to this component on the commandline:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py openflow.of_01 --port<span class="o">=</span><span class="m">1234</span> &lt;other commandline arguments&gt;
</pre></div>
</div>
</div>
<div class="section" id="how-can-i-have-some-components-start-automatically-every-time-i-run-pox">
<h2><a class="toc-backref" href="#id167">How can I have some components start automatically every time I run POX?</a><a class="headerlink" href="#how-can-i-have-some-components-start-automatically-every-time-i-run-pox" title="Permalink to this headline">¶</a></h2>
<p>The short answer is that there&#8217;s no supported way for doing this.&nbsp;&nbsp;<em>However</em>, it&#8217;s pretty simple to just create a small component that launches whatever other components you want.</p>
<p>For example, let&#8217;s say you were tired of always having to remember the following commandline:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py log.level --DEBUG samples.pretty_log openflow.keepalive --interval<span class="o">=</span><span class="m">15</span> forwarding.l2_pairs
</pre></div>
</div>
<p>By writing a simple component, you can replace with above with simply:</p>
<div class="highlight-bash"><div class="highlight"><pre>./pox.py startup
</pre></div>
</div>
<p>The code for the simple component should be placed in <code class="code mono bash docutils literal"><span class="pre">ext/startup.py</span></code> and would contain the following code:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="c"># Put me in ext/startup.py</span>

<span class="k">def</span> <span class="nf">launch</span> <span class="p">():</span>
  <span class="kn">from</span> <span class="nn">pox.log.level</span> <span class="kn">import</span> <span class="n">launch</span>
  <span class="n">launch</span><span class="p">(</span><span class="n">DEBUG</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>

  <span class="kn">from</span> <span class="nn">pox.samples.pretty_log</span> <span class="kn">import</span> <span class="n">launch</span>
  <span class="n">launch</span><span class="p">()</span>

  <span class="kn">from</span> <span class="nn">pox.openflow.keepalive</span> <span class="kn">import</span> <span class="n">launch</span>
  <span class="n">launch</span><span class="p">(</span><span class="n">interval</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span> <span class="c"># 15 seconds</span>

  <span class="kn">from</span> <span class="nn">pox.forwarding.l2_pairs</span> <span class="kn">import</span> <span class="n">launch</span>
  <span class="n">launch</span><span class="p">()</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Note that here, as elsewhere in POX, it&#8217;s important to import POX modules using their full name – including the leading &#8220;pox&#8221; package.&nbsp; Not doing so can lead to confusing and incorrect behavior.</p>
</div>
</div>
<div class="section" id="how-do-i-get-switches-to-send-complete-packet-payloads-to-the-controller">
<h2><a class="toc-backref" href="#id168">How do I get switches to send complete packet payloads to the controller?</a><a class="headerlink" href="#how-do-i-get-switches-to-send-complete-packet-payloads-to-the-controller" title="Permalink to this headline">¶</a></h2>
<p>By default, when a packet misses all the entries in the flow table, only the first X bytes of the packet are sent to the controller.&nbsp; In POX, this defaults to&nbsp;<code class="code mono bash docutils literal"><span class="pre">OFP_DEFAULT_MISS_SEND_LEN</span></code>, which is 128.&nbsp; This is probably enough for, e.g., ethernet, IP, and TCP headers... but probably not enough for complete packets.&nbsp; If you want to inspect complete packet payloads, you have two options:</p>
<blockquote>
<div><ol class="arabic simple">
<li><em>Install a table entry.</em>&nbsp; If you install a table entry with a&nbsp;<code class="code mono bash docutils literal"><span class="pre">packet_out</span></code>&nbsp;to&nbsp;<code class="code mono bash docutils literal"><span class="pre">OFPP_CONTROLLER</span></code>, POX will have the switch send the complete packet by default (you can manually set some smaller number of bytes if you want).</li>
<li><em>Change the miss send length.</em>&nbsp;If you set&nbsp;<code class="code mono bash docutils literal"><span class="pre">core.openflow.miss_send_len</span></code>&nbsp;during startup (before any switches connect), switches should send that many bytes when a packet misses the whole table. Check the&nbsp;<code class="code mono bash docutils literal"><span class="pre">info.packet_dump</span></code>&nbsp;and <code class="code mono bash docutils literal"><span class="pre">misc.full_payload</span></code> components for examples.</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="how-can-i-communicate-between-components">
<h2><a class="toc-backref" href="#id169">How can I communicate between components?</a><a class="headerlink" href="#how-can-i-communicate-between-components" title="Permalink to this headline">¶</a></h2>
<p>Components are just Python packages and modules, so one way you can do this is the same way you communicate between any Python modules &#8211; import one of them and access its top-level variables and functions.</p>
<p>POX also has an alternate mechanism, which is described more in the section&nbsp;<a class="reference internal" href="#working-with-pox-the-pox-core-object">Working with POX: The POX Core object</a>.</p>
</div>
<div class="section" id="how-can-i-use-pox-with-mininet">
<h2><a class="toc-backref" href="#id170">How can I use POX with Mininet?</a><a class="headerlink" href="#how-can-i-use-pox-with-mininet" title="Permalink to this headline">¶</a></h2>
<p>Use the&nbsp;<code class="code mono bash docutils literal"><span class="pre">remote</span></code>&nbsp;controller type.&nbsp; For example, if you are running POX on the same machine as Mininet:</p>
<div class="highlight-bash"><div class="highlight"><pre>mn --topo<span class="o">=</span>linear --mac --controller<span class="o">=</span>remote
</pre></div>
</div>
<p>(The&nbsp;<code class="code mono bash docutils literal"><span class="pre">--mac</span></code>&nbsp;option is optional, but can make debugging easier.)</p>
<p>A common configuration is to run Mininet in a virtual machine and run POX in your host environment.&nbsp; In this case, point Mininet at an IP address of the host environment.&nbsp; If you&#8217;re using VirtualBox and a &#8220;Host-only Adapter&#8221;, this is the address assigned to the VirtualBox virtual adapter (e.g.,&nbsp;<code class="code mono bash docutils literal"><span class="pre">vboxnet0</span></code>).&nbsp; You do this slightly differently if you&#8217;re using Mininet 1 or Mininet 2.&nbsp; For Mininet 1:</p>
<div class="highlight-bash"><div class="highlight"><pre>mn --topo<span class="o">=</span>linear --mac --controller<span class="o">=</span>remote --ip<span class="o">=</span>192.168.56.1
</pre></div>
</div>
<p>For Mininet 2:</p>
<div class="highlight-bash"><div class="highlight"><pre>mn --topo<span class="o">=</span>linear --mac --controller<span class="o">=</span>remote,ip<span class="o">=</span>192.168.56.1
</pre></div>
</div>
<p>Additionally, in Mininet 2, you may want to specify the&nbsp;<code class="code mono bash docutils literal"><span class="pre">--nolistenport</span></code>&nbsp;option.</p>
</div>
<div class="section" id="i-m-seeing-many-packet-in-messages-and-forwarding-isn-t-working-what-gives">
<h2><a class="toc-backref" href="#id171">I&#8217;m seeing many packet_in messages and forwarding isn&#8217;t working; what gives?</a><a class="headerlink" href="#i-m-seeing-many-packet-in-messages-and-forwarding-isn-t-working-what-gives" title="Permalink to this headline">¶</a></h2>
<p>This problem is often seen when attempting to use one of the &#8220;learning&#8221; forwarding components (<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>,&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_multi</span></code>, etc.) on a mesh or other topology with a loop.&nbsp; These forwarding components do not take into account the adjustments that are required to work on loopy topologies.</p>
<p>The&nbsp;<code class="code mono bash docutils literal"><span class="pre">spanning_tree</span></code>&nbsp;component is meant to be a fairly generic solution to this problem, so you might try running it as well.&nbsp; It can also be helpful to prevent broadcasts until discovery has had time to discover the entire topology.&nbsp; Some components (such as&nbsp;<code class="code mono bash docutils literal"><span class="pre">l2_learning</span></code>) have an option to enforce this.</p>
</div>
<div class="section" id="does-pox-support-topologies-with-loops">
<h2><a class="toc-backref" href="#id172">Does POX support topologies with loops?</a><a class="headerlink" href="#does-pox-support-topologies-with-loops" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s start with making it clear that this is a broken question because POX itself simply doesn&#8217;t care.&nbsp; The real question is &#8220;Do any of the forwarding components that come with POX support topologies with loops?&#8221;&nbsp; The answer is ... sort of!&nbsp; As far as I remember, none of them&nbsp;<em>explicitly</em>&nbsp;support loops.&nbsp; However, several of them are compatible with the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.spanning_tree</span></code>&nbsp;component.&nbsp;&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.spanning_tree</span></code>&nbsp;disables flooding on ports, leaving only a tree.&nbsp; For forwarding components which only loop during floods, don&#8217;t change the port flood bit, and work with the discovery component, this may be good enough.</p>
<p>See the section on the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.spanning_tree</span></code>&nbsp;component and the above FAQ question for more.</p>
</div>
<div class="section" id="switches-keep-disconnecting-especially-with-pantou-reference-switch-help">
<h2><a class="toc-backref" href="#id173">Switches keep disconnecting (especially with Pantou/reference switch).&nbsp; Help?</a><a class="headerlink" href="#switches-keep-disconnecting-especially-with-pantou-reference-switch-help" title="Permalink to this headline">¶</a></h2>
<p>The short answer is that you should run the <code class="code mono bash docutils literal"><span class="pre">openflow.keepalive</span></code> component too.&nbsp; See the description of this component above for more information.</p>
</div>
<div class="section" id="why-doesn-t-the-openflow-webservice-component-work">
<h2><a class="toc-backref" href="#id174">Why doesn&#8217;t the openflow.webservice component work?</a><a class="headerlink" href="#why-doesn-t-the-openflow-webservice-component-work" title="Permalink to this headline">¶</a></h2>
<p>If you&#8217;re sending requests to the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.webservice</span></code>&nbsp;component and it&#8217;s not sending back replies, this chances are that you&#8217;re not conforming to the JSON-RPC spec.&nbsp; Specifically, you&#8217;re not including an &#8220;<code class="code mono bash docutils literal"><span class="pre">id</span></code>&#8221; key in your request.&nbsp; Add one and set it to an integer and see if that helps.&nbsp; See the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.webservice</span></code>&nbsp;examples in this manual for additional information.</p>
</div>
<div class="section" id="what-are-these-log-messages-from-the-packet-subsystem">
<h2><a class="toc-backref" href="#id175">What are these log messages from the packet subsystem?</a><a class="headerlink" href="#what-are-these-log-messages-from-the-packet-subsystem" title="Permalink to this headline">¶</a></h2>
<p>You may see info level log messages from the packet subsystem like:</p>
<p><code class="code mono bash docutils literal"><span class="operator"><span class="pre">(</span></span><span class="pre">dhcp</span> <span class="pre">parse</span><span class="operator"><span class="pre">)</span></span> <span class="pre">warning</span> <span class="pre">DHCP</span> <span class="pre">packet</span> <span class="pre">data</span> <span class="pre">too</span> <span class="pre">short</span> <span class="pre">to</span> <span class="pre">parse</span> <span class="pre">header</span></code></p>
<p><code class="code mono bash docutils literal"><span class="operator"><span class="pre">(</span></span><span class="pre">udp</span> <span class="pre">parse</span><span class="operator"><span class="pre">)</span></span> <span class="pre">warning</span> <span class="pre">UDP</span> <span class="pre">packet</span> <span class="pre">data</span> <span class="pre">too</span> <span class="pre">short</span> <span class="pre">to</span> <span class="pre">parse</span> <span class="pre">header:</span> <span class="pre">data</span> <span class="pre">len</span> <span class="pre">X</span></code></p>
<p><code class="code mono bash docutils literal"><span class="operator"><span class="pre">(</span></span><span class="pre">icmp</span> <span class="pre">parse</span><span class="operator"><span class="pre">)</span></span> <span class="pre">warning</span> <span class="pre">ICMP</span> <span class="pre">packet</span> <span class="pre">data</span> <span class="pre">too</span> <span class="pre">short</span></code></p>
<p><em>These aren&#8217;t errors or necessarily indicative of any problem.</em></p>
<p>When OpenFlow switches send packets to the controller, they often do not send the entire packet.&nbsp; When the packet is sent to the controller via an output action to the OFPP_CONTROLLER port, the output action can contain the number of bytes to send.&nbsp; When a packet is sent to the controller due to a table miss, this length can be set via OFPT_SET_CONFIG, but often defaults to 128 bytes.</p>
<p>When the switch only sends a partial packet, POX&#8217;s packet library may well not be able to parse the entire packet since the entire packet isn&#8217;t actually there.&nbsp; The decision was made to log this message at info level instead of debug level because debug messages within non-component portions of POX are intended to help debug POX itself, and the condition leading to these isn&#8217;t indicative of bugs in POX.&nbsp;&nbsp;<em>It&#8217;s possible that we should bend the rules here and log them at debug level anyway; feel free to register your opinion on noxrepo.org (in the forum or pox-dev mailing list).</em></p>
<p>Some things you can do about this:</p>
<blockquote>
<div><ol class="arabic simple">
<li>Ignore it unless it&#8217;s actually causing a problem for you (because your application requires these packets to be parsed correctly).</li>
<li>Turn the packet subsystem&#8217;s log level to warning (<code class="code mono bash docutils literal"><span class="pre">log.level</span> <span class="pre">--packet</span><span class="operator"><span class="pre">=</span></span><span class="pre">WARN</span></code>).</li>
<li>Install a flow to send the entirety of relevant packets to the controller (an ofp_action_output to OFPP_CONTROLLER will default to doing this).</li>
<li>Tell the switch to send complete packets to the controller on table misses (an easy way is to simply invoke the&nbsp;<code class="code mono bash docutils literal"><span class="pre">misc.full_payload</span></code>&nbsp;component).</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="i-installed-ip-based-table-entries-but-ping-tcp-doesn-t-work-why-not">
<h2><a class="toc-backref" href="#id176">I Installed IP-Based Table Entries But Ping/TCP Doesn&#8217;t Work.&nbsp; Why not?</a><a class="headerlink" href="#i-installed-ip-based-table-entries-but-ping-tcp-doesn-t-work-why-not" title="Permalink to this headline">¶</a></h2>
<p>To answer your question with a question: are you handling ARP?</p>
</div>
<div class="section" id="does-pox-support-python-3">
<h2><a class="toc-backref" href="#id177">Does POX support Python 3?</a><a class="headerlink" href="#does-pox-support-python-3" title="Permalink to this headline">¶</a></h2>
<p>Not yet.</p>
<p>At this point, Python 2 is still pretty much the standard. Additionally, it&#8217;s quite common to run POX using the PyPy interpreter, which does not yet support Python 3.&nbsp; In particular, we don&#8217;t have much desire to support&nbsp;<em>both</em>&nbsp;Python 2 and 3 simultaneously.&nbsp; So we expect to someday support Python 3, but not until it seems like it&#8217;s what the majority of users want, and probably not until after PyPy does.</p>
<p>If Python 3 support is important to you&nbsp;<em>now</em>, you should start an issue on the github tracker or post about it on pox-dev.&nbsp; Especially if you&#8217;re willing to do some of the work, we&#8217;ll be happy to discuss getting this done, how we can help, and how we can get your work merged into the main repository.</p>
<p>(This question hasn&#8217;t actually been asked a single time, much less frequently, as its inclusion in a FAQ would imply.&nbsp; I just wanted to document the answer.)</p>
</div>
<div class="section" id="i-d-like-to-contribute-can-i-do-you-have-project-ideas">
<h2><a class="toc-backref" href="#id178">I&#8217;d like to contribute.&nbsp; Can I?&nbsp; Do you have project ideas?</a><a class="headerlink" href="#i-d-like-to-contribute-can-i-do-you-have-project-ideas" title="Permalink to this headline">¶</a></h2>
<p>Sure you can.&nbsp; Some thoughts:</p>
<ul class="simple">
<li>Read the&nbsp;<a class="reference internal" href="#coding-conventions">Coding Conventions</a> section of the manual</li>
<li>Join the pox-dev mailing list at noxrepo.org</li>
<li>Get a github account and fork the POX repository</li>
<li>Submit pull requests on github or formatted patches on pox-dev</li>
</ul>
<p>If you&#8217;re looking for project ideas:</p>
<ul class="simple">
<li>Check POX&#8217;s issue tracker on github</li>
<li>Ask the mailing list – in particular, Murphy has started maintaining a list of projects suitable for students or interested parties and may be able to give you a suggestion</li>
</ul>
</div>
<div class="section" id="what-s-this-warning-like-core-still-waiting-on-1-component-s">
<h2><a class="toc-backref" href="#id179">What&#8217;s this warning like &#8220;core:Still waiting on 1 component(s)&#8221;?</a><a class="headerlink" href="#what-s-this-warning-like-core-still-waiting-on-1-component-s" title="Permalink to this headline">¶</a></h2>
<p>A dependency of some component you&#8217;re running hasn&#8217;t been met.&nbsp; To rectify this, you should probably run the missing component by including it on the commandline.&nbsp; If you run with logging at DEBUG level, you&#8217;ll get a more detailed message, such as &#8220;<code class="code mono bash docutils literal"><span class="pre">core:startup</span><span class="operator"><span class="pre">()</span></span> <span class="pre">in</span> <span class="pre">pox.forwarding.l2_multi</span> <span class="pre">still</span> <span class="pre">waiting</span> <span class="keyword"><span class="pre">for</span></span><span class="pre">:</span> <span class="pre">openflow_discovery</span></code>&#8221;.&nbsp; In this case, it indicates that&nbsp;<code class="code mono bash docutils literal"><span class="pre">forwarding.l2_multi</span></code>&nbsp;requires&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.discovery</span></code>.</p>
</div>
<div class="section" id="why-doesn-t-pox-s-discovery-use-the-normal-lldp-mac-address">
<h2><a class="toc-backref" href="#id180">Why doesn&#8217;t POX&#8217;s discovery use the normal LLDP MAC address?</a><a class="headerlink" href="#why-doesn-t-pox-s-discovery-use-the-normal-lldp-mac-address" title="Permalink to this headline">¶</a></h2>
<p>POX&#8217;s discovery uses the MAC address that Nicira defined for use with OpenFlow-based discovery and which was used by the NOX controller.&nbsp; The significant difference between the normal one and the Nicira one is that the original one is in the bridge-filtered range, which means that Ethernet switches should never forward it.&nbsp; If your network is entirely made of OpenFlow switches, this doesn&#8217;t make any difference.&nbsp; But if your network is a combination of OpenFlow switches and traditional Ethernet switches, it does.</p>
<p>Imagine you had the following topology, where A and B are OpenFlow switches, and S is a standard Ethernet switch.</p>
<p><code class="code mono bash docutils literal"><span class="pre">A</span> <span class="pre">--</span> <span class="pre">S</span> <span class="pre">--</span> <span class="pre">B</span></code></p>
<p>Imagine that the controller tells A to send a discovery packet with the normal LLDP MAC address.&nbsp; It gets to S.&nbsp; S will drop it, since the address is bridge-filtered.&nbsp; Thus, the controller concludes that packets sent from A will not reach B.&nbsp; This is obviously false except in the very special (that is, unusual) case where you&#8217;re using bridge-filtered MAC addresses!</p>
<p>By using a non-bridge-filtered address for discovery, POX (and NOX before it) can &#8220;see through&#8221; traditional Ethernet switches.</p>
</div>
<div class="section" id="what-s-a-good-strategy-for-debugging-a-problem-with-my-pox-based-controller">
<h2><a class="toc-backref" href="#id181">What&#8217;s a good strategy for debugging a problem with my POX-based controller?</a><a class="headerlink" href="#what-s-a-good-strategy-for-debugging-a-problem-with-my-pox-based-controller" title="Permalink to this headline">¶</a></h2>
<p>The&nbsp;<a class="reference external" href="https://raw.githubusercontent.com/openvswitch/ovs/master/FAQ">Open vSwitch FAQ</a>&nbsp;has a really good entry on this subject:</p>
<blockquote>
<div><p>Q: I have a sophisticated network setup involving Open vSwitch, VMs or multiple hosts, and other components. The behavior isn&#8217;t what I expect. Help!</p>
<p>A: To debug network behavior problems, trace the path of a packet, hop-by-hop, from its origin in one host to a remote host. If that&#8217;s correct, then trace the path of the response packet back to the origin. Usually a simple ICMP echo request and reply (&#8220;ping&#8221;) packet is good enough. Start by initiating an ongoing &#8220;ping&#8221; from the origin host to a remote host. If you are tracking down a connectivity problem, the &#8220;ping&#8221; will not display any successful output, but packets are still being sent. (In this case the packets being sent are likely ARP rather than ICMP.)</p>
</div></blockquote>
<p>The entry then goes on in further detail, including information on some of the tools available to you.&nbsp; While they are Open vSwitch-centric, a lot of it applies (perhaps in slightly altered form) to debugging SDN programs in general.</p>
</div>
<div class="section" id="i-ve-got-a-problem-bug-can-you-help-me">
<h2><a class="toc-backref" href="#id182">I&#8217;ve got a problem / bug!&nbsp; Can you help me?</a><a class="headerlink" href="#i-ve-got-a-problem-bug-can-you-help-me" title="Permalink to this headline">¶</a></h2>
<p>Possibly.&nbsp; There are a number of things you can do to help yourself, though.&nbsp; If none of those work or apply, there are a number of things you can do to help us help you.&nbsp; Here are some things you might try:</p>
<ol class="arabic simple">
<li><em>Read the logs.</em>&nbsp; If the logs don&#8217;t seem to say anything useful, try reading them at a lower log level, such as the DEBUG level.&nbsp; That way, you&#8217;ll get&nbsp;<em>all</em>&nbsp;the log messages.&nbsp; Do this by adding&nbsp;<code class="code mono bash docutils literal"><span class="pre">log.level</span> <span class="pre">--DEBUG</span></code>&nbsp;to your commandline.&nbsp; See the&nbsp;<code class="code mono bash docutils literal"><span class="pre">log.level</span></code>&nbsp;component section for more info on adjusting log levels.&nbsp; In particular, pay attention for warnings or errors (e.g., see the &#8220;Still waiting on...&#8221; FAQ entry)!</li>
<li><em>Look at the OpenFlow traffic.</em>&nbsp; If you don&#8217;t seem to be getting an event that you think you should be, or you think you&#8217;re sending messages but the switch doesn&#8217;t seem to be responding to, or anything else where you think there&#8217;s a breakdown in communication between a switch and POX, it can be helpful to look at what actually got put on the wire.&nbsp; There is an OpenFlow dissector for Wireshark (you can Google for it).&nbsp; You can either run it as usual, or you can use POX&#8217;s&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.debug</span></code>&nbsp;component to generate synthetic traces which show exactly what POX thinks it saw – one message per synthetic &#8220;packet&#8221; (which makes the Wireshark list easier to read).</li>
<li><em>Run a newer version.</em>&nbsp; Particularly, if you are running a release branch, you might think about running the active branch instead.&nbsp; While active branches may contain new problems, they also fix old ones!&nbsp; See the &#8220;Selecting a Branch / Version&#8221; section for more information.</li>
<li><em>Check the other FAQs.&nbsp;</em>&nbsp;Your question may already be answered!</li>
<li><em>Search the mailing list archive.</em>&nbsp; This would be more helpful if it weren&#8217;t so flaky.&nbsp; Sorry about that, hopefully we&#8217;ll get around to fixing it before too long!</li>
</ol>
<p>If none of those work, you might try posting to the pox-dev mailing list (sign up at&nbsp;<a class="reference external" href="http://www.noxrepo.org/community/mailing-lists/">www.noxrepo.org/community/mailing-lists</a>).&nbsp; When you do, you&#8217;ll probably get better results the more you can do the following:</p>
<ol class="arabic simple">
<li><em>Post the commandline with which you invoked POX.</em></li>
<li><em>Post the POX log.</em>&nbsp; It&#8217;s probably a good idea to post them at DEBUG level.&nbsp; Even if you didn&#8217;t see anything in the log, it may be helpful to someone else.&nbsp; The first part of the log (before the Up message) is especially useful, as it tells which operating system and Python interpreter you are running, and many components announce themselves.&nbsp; If you don&#8217;t post this, you might at least try to include some of this information yourself.</li>
<li><em>Post the traceback.</em>&nbsp; This sort of goes with the prior entry, but it&#8217;s worth making specific note.&nbsp; If you get an exception, post the full text of the exception including the traceback if possible.</li>
<li><em>Post which version of POX you are using.</em>&nbsp; Did you just do a&nbsp;<code class="code mono bash docutils literal"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">http://github.org/noxrepo/pox</span></code>, or did you switch branches?&nbsp; Did you do this recently or are you potentially using an older version?</li>
<li><em>Post what kind of switches you are using.</em>&nbsp; Are you running POX with Mininet?&nbsp; Which version?&nbsp; What commandline did you use to invoke Mininet?&nbsp; If it&#8217;s custom, consider posting your Mininet topology or script.&nbsp; If you&#8217;re running with hardware switches, what kind?&nbsp; If you&#8217;re running with a software switch, which one and which version?</li>
<li><em>Post code which illustrates the problem.</em>&nbsp; A minimal example is great, but anything is better than nothing.</li>
<li><em>Post a trace of the controller-switch OpenFlow traffic.&nbsp;</em>&nbsp;This is data you should have collected yourself as part of step 2 of the previous list.&nbsp; Capture the traffic with Wireshark or the&nbsp;<code class="code mono bash docutils literal"><span class="pre">openflow.debug</span></code>&nbsp;component and post it to the list.</li>
<li><em>Post what you&#8217;ve tried already.</em>&nbsp; Hopefully you&#8217;ve tried to address the issue yourself.&nbsp; What have you tried and what were the results?</li>
</ol>
<p>Doing the above makes it easier for people to help you, and also potentially saves time&nbsp;– if you don&#8217;t do the things mentioned above, it&#8217;s quite possible that the first suggestions you get from the mailing list will be to try the things mentioned above!</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">If you&#8217;re new to mailing lists and asking questions online, you may find some General Mailing List Tips useful. <a class="footnote-reference" href="#id6" id="id5">[1]</a></p>
</div>
<table class="docutils footnote" frame="void" id="id6" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id5">[1]</a></td><td>In general, the POX mailing list is polite and friendly and useful and other good things, and it has not suffered the negativity/flaming/etc. that people sometimes associate with mailing lists (usually larger ones).&nbsp; That said, if you&#8217;re new to mailing lists, it&#8217;s still not a bad idea to read a bit about mailing list etiquette and how to ask questions on a mailing list.&nbsp; This is not necessarily because it&#8217;ll help you avoid rudeness or anything, but because <em>it will make more people want to help you</em> (which is good for you), and it will allow the ones that do to <em>get you the answers you want faster</em> (which is good for everyone). <br /><br /> Eric S. Raymond, who wrote <a class="reference external" href="http://en.wikipedia.org/wiki/The_Cathedral_and_the_Bazaar">The Cathedral and the Bazaar: Musings on Linux and Open Source by an Accidental Revolutionary</a> (along with NetHack and some other good stuff), has written up a guide on <a class="reference external" href="http://www.catb.org/esr/faqs/smart-questions.html">How To Ask Questions The Smart Way</a> (on mailing lists).&nbsp; In particular, the &#8220;<a class="reference external" href="http://www.catb.org/esr/faqs/smart-questions.html#beprecise">Be precise and informative about your problem</a>&#8221;, &#8220;<a class="reference external" href="http://www.catb.org/esr/faqs/smart-questions.html#goal">Describe the goal, not the step</a>&#8221;, and &#8220;<a class="reference external" href="http://www.catb.org/esr/faqs/smart-questions.html#code">When asking about code</a>&#8221; sections are good reading.&nbsp; While it has nothing to do with POX at all, the Apache Jena project has a much shorter but still good guide on <a class="reference external" href="http://jena.apache.org/help_and_support/">How to ask a good question</a>.</td></tr>
</tbody>
</table>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="#">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Installing POX</a><ul>
<li><a class="reference internal" href="#requirements">Requirements</a></li>
<li><a class="reference internal" href="#getting-the-code-installing-pox">Getting the Code / Installing POX</a></li>
<li><a class="reference internal" href="#selecting-a-branch-version">Selecting a Branch / Version</a></li>
<li><a class="reference internal" href="#pypy-support">PyPy Support</a></li>
</ul>
</li>
<li><a class="reference internal" href="#invoking-pox">Invoking POX</a></li>
<li><a class="reference internal" href="#components-in-pox">Components in POX</a><ul>
<li><a class="reference internal" href="#stock-components">Stock Components</a><ul>
<li><a class="reference internal" href="#py">py</a></li>
<li><a class="reference internal" href="#forwarding-hub">forwarding.hub</a></li>
<li><a class="reference internal" href="#forwarding-l2-learning">forwarding.l2_learning</a></li>
<li><a class="reference internal" href="#forwarding-l2-pairs">forwarding.l2_pairs</a></li>
<li><a class="reference internal" href="#forwarding-l3-learning">forwarding.l3_learning</a></li>
<li><a class="reference internal" href="#forwarding-l2-multi">forwarding.l2_multi</a></li>
<li><a class="reference internal" href="#forwarding-l2-nx">forwarding.l2_nx</a></li>
<li><a class="reference internal" href="#forwarding-topo-proactive">forwarding.topo_proactive</a></li>
<li><a class="reference internal" href="#openflow-spanning-tree">openflow.spanning_tree</a></li>
<li><a class="reference internal" href="#openflow-webservice">openflow.webservice</a><ul>
<li><a class="reference internal" href="#example-get-list-of-connected-switches">Example: Get list of connected switches</a></li>
<li><a class="reference internal" href="#example-making-a-hub-using-the-webservice">Example: Making a hub using the webservice</a></li>
</ul>
</li>
<li><a class="reference internal" href="#web-webcore">web.webcore</a></li>
<li><a class="reference internal" href="#messenger">messenger</a><ul>
<li><a class="reference internal" href="#getting-started-with-the-messenger-component">Getting Started with the Messenger Component</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-of-01">openflow.of_01</a></li>
<li><a class="reference internal" href="#openflow-discovery">openflow.discovery</a></li>
<li><a class="reference internal" href="#openflow-debug">openflow.debug</a></li>
<li><a class="reference internal" href="#openflow-keepalive">openflow.keepalive</a></li>
<li><a class="reference internal" href="#proto-pong">proto.pong</a></li>
<li><a class="reference internal" href="#proto-arp-responder">proto.arp_responder</a></li>
<li><a class="reference internal" href="#info-packet-dump">info.packet_dump</a></li>
<li><a class="reference internal" href="#proto-dns-spy">proto.dns_spy</a></li>
<li><a class="reference internal" href="#proto-dhcp-client">proto.dhcp_client</a></li>
<li><a class="reference internal" href="#proto-dhcpd">proto.dhcpd</a></li>
<li><a class="reference internal" href="#misc-of-tutorial">misc.of_tutorial</a></li>
<li><a class="reference internal" href="#misc-full-payload">misc.full_payload</a></li>
<li><a class="reference internal" href="#misc-mac-blocker">misc.mac_blocker</a></li>
<li><a class="reference internal" href="#misc-nat">misc.nat</a></li>
<li><a class="reference internal" href="#misc-ip-loadbalancer">misc.ip_loadbalancer</a></li>
<li><a class="reference internal" href="#misc-gephi-topo">misc.gephi_topo</a></li>
<li><a class="reference internal" href="#log">log</a><ul>
<li><a class="reference internal" href="#disabling-the-console-log">Disabling the Console Log</a></li>
<li><a class="reference internal" href="#log-formatting">Log Formatting</a></li>
<li><a class="reference internal" href="#log-output">Log Output</a></li>
</ul>
</li>
<li><a class="reference internal" href="#log-color">log.color</a></li>
<li><a class="reference internal" href="#log-level">log.level</a></li>
<li><a class="reference internal" href="#samples-pretty-log">samples.pretty_log</a></li>
<li><a class="reference internal" href="#tk">tk</a></li>
<li><a class="reference internal" href="#host-tracker">host_tracker</a></li>
<li><a class="reference internal" href="#datapaths-pcap-switch">datapaths.pcap_switch</a></li>
</ul>
</li>
<li><a class="reference internal" href="#developing-your-own-components">Developing your own Components</a><ul>
<li><a class="reference internal" href="#the-ext-directory">The &#8220;ext&#8221; directory</a></li>
<li><a class="reference internal" href="#the-launch-function">The launch function</a><ul>
<li><a class="reference internal" href="#a-simple-example">A Simple Example</a></li>
<li><a class="reference internal" href="#multiple-invocation">Multiple Invocation</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#pox-apis">POX APIs</a><ul>
<li><a class="reference internal" href="#working-with-pox-the-pox-core-object">Working with POX: The POX Core object</a><ul>
<li><a class="reference internal" href="#registering-components">Registering Components</a></li>
<li><a class="reference internal" href="#dependency-and-event-management">Dependency and Event Management</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-addresses-pox-lib-addresses">Working with Addresses: pox.lib.addresses</a></li>
<li><a class="reference internal" href="#the-event-system-pox-lib-revent">The Event System: pox.lib.revent</a><ul>
<li><a class="reference internal" href="#handling-events">Handling Events</a><ul>
<li><a class="reference internal" href="#event-handlers">Event Handlers</a></li>
<li><a class="reference internal" href="#listening-to-an-event">Listening To an Event</a></li>
<li><a class="reference internal" href="#automatically-setting-listeners">Automatically Setting Listeners</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-your-own-event-types">Creating Your Own Event Types</a></li>
<li><a class="reference internal" href="#raising-events">Raising Events</a></li>
<li><a class="reference internal" href="#binding-to-components-events">Binding to Components&#8217; Events</a></li>
<li><a class="reference internal" href="#advanced-topics-in-event-handling">Advanced Topics in Event Handling</a><ul>
<li><a class="reference internal" href="#events-with-multiple-listeners">Events With Multiple Listeners</a></li>
<li><a class="reference internal" href="#removing-listeners-and-one-time-events">Removing Listeners and One-Time Events</a></li>
<li><a class="reference internal" href="#weak-event-handlers">Weak Event Handlers</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-packets-pox-lib-packet">Working with packets: pox.lib.packet</a><ul>
<li><a class="reference internal" href="#ethernet-ethernet">Ethernet (ethernet)</a></li>
<li><a class="reference internal" href="#ip-version-4-ipv4">IP version 4 (ipv4)</a></li>
<li><a class="reference internal" href="#tcp-tcp">TCP (tcp)</a><ul>
<li><a class="reference internal" href="#tcp-opt-class">tcp_opt class</a></li>
</ul>
</li>
<li><a class="reference internal" href="#example-arp-messages">Example: ARP messages</a></li>
<li><a class="reference internal" href="#constructing-packets-from-scratch-and-reading-packets-from-the-wire">Constructing Packets from Scratch and Reading Packets from the Wire</a></li>
</ul>
</li>
<li><a class="reference internal" href="#threads-tasks-and-timers-pox-lib-recoco">Threads, Tasks, and Timers: pox.lib.recoco</a><ul>
<li><a class="reference internal" href="#using-normal-threads">Using Normal Threads</a></li>
<li><a class="reference internal" href="#executing-code-in-the-future-using-a-timer">Executing Code in the Future using a Timer</a><ul>
<li><a class="reference internal" href="#timer-constructor-arguments">Timer Constructor Arguments</a></li>
<li><a class="reference internal" href="#timer-methods">Timer Methods</a></li>
<li><a class="reference internal" href="#example-one-shot-timer">Example&nbsp;- One-Shot timer</a></li>
<li><a class="reference internal" href="#example-recurring-timer">Example&nbsp;- Recurring timer</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-sockets-ioworker">Working with sockets: ioworker</a></li>
<li><a class="reference internal" href="#working-with-pcap-libpcap-pxpcap">Working with pcap/libpcap: pxpcap</a><ul>
<li><a class="reference internal" href="#building-pxpcap">Building pxpcap</a></li>
<li><a class="reference internal" href="#using-pxpcap-with-older-versions-of-python">Using pxpcap with older versions of Python</a></li>
<li><a class="reference internal" href="#using-pxpcap-with-pypy">Using pxpcap with PyPy</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-in-pox">OpenFlow in POX</a><ul>
<li><a class="reference internal" href="#dpids-in-pox">DPIDs in POX</a><ul>
<li><a class="reference internal" href="#dpids-in-mininet">DPIDs in Mininet</a></li>
</ul>
</li>
<li><a class="reference internal" href="#communicating-with-datapaths-switches">Communicating with Datapaths (Switches)</a><ul>
<li><a class="reference internal" href="#connection-objects">Connection Objects</a><ul>
<li><a class="reference internal" href="#getting-a-reference-to-a-connection-object">Getting a Reference to a Connection Object</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-openflow-nexus-core-openflow">The OpenFlow Nexus – core.openflow</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-events-responding-to-switches">OpenFlow Events: Responding to Switches</a><ul>
<li><a class="reference internal" href="#connectionup">ConnectionUp</a></li>
<li><a class="reference internal" href="#connectiondown">ConnectionDown</a></li>
<li><a class="reference internal" href="#portstatus">PortStatus</a></li>
<li><a class="reference internal" href="#flowremoved">FlowRemoved</a></li>
<li><a class="reference internal" href="#statistics-events">Statistics Events</a></li>
<li><a class="reference internal" href="#packetin">PacketIn</a></li>
<li><a class="reference internal" href="#errorin">ErrorIn</a></li>
<li><a class="reference internal" href="#barrierin">BarrierIn</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-messages">OpenFlow Messages</a><ul>
<li><a class="reference internal" href="#ofp-packet-out-sending-packets-from-the-switch">ofp_packet_out - Sending packets from the switch</a></li>
<li><a class="reference internal" href="#ofp-flow-mod-flow-table-modification">ofp_flow_mod - Flow table modification</a><ul>
<li><a class="reference internal" href="#example-installing-a-table-entry">Example: Installing a table entry</a></li>
<li><a class="reference internal" href="#example-clearing-tables-on-all-switches">Example: Clearing tables on all switches</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ofp-stats-request-requesting-statistics-from-switches">ofp_stats_request - Requesting statistics from switches</a><ul>
<li><a class="reference internal" href="#example-web-flow-statistics">Example - Web Flow Statistics</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#match-structure">Match Structure</a><ul>
<li><a class="reference internal" href="#partial-matches-and-wildcards">Partial Matches and Wildcards</a></li>
<li><a class="reference internal" href="#ofp-match-methods">ofp_match Methods</a></li>
<li><a class="reference internal" href="#defining-a-match-from-an-existing-packet">Defining a match from an existing packet</a></li>
<li><a class="reference internal" href="#example-matching-web-traffic">Example: Matching Web Traffic</a></li>
</ul>
</li>
<li><a class="reference internal" href="#openflow-actions">OpenFlow Actions</a><ul>
<li><a class="reference internal" href="#output">Output</a></li>
<li><a class="reference internal" href="#enqueue">Enqueue</a></li>
<li><a class="reference internal" href="#set-vlan-id">Set VLAN ID</a></li>
<li><a class="reference internal" href="#set-vlan-priority">Set VLAN priority</a></li>
<li><a class="reference internal" href="#set-ethernet-source-or-destination-address">Set Ethernet source or destination address</a></li>
<li><a class="reference internal" href="#set-ip-source-or-destination-address">Set IP source or destination address</a></li>
<li><a class="reference internal" href="#set-ip-type-of-service">Set IP Type of Service</a></li>
<li><a class="reference internal" href="#set-tcp-udp-source-or-destination-port">Set TCP/UDP source or destination port</a></li>
<li><a class="reference internal" href="#example-sending-a-flowmod">Example: Sending a FlowMod</a></li>
<li><a class="reference internal" href="#example-sending-a-packetout">Example: Sending a PacketOut</a></li>
</ul>
</li>
<li><a class="reference internal" href="#nicira-open-vswitch-extensions">Nicira / Open vSwitch Extensions</a><ul>
<li><a class="reference internal" href="#extended-packetin-messages">Extended PacketIn Messages</a></li>
<li><a class="reference internal" href="#multiple-table-support">Multiple Table Support</a></li>
<li><a class="reference internal" href="#flexible-flow-specifications-aka-nicira-extended-match">Flexible Flow Specifications (AKA Nicira Extended Match)</a><ul>
<li><a class="reference internal" href="#using-nx-match">Using nx_match</a></li>
</ul>
</li>
<li><a class="reference internal" href="#the-learn-action">The Learn Action</a></li>
<li><a class="reference internal" href="#additional-information">Additional Information</a></li>
</ul>
</li>
<li><a class="reference internal" href="#about-the-openflow-component-s-initialization">About the OpenFlow Component&#8217;s Initialization</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ovsdb-in-pox">OVSDB in POX</a><ul>
<li><a class="reference internal" href="#transactions">Transactions</a></li>
<li><a class="reference internal" href="#getting-data-with-select">Getting data with SELECT</a></li>
<li><a class="reference internal" href="#modifying-data-insert-update-delete-and-mutate">Modifying data: INSERT, UPDATE, DELETE, and MUTATE</a></li>
<li><a class="reference internal" href="#locks">Locks</a></li>
<li><a class="reference internal" href="#miscellaneous">Miscellaneous</a></li>
<li><a class="reference internal" href="#waiting-for-conditions-and-monitoring-changes-with-wait-and-monitor">Waiting for conditions and monitoring changes with WAIT and MONITOR</a></li>
</ul>
</li>
<li><a class="reference internal" href="#third-party-tools-tutorials-etc">Third-Party Tools, Tutorials, Etc.</a><ul>
<li><a class="reference internal" href="#poxdesk-a-pox-web-gui">POXDesk: A POX Web GUI</a></li>
<li><a class="reference internal" href="#id4">OpenFlow Tutorial</a></li>
<li><a class="reference internal" href="#sdnhub-pox-controller-tutorial">SDNHub POX Controller Tutorial</a></li>
<li><a class="reference internal" href="#openflow-switch-tutorial">OpenFlow Switch Tutorial</a></li>
<li><a class="reference internal" href="#statistics-collector-example">Statistics Collector Example</a></li>
<li><a class="reference internal" href="#ripl-datacenter-topologies-with-pox-and-mininet">RipL: Datacenter Topologies with POX and Mininet</a></li>
<li><a class="reference internal" href="#direct-server-return-load-balancer">Direct Server Return Load Balancer</a></li>
</ul>
</li>
<li><a class="reference internal" href="#coding-conventions">Coding Conventions</a></li>
<li><a class="reference internal" href="#faqs">FAQs</a><ul>
<li><a class="reference internal" href="#what-versions-of-openflow-does-pox-support">What versions of OpenFlow does POX support?</a></li>
<li><a class="reference internal" href="#what-does-the-fields-ignored-due-to-unspecified-prerequisites-warning-mean">What does the <code class="docutils literal"><span class="pre">Fields</span> <span class="pre">ignored</span> <span class="pre">due</span> <span class="pre">to</span> <span class="pre">unspecified</span> <span class="pre">prerequisites</span></code> warning mean?</a></li>
<li><a class="reference internal" href="#i-tried-to-install-a-table-entry-but-got-a-different-one-why">I tried to install a table entry but got a different one.&nbsp; Why?</a></li>
<li><a class="reference internal" href="#what-is-a-datapath-what-is-a-dpid">What is a &#8220;datapath&#8221;?&nbsp; What is a DPID?</a></li>
<li><a class="reference internal" href="#how-do-i-create-a-firewall-block-tcp-ports">How do I create a firewall / block TCP ports?</a></li>
<li><a class="reference internal" href="#how-can-i-change-the-openflow-port-from-6633">How can I change the OpenFlow port from 6633?</a></li>
<li><a class="reference internal" href="#how-can-i-have-some-components-start-automatically-every-time-i-run-pox">How can I have some components start automatically every time I run POX?</a></li>
<li><a class="reference internal" href="#how-do-i-get-switches-to-send-complete-packet-payloads-to-the-controller">How do I get switches to send complete packet payloads to the controller?</a></li>
<li><a class="reference internal" href="#how-can-i-communicate-between-components">How can I communicate between components?</a></li>
<li><a class="reference internal" href="#how-can-i-use-pox-with-mininet">How can I use POX with Mininet?</a></li>
<li><a class="reference internal" href="#i-m-seeing-many-packet-in-messages-and-forwarding-isn-t-working-what-gives">I&#8217;m seeing many packet_in messages and forwarding isn&#8217;t working; what gives?</a></li>
<li><a class="reference internal" href="#does-pox-support-topologies-with-loops">Does POX support topologies with loops?</a></li>
<li><a class="reference internal" href="#switches-keep-disconnecting-especially-with-pantou-reference-switch-help">Switches keep disconnecting (especially with Pantou/reference switch).&nbsp; Help?</a></li>
<li><a class="reference internal" href="#why-doesn-t-the-openflow-webservice-component-work">Why doesn&#8217;t the openflow.webservice component work?</a></li>
<li><a class="reference internal" href="#what-are-these-log-messages-from-the-packet-subsystem">What are these log messages from the packet subsystem?</a></li>
<li><a class="reference internal" href="#i-installed-ip-based-table-entries-but-ping-tcp-doesn-t-work-why-not">I Installed IP-Based Table Entries But Ping/TCP Doesn&#8217;t Work.&nbsp; Why not?</a></li>
<li><a class="reference internal" href="#does-pox-support-python-3">Does POX support Python 3?</a></li>
<li><a class="reference internal" href="#i-d-like-to-contribute-can-i-do-you-have-project-ideas">I&#8217;d like to contribute.&nbsp; Can I?&nbsp; Do you have project ideas?</a></li>
<li><a class="reference internal" href="#what-s-this-warning-like-core-still-waiting-on-1-component-s">What&#8217;s this warning like &#8220;core:Still waiting on 1 component(s)&#8221;?</a></li>
<li><a class="reference internal" href="#why-doesn-t-pox-s-discovery-use-the-normal-lldp-mac-address">Why doesn&#8217;t POX&#8217;s discovery use the normal LLDP MAC address?</a></li>
<li><a class="reference internal" href="#what-s-a-good-strategy-for-debugging-a-problem-with-my-pox-based-controller">What&#8217;s a good strategy for debugging a problem with my POX-based controller?</a></li>
<li><a class="reference internal" href="#i-ve-got-a-problem-bug-can-you-help-me">I&#8217;ve got a problem / bug!&nbsp; Can you help me?</a></li>
</ul>
</li>
</ul>

  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/index.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2015, McCauley et al..
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.3</a>
      
      |
      <a href="_sources/index.txt"
          rel="nofollow">Page source</a></li>
    </div>

    

    
  </body>
</html>